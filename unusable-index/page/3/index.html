<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"invincible-nerd.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="For explorer everywhere">
<meta property="og:type" content="website">
<meta property="og:title" content="IVN">
<meta property="og:url" content="http://invincible-nerd.github.io/unusable-index/page/3/index.html">
<meta property="og:site_name" content="IVN">
<meta property="og:description" content="For explorer everywhere">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="invincible-nerd">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://invincible-nerd.github.io/unusable-index/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>IVN</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">IVN</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://invincible-nerd.github.io/2023/01/13/Minimum-Moves/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="invincible-nerd">
      <meta itemprop="description" content="For explorer everywhere">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IVN">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/13/Minimum-Moves/" class="post-title-link" itemprop="url">Minimum Moves</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-13 16:08:42" itemprop="dateCreated datePublished" datetime="2023-01-13T16:08:42+08:00">2023-01-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-01 11:21:25" itemprop="dateModified" datetime="2023-03-01T11:21:25+08:00">2023-03-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LeetCode/" itemprop="url" rel="index"><span itemprop="name">LeetCode</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>4.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Minimum-Moves-to-Make-Equal"><a href="#Minimum-Moves-to-Make-Equal" class="headerlink" title="Minimum Moves to Make Equal"></a>Minimum Moves to Make Equal</h1><h2 id="215-Kth-Largest-Element-in-an-Array"><a href="#215-Kth-Largest-Element-in-an-Array" class="headerlink" title="215. Kth Largest Element in an Array"></a>215. Kth Largest Element in an Array</h2><p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/kth-largest-element-in-an-array/discuss/2180600/A-Guide-to-Quick-Select-or-JAVA">https://leetcode.com/problems/kth-largest-element-in-an-array/discuss/2180600/A-Guide-to-Quick-Select-or-JAVA</a></p>
<h3 id="How-Does-Quickselect-Work"><a href="#How-Does-Quickselect-Work" class="headerlink" title="How Does Quickselect Work?"></a>How Does Quickselect Work?</h3><p>Quickselect works identical to quicksort in that we:</p>
<ul>
<li>Pick a pivot</li>
<li>Partition the data into two where:<ul>
<li>Numbers less than the pivot go to the left</li>
<li>Numbers greater than the pivot go to the right</li>
</ul>
</li>
</ul>
<p>However, instead of recursing into both sides as in Quicksort, quickselect only recurs into one side; whichever one would have our kth largest element.<br>The main thing to note here is that <strong>our pivot at any given partition will always end up at the correct index</strong>. Therefore, we just need to check:</p>
<ul>
<li>If our pivot is at our “kth largest” index, return the number at that index.</li>
<li>If our pivot comes before the “kth largest” index, perform quickselect on the right partition.</li>
<li>If our pivot comes after the “kth largest” index, perform quickselect on the left partition.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findKthLargest</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> quickSelect(nums, <span class="number">0</span>, nums.length-<span class="number">1</span>, nums.length-k);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">quickSelect</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> left, <span class="type">int</span> right, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> (left == right) <span class="keyword">return</span> nums[left];</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> <span class="variable">pIndex</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(right - left + <span class="number">1</span>) + left;</span><br><span class="line">	pIndex = partition(nums, left, right, pIndex);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (pIndex == k) <span class="keyword">return</span> nums[k];</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (pIndex &lt; k) <span class="keyword">return</span> quickSelect(nums, pIndex+<span class="number">1</span>, right, k);</span><br><span class="line">	<span class="keyword">return</span> quickSelect(nums, left, pIndex-<span class="number">1</span>, k);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> left, <span class="type">int</span> right, <span class="type">int</span> pIndex)</span> &#123;</span><br><span class="line">	<span class="type">int</span> <span class="variable">pivot</span> <span class="operator">=</span> nums[pIndex];</span><br><span class="line">	swap(nums, pIndex, right);</span><br><span class="line">	pIndex = left;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i=left; i&lt;=right; i++) </span><br><span class="line">		<span class="keyword">if</span> (nums[i] &lt;= pivot) </span><br><span class="line">			swap(nums, i, pIndex++);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> pIndex - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">	<span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> nums[x];</span><br><span class="line">	nums[x] = nums[y];</span><br><span class="line">	nums[y] = temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="传统快排！"><a href="#传统快排！" class="headerlink" title="传统快排！"></a>传统快排！</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">Random rand=<span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findKthLargest</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="type">int</span> low=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> high=n-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(low&lt;=high)&#123;</span><br><span class="line">        <span class="type">int</span> j=partition(nums,low,high);</span><br><span class="line">        <span class="keyword">if</span>(j&lt;n-k)&#123;</span><br><span class="line">            low=j+<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(j&gt;n-k)&#123;</span><br><span class="line">            high=j-<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> nums[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> start, <span class="type">int</span> end)</span>&#123;</span><br><span class="line">    <span class="type">int</span> index=rand.nextInt(end-start+<span class="number">1</span>)+start;</span><br><span class="line">    swap(nums,start,index);</span><br><span class="line">    <span class="type">int</span> pivot=nums[start];</span><br><span class="line">    <span class="type">int</span> i=start+<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> j=end;</span><br><span class="line">    <span class="comment">//[start,i) &lt;=pivot</span></span><br><span class="line">    <span class="comment">//[i,j] unknown</span></span><br><span class="line">    <span class="comment">//(j,end] &gt;pivot</span></span><br><span class="line">    <span class="keyword">while</span>(i&lt;=j)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[j]&gt;pivot)&#123;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            swap(nums,i++,j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    swap(nums,start,j);</span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> i, <span class="type">int</span> j)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(i==j)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> temp=nums[i];</span><br><span class="line">    nums[i]=nums[j];</span><br><span class="line">    nums[j]=temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="462-Minimum-Moves-to-Equal-Array-Elements-II"><a href="#462-Minimum-Moves-to-Equal-Array-Elements-II" class="headerlink" title="462. Minimum Moves to Equal Array Elements II"></a>462. Minimum Moves to Equal Array Elements II</h2><p>In one move, you can increment or decrement an element of the array by <code>1</code>.</p>
<p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/minimum-moves-to-equal-array-elements-ii/discuss/2215782/Visual-Explanation-%2B-Interview-Tips-or-JAVA">https://leetcode.com/problems/minimum-moves-to-equal-array-elements-ii/discuss/2215782/Visual-Explanation-%2B-Interview-Tips-or-JAVA</a></p>
<p>Find the Median</p>
<h3 id="Approach-1-Sort"><a href="#Approach-1-Sort" class="headerlink" title="Approach 1: Sort"></a>Approach 1: Sort</h3><h3 id="Approach-2-Quick-Select"><a href="#Approach-2-Quick-Select" class="headerlink" title="Approach 2: Quick Select"></a>Approach 2: Quick Select</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">    Random rand=<span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minMoves2</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> median=kthSmallest(nums,nums.length/<span class="number">2</span>);</span><br><span class="line">        <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            res+=Math.abs(num-median);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">kthSmallest</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> k)</span>&#123;</span><br><span class="line">        <span class="type">int</span> n=nums.length;</span><br><span class="line">        <span class="type">int</span> left=<span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> right=n-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(left&lt;=right)&#123;</span><br><span class="line">            <span class="type">int</span> index=partition(nums,left,right);</span><br><span class="line">            <span class="keyword">if</span>(index==k)&#123;</span><br><span class="line">                <span class="keyword">return</span> nums[index];</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(index&lt;k)&#123;</span><br><span class="line">                left=index+<span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                right=index-<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> start, <span class="type">int</span> end)</span>&#123;</span><br><span class="line">        <span class="type">int</span> index=start+rand.nextInt(end-start+<span class="number">1</span>);</span><br><span class="line">        swap(nums,start,index);</span><br><span class="line">        <span class="type">int</span> left=start+<span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> right=end;</span><br><span class="line">        <span class="type">int</span> pivot=nums[start];</span><br><span class="line">        <span class="comment">//[start+1,left) &lt;=pivot</span></span><br><span class="line">        <span class="comment">//[left,right] unknown</span></span><br><span class="line">        <span class="comment">//(right,end] &gt;pivot</span></span><br><span class="line">        <span class="keyword">while</span>(left&lt;=right)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[right]&gt;pivot)&#123;</span><br><span class="line">                right--;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                swap(nums,left++,right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        swap(nums,start,right);</span><br><span class="line">        <span class="keyword">return</span> right;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> i, <span class="type">int</span> j)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(i==j)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> temp=nums[i];</span><br><span class="line">        nums[i]=nums[j];</span><br><span class="line">        nums[j]=temp;</span><br><span class="line"><span class="comment">/*        a=a^b;</span></span><br><span class="line"><span class="comment">        b=a^b;//a^b^b</span></span><br><span class="line"><span class="comment">        a=a^b; //a^b^a*/</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>





<h2 id="453-Minimum-Moves-to-Equal-Array-Elements"><a href="#453-Minimum-Moves-to-Equal-Array-Elements" class="headerlink" title="453. Minimum Moves to Equal Array Elements"></a>453. Minimum Moves to Equal Array Elements</h2><p>let’s define sum as the sum of all the numbers, before any moves; minNum as the min number int the list; n is the length of the list;</p>
<p>After, say m moves, we get all the numbers as x , and we will get the following equation</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum + m * (n - 1) = x * n</span><br></pre></td></tr></table></figure>



<p>and actually,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x = minNum + m</span><br></pre></td></tr></table></figure>



<p>This part may be a little confusing, but @shijungg explained very well. let me explain a little again. it comes from two observations:</p>
<ol>
<li>the minum number will always be minum until it reachs the final number, because every move, other numbers (besides the max) will be increamented too;</li>
<li>from above, we can get, the minum number will be incremented in every move. So, if the final number is x, it would be minNum + moves;</li>
</ol>
<p>and finally, we will get</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum - minNum * n = m</span><br></pre></td></tr></table></figure>



<p>This is just a math calculation.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sum+m*(n-1)=n*x</span></span><br><span class="line"><span class="comment">//x=minNum+m</span></span><br><span class="line"><span class="comment">//sum+m*(n-1)=n*(minNum+m)</span></span><br><span class="line"><span class="comment">//sum-m=n*minNum</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minMoves</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> min=Integer.MAX_VALUE;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">        sum+=num;</span><br><span class="line">        min=Math.min(min,num);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum-n*min;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://invincible-nerd.github.io/2023/01/09/Array-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="invincible-nerd">
      <meta itemprop="description" content="For explorer everywhere">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IVN">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/09/Array-2/" class="post-title-link" itemprop="url">Array(2)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-09 17:59:44" itemprop="dateCreated datePublished" datetime="2023-01-09T17:59:44+08:00">2023-01-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-01 11:19:00" itemprop="dateModified" datetime="2023-03-01T11:19:00+08:00">2023-03-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LeetCode/" itemprop="url" rel="index"><span itemprop="name">LeetCode</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>20k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>18 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Array好题选编（2）"><a href="#Array好题选编（2）" class="headerlink" title="Array好题选编（2）"></a>Array好题选编（2）</h1><h2 id="334-Increasing-Triplet-Subsequence"><a href="#334-Increasing-Triplet-Subsequence" class="headerlink" title="334. Increasing Triplet Subsequence"></a>334. Increasing Triplet Subsequence</h2><p><strong>Follow up:</strong> Could you implement a solution that runs in <code>O(n)</code> time complexity and <code>O(1)</code> space complexity?</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">increasingTriplet</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">            <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="keyword">if</span>(n&lt;<span class="number">3</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> left=Integer.MAX_VALUE;</span><br><span class="line">    <span class="type">int</span> mid=Integer.MAX_VALUE;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[i]&gt;mid)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(nums[i]&gt;left &amp;&amp; nums[i]&lt;mid)&#123;</span><br><span class="line">            mid=nums[i];</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(nums[i]&lt;left)&#123;</span><br><span class="line">            left=nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="361-Bomb-Enemy"><a href="#361-Bomb-Enemy" class="headerlink" title="361. Bomb Enemy"></a>361. Bomb Enemy</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxKilledEnemies</span><span class="params">(<span class="type">char</span>[][] grid)</span> &#123;</span><br><span class="line">    <span class="type">int</span> row=grid.length;</span><br><span class="line">    <span class="type">int</span> col=grid[<span class="number">0</span>].length;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; row; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; col; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(grid[i][j]==<span class="string">&#x27;0&#x27;</span>)&#123;</span><br><span class="line">                <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> x=i-<span class="number">1</span>; x&gt;=<span class="number">0</span> ; x--)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(grid[x][j]==<span class="string">&#x27;W&#x27;</span>)&#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(grid[x][j]==<span class="string">&#x27;E&#x27;</span>)&#123;</span><br><span class="line">                        count++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> x=i+<span class="number">1</span>; x&lt;row ; x++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(grid[x][j]==<span class="string">&#x27;W&#x27;</span>)&#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(grid[x][j]==<span class="string">&#x27;E&#x27;</span>)&#123;</span><br><span class="line">                        count++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> y=j-<span class="number">1</span>; y&gt;=<span class="number">0</span> ; y--)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(grid[i][y]==<span class="string">&#x27;W&#x27;</span>)&#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(grid[i][y]==<span class="string">&#x27;E&#x27;</span>)&#123;</span><br><span class="line">                        count++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> y=j+<span class="number">1</span>; y&lt;col ; y++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(grid[i][y]==<span class="string">&#x27;W&#x27;</span>)&#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(grid[i][y]==<span class="string">&#x27;E&#x27;</span>)&#123;</span><br><span class="line">                        count++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                res=Math.max(res,count);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="325-Maximum-Size-Subarray-Sum-Equals-k"><a href="#325-Maximum-Size-Subarray-Sum-Equals-k" class="headerlink" title="325. Maximum Size Subarray Sum Equals k"></a>325. Maximum Size Subarray Sum Equals k</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxSubArrayLen</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">currSum</span> <span class="operator">=</span> <span class="number">0</span>, maxLen = <span class="number">0</span>; <span class="comment">// set initial values for cumulative sum and max length sum to k</span></span><br><span class="line">    HashMap&lt;Integer, Integer&gt; sumToIndexMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Integer, Integer&gt;(); <span class="comment">// key: cumulative sum until index i, value: i</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        currSum = currSum + nums[i]; <span class="comment">// update cumulative sum</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// two cases where we can update maxLen</span></span><br><span class="line">        <span class="keyword">if</span> (currSum == k) maxLen = i + <span class="number">1</span>; <span class="comment">// case 1: cumulative sum is k, update maxLen for sure</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (sumToIndexMap.containsKey(currSum - k)) maxLen = Math.max(maxLen, i - sumToIndexMap.get(currSum - k)); <span class="comment">// case 2: cumulative sum is more than k, but we can truncate a prefix of the array</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// store cumulative sum in map, only if it is not seen</span></span><br><span class="line">        <span class="comment">// because only the earlier (thus shorter) subarray is valuable, when we want to get the maxLen after truncation</span></span><br><span class="line">        <span class="keyword">if</span> (!sumToIndexMap.containsKey(currSum)) sumToIndexMap.put(currSum, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> maxLen;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxSubArrayLen</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    Map&lt;Integer,Integer&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="type">int</span> curSum=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        curSum+=nums[i];    <span class="comment">//[0,i]</span></span><br><span class="line">        <span class="keyword">if</span>(curSum==k)&#123;</span><br><span class="line">            res=Math.max(res,i+<span class="number">1</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(map.containsKey(curSum-k))&#123;</span><br><span class="line">            <span class="type">int</span> index=map.get(curSum-k);    <span class="comment">//[0,index]</span></span><br><span class="line">            <span class="comment">//[index+1,i] = k</span></span><br><span class="line">            res=Math.max(res,i-index);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!map.containsKey(curSum))&#123;</span><br><span class="line">            map.put(curSum,i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="373-Find-K-Pairs-with-Smallest-Sums"><a href="#373-Find-K-Pairs-with-Smallest-Sums" class="headerlink" title="373. Find K Pairs with Smallest Sums"></a>373. Find K Pairs with Smallest Sums</h2><h3 id="法一：没看懂"><a href="#法一：没看懂" class="headerlink" title="法一：没看懂"></a>法一：没看懂</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;<span class="type">int</span>[]&gt; kSmallestPairs(<span class="type">int</span>[] nums1, <span class="type">int</span>[] nums2, <span class="type">int</span> k) &#123;</span><br><span class="line">        PriorityQueue&lt;<span class="type">int</span>[]&gt; que = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;((a,b)-&gt;a[<span class="number">0</span>]+a[<span class="number">1</span>]-b[<span class="number">0</span>]-b[<span class="number">1</span>]);</span><br><span class="line">        List&lt;<span class="type">int</span>[]&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span>(nums1.length==<span class="number">0</span> || nums2.length==<span class="number">0</span> || k==<span class="number">0</span>) <span class="keyword">return</span> res;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;nums1.length &amp;&amp; i&lt;k; i++) que.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;nums1[i], nums2[<span class="number">0</span>], <span class="number">0</span>&#125;);</span><br><span class="line">        <span class="keyword">while</span>(k-- &gt; <span class="number">0</span> &amp;&amp; !que.isEmpty())&#123;</span><br><span class="line">            <span class="type">int</span>[] cur = que.poll();</span><br><span class="line">            res.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;cur[<span class="number">0</span>], cur[<span class="number">1</span>]&#125;);</span><br><span class="line">            <span class="keyword">if</span>(cur[<span class="number">2</span>] == nums2.length-<span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            que.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;cur[<span class="number">0</span>],nums2[cur[<span class="number">2</span>]+<span class="number">1</span>], cur[<span class="number">2</span>]+<span class="number">1</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>I was asked this question in a top company’s onsite interview. I presented this approach specifically the index pair approach like <a target="_blank" rel="noopener" href="https://leetcode.com/EddieCarrillo">@EddieCarrillo</a> ‘s and the interviewer didn’t buy it. He thought this will not work as when you poll index pair [i, j] out, the next could be <strong>[i + 1, j]</strong> or <strong>[i, j + 1]</strong>, why did you <strong>only</strong> add [i, j + 1] to the queue? I tried to explain it in different ways, like thinking it as multiple linked lists, showing an example, and so on. He didn’t agree and still considered this as a wrong approach.</p>
<p>I came back and kept asking myself, how could I have explained this better? Here is they way I would have done:</p>
<p>When index pair [i, j] is polled out from the Priority Queue, it’s guaranteed that there is a pair [i + 1, <strong>x</strong>] is in the queue. (except its the last pair which we don’t need next pair)<br>Why is it? because we added all the smallest possible pairs [0, 0], [1, 0]…..[Min(k, n), 0].<br>Now for x, there are three cases:</p>
<ul>
<li>if x &lt; j, that means [i +1, x] is smaller than [i + 1, j]. Thus, [i + 1, j] won’t be a candidate. And it will be reached later by increasing x in [i + 1, x].</li>
<li>if x &gt; j, that means [i + 1, x] is larger than [i + 1, j]. Thus, [i + 1, j] is already in the result, we should not consider it again.</li>
<li>if x &#x3D; j, that’s the same pair. We should not add it to queue.</li>
</ul>
<p>The damage on me is done. I just hope the interviewer come across this post and have an aha moment so that the future interviewees won’t be affected.</p>
<h3 id="法二：想象成有序二维数组-好！"><a href="#法二：想象成有序二维数组-好！" class="headerlink" title="法二：想象成有序二维数组 好！"></a>法二：想象成有序二维数组 好！</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># # # # # ? . .</span><br><span class="line"># # # ? . . . .</span><br><span class="line"># ? . . . . . .   &quot;#&quot; means pair already in the output</span><br><span class="line"># ? . . . . . .   &quot;?&quot; means pair currently in the queue</span><br><span class="line"># ? . . . . . .</span><br><span class="line">? . . . . . . .</span><br><span class="line">. . . . . . . .</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">kSmallestPairs</span><span class="params">(<span class="type">int</span>[] nums1, <span class="type">int</span>[] nums2, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    PriorityQueue&lt;<span class="type">int</span>[]&gt; pq=<span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;((a,b)-&gt;(a[<span class="number">2</span>]-b[<span class="number">2</span>]));</span><br><span class="line">    <span class="type">int</span> n1=nums1.length;</span><br><span class="line">    <span class="type">int</span> n2=nums2.length;</span><br><span class="line">    <span class="comment">//[0,n1-1]  j</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="comment">//i</span></span><br><span class="line">    <span class="comment">//n2-1</span></span><br><span class="line">    pq.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0</span>,<span class="number">0</span>,nums1[<span class="number">0</span>]+nums2[<span class="number">0</span>]&#125;);</span><br><span class="line">    <span class="keyword">while</span>(!pq.isEmpty() &amp;&amp; k--&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="type">int</span>[] cur=pq.poll();</span><br><span class="line">        <span class="type">int</span> i=cur[<span class="number">1</span>];</span><br><span class="line">        <span class="type">int</span> j=cur[<span class="number">0</span>];</span><br><span class="line">        res.add(Arrays.asList(nums1[j],nums2[i]));</span><br><span class="line">        <span class="keyword">if</span>(j!=n1-<span class="number">1</span>)&#123;</span><br><span class="line">            pq.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;j+<span class="number">1</span>,i,nums1[j+<span class="number">1</span>]+nums2[i]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(j==<span class="number">0</span> &amp;&amp; i+<span class="number">1</span>&lt;n2)&#123;</span><br><span class="line">            pq.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;j,i+<span class="number">1</span>,nums1[j]+nums2[i+<span class="number">1</span>]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="23-Merge-k-Sorted-Lists"><a href="#23-Merge-k-Sorted-Lists" class="headerlink" title="23. Merge k Sorted Lists"></a>23. Merge k Sorted Lists</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">mergeKLists</span><span class="params">(ListNode[] lists)</span> &#123;</span><br><span class="line">    </span><br><span class="line">    PriorityQueue&lt;ListNode&gt; heap=<span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;((Comparator&lt;ListNode&gt;)(o1,o2)-&gt;o1.val-o2.val); <span class="comment">//升序</span></span><br><span class="line">    <span class="keyword">for</span> (ListNode node : lists) &#123;</span><br><span class="line">        <span class="keyword">if</span>(node!=<span class="literal">null</span>)&#123;</span><br><span class="line">            heap.offer(node); <span class="comment">//按优先级插入各个链表的头结点</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ListNode pre=<span class="keyword">new</span> <span class="title class_">ListNode</span>(-<span class="number">1</span>);<span class="comment">//空白头结点，指向新链表的第一个结点</span></span><br><span class="line">    ListNode temp=pre;</span><br><span class="line">    <span class="keyword">while</span>(!heap.isEmpty())&#123;</span><br><span class="line">        ListNode curr=heap.poll(); <span class="comment">//获取并移除队列头(当前最小值)</span></span><br><span class="line">        temp.next=<span class="keyword">new</span> <span class="title class_">ListNode</span>(curr.val);<span class="comment">//头插入新链表</span></span><br><span class="line">        <span class="keyword">if</span>(curr.next!=<span class="literal">null</span>)&#123;<span class="comment">//若该原链表非空，则还有剩余结点</span></span><br><span class="line">            heap.offer(curr.next);<span class="comment">//将当前最小值的后一个结点入队</span></span><br><span class="line">        &#125;</span><br><span class="line">        temp=temp.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pre.next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>初代hard不如中代medium</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">mergeKLists</span><span class="params">(ListNode[] lists)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(lists.length==<span class="number">0</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">    PriorityQueue&lt;ListNode&gt; pq=<span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;((a,b)-&gt;(a.val-b.val));</span><br><span class="line">    ListNode dummy=<span class="keyword">new</span> <span class="title class_">ListNode</span>(-<span class="number">1</span>);</span><br><span class="line">    ListNode pre=dummy;</span><br><span class="line">    ListNode p=<span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (ListNode list : lists) &#123;</span><br><span class="line">        <span class="keyword">if</span>(list!=<span class="literal">null</span>)&#123;</span><br><span class="line">            pq.offer(list);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!pq.isEmpty())&#123;</span><br><span class="line">        p=pq.poll();</span><br><span class="line">        <span class="keyword">if</span>(p.next!=<span class="literal">null</span>)&#123;</span><br><span class="line">            pq.offer(p.next);</span><br><span class="line">        &#125;</span><br><span class="line">        pre.next=p;</span><br><span class="line">        pre=pre.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dummy.next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="368-Largest-Divisible-Subset"><a href="#368-Largest-Divisible-Subset" class="headerlink" title="368. Largest Divisible Subset"></a>368. Largest Divisible Subset</h2><p>注意：</p>
<ul>
<li>若只需求subset的大小，则只需dp数组</li>
<li>还需要求subset的每个元素，则需要另一个数组prev，记录当前元素的前一个元素</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">largestDivisibleSubset</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    <span class="type">int</span> max=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> index=-<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span>[] dp=<span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">    <span class="type">int</span>[] prev=<span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">    Arrays.fill(prev,-<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        dp[i]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i-<span class="number">1</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i]%nums[j]==<span class="number">0</span> &amp;&amp; dp[i]&lt;dp[j]+<span class="number">1</span>)&#123;</span><br><span class="line">                dp[i]=dp[j]+<span class="number">1</span>;</span><br><span class="line">                prev[i]=j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(dp[i]&gt;max)&#123;</span><br><span class="line">            max=dp[i];</span><br><span class="line">            index=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;Integer&gt; res=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">while</span>(index!=-<span class="number">1</span>)&#123;</span><br><span class="line">        res.add(nums[index]);</span><br><span class="line">        index=prev[index];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="377-Combination-Sum-IV"><a href="#377-Combination-Sum-IV" class="headerlink" title="377. Combination Sum IV"></a>377. Combination Sum IV</h2><p>无脑backtracking超时！</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">combinationSum4</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    n=nums.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        backtracking(nums,target-nums[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">backtracking</span><span class="params">(<span class="type">int</span>[] nums,  <span class="type">int</span> target)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(target&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(target==<span class="number">0</span>)&#123;</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(target-nums[i]&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        backtracking(nums,target-nums[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>用map减少重复运算</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n;</span><br><span class="line">Map&lt;Integer,Integer&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">combinationSum4</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    n=nums.length;</span><br><span class="line">    <span class="keyword">return</span> backtracking(nums,target);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">backtracking</span><span class="params">(<span class="type">int</span>[] nums,  <span class="type">int</span> target)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(target&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(target==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(map.containsKey(target))&#123;</span><br><span class="line">        <span class="keyword">return</span> map.get(target);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(target-nums[i]&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        res+=backtracking(nums,target-nums[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    map.put(target,res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="378-Kth-Smallest-Element-in-a-Sorted-Matrix"><a href="#378-Kth-Smallest-Element-in-a-Sorted-Matrix" class="headerlink" title="378. Kth Smallest Element in a Sorted Matrix"></a>378. Kth Smallest Element in a Sorted Matrix</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">kthSmallest</span><span class="params">(<span class="type">int</span>[][] matrix, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    PriorityQueue&lt;<span class="type">int</span>[]&gt; pq=<span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;((a,b)-&gt;(a[<span class="number">2</span>]-b[<span class="number">2</span>]));</span><br><span class="line">    <span class="type">int</span> row=matrix.length;</span><br><span class="line">    <span class="type">int</span> col=matrix[<span class="number">0</span>].length;</span><br><span class="line">    pq.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0</span>,<span class="number">0</span>,matrix[<span class="number">0</span>][<span class="number">0</span>]&#125;);</span><br><span class="line">    <span class="type">int</span> idx=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="type">int</span>[] cur=pq.poll();</span><br><span class="line">        <span class="keyword">if</span>(idx==k)&#123;</span><br><span class="line">            <span class="keyword">return</span> cur[<span class="number">2</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> i=cur[<span class="number">0</span>];</span><br><span class="line">        <span class="type">int</span> j=cur[<span class="number">1</span>];</span><br><span class="line">        idx++;</span><br><span class="line">        <span class="keyword">if</span>(j+<span class="number">1</span>&lt;col)&#123;</span><br><span class="line">            pq.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;i,j+<span class="number">1</span>,matrix[i][j+<span class="number">1</span>]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(j==<span class="number">0</span> &amp;&amp; i+<span class="number">1</span>&lt;row)&#123;</span><br><span class="line">            pq.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;i+<span class="number">1</span>,j,matrix[i+<span class="number">1</span>][j]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="413-Arithmetic-Slices"><a href="#413-Arithmetic-Slices" class="headerlink" title="413. Arithmetic Slices"></a>413. Arithmetic Slices</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">numberOfArithmeticSlices</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= n-<span class="number">3</span>; i++) &#123;</span><br><span class="line">        <span class="comment">//[n-3,n-2,n-1]</span></span><br><span class="line">        <span class="keyword">if</span>(nums[i+<span class="number">1</span>]-nums[i]==nums[i+<span class="number">2</span>]-nums[i+<span class="number">1</span>])&#123;</span><br><span class="line">            res++;</span><br><span class="line">            <span class="type">int</span> dif=nums[i+<span class="number">1</span>]-nums[i];</span><br><span class="line">            <span class="type">int</span> j=i+<span class="number">3</span>;</span><br><span class="line">            <span class="keyword">while</span>(j&lt;n &amp;&amp; nums[j]-nums[j-<span class="number">1</span>]==dif)&#123;</span><br><span class="line">                j++;</span><br><span class="line">                res++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="477-Total-Hamming-Distance"><a href="#477-Total-Hamming-Distance" class="headerlink" title="477. Total Hamming Distance"></a>477. Total Hamming Distance</h2><h3 id="Approach-1-Brute-Force-Time-Limit-Exceeded"><a href="#Approach-1-Brute-Force-Time-Limit-Exceeded" class="headerlink" title="Approach #1 Brute Force [Time Limit Exceeded]"></a>Approach #1 Brute Force [Time Limit Exceeded]</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">totalHammingDistance</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i+<span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">            res+=hamming(nums[i],nums[j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">hamming</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>&#123;</span><br><span class="line">    <span class="type">int</span> c=a^b;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(c!=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>((c&amp;<span class="number">1</span>)==<span class="number">1</span>)&#123;</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">        c&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Approach-2-Loop-over-the-bits-Accepted"><a href="#Approach-2-Loop-over-the-bits-Accepted" class="headerlink" title="Approach #2 Loop over the bits! [Accepted]"></a>Approach #2 Loop over the bits! [Accepted]</h3><p>For each bit position 1-32 in a 32-bit integer, we count the number of integers in the array which have that bit set. Then, if there are n integers in the array and k of them have a particular bit set and (n-k) do not, then that bit contributes k*(n-k) hamming distance to the total.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">totalHammingDistance</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">total</span> <span class="operator">=</span> <span class="number">0</span>, n = nums.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">32</span>;j++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">bitCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) </span><br><span class="line">            bitCount += (nums[i] &gt;&gt; j) &amp; <span class="number">1</span>;</span><br><span class="line">        total += bitCount*(n - bitCount);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> total;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">totalHammingDistance</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            <span class="keyword">if</span>((num&amp;(<span class="number">1</span>&lt;&lt;i))!=<span class="number">0</span>)&#123;</span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        res+=count*(n-count);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="31-Next-Permutation"><a href="#31-Next-Permutation" class="headerlink" title="31. Next Permutation"></a>31. Next Permutation</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">nextPermutation</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="comment">//find first non-ascending, i</span></span><br><span class="line">    <span class="comment">//find first &gt; i , j</span></span><br><span class="line">    <span class="comment">//swap i,j</span></span><br><span class="line">    <span class="comment">//reverse [i+1,end]</span></span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="type">int</span> i=n-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&gt;<span class="number">0</span> &amp;&amp; nums[i-<span class="number">1</span>]&gt;=nums[i])&#123;</span><br><span class="line">        i--;</span><br><span class="line">    &#125;</span><br><span class="line">    i--;</span><br><span class="line">    <span class="keyword">if</span>(i&lt;<span class="number">0</span>)&#123;</span><br><span class="line">        reverse(nums,<span class="number">0</span>,n-<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> j=n-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>( ;j&gt;i; j--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[j]&gt;nums[i])&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    swap(nums,i,j);</span><br><span class="line">    reverse(nums,i+<span class="number">1</span>,n-<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">reverse</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> start, <span class="type">int</span> end)</span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(start&lt;end)&#123;</span><br><span class="line">        swap(nums,start++,end--);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> i, <span class="type">int</span> j)</span>&#123;</span><br><span class="line">    <span class="type">int</span> temp=nums[i];</span><br><span class="line">    nums[i]=nums[j];</span><br><span class="line">    nums[j]=temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="498-Diagonal-Traverse"><a href="#498-Diagonal-Traverse" class="headerlink" title="498. Diagonal Traverse"></a>498. Diagonal Traverse</h2><h3 id="法一："><a href="#法一：" class="headerlink" title="法一："></a>法一：</h3><p>easy to think but requires extra space</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] findDiagonalOrder(<span class="type">int</span>[][] mat) &#123;</span><br><span class="line">    TreeMap&lt;Integer, LinkedList&lt;Integer&gt;&gt; map=<span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span> row=mat.length;</span><br><span class="line">    <span class="type">int</span> col=mat[<span class="number">0</span>].length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; row; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; col; j++) &#123;</span><br><span class="line">            <span class="type">int</span> idx=i+j;</span><br><span class="line">            map.putIfAbsent(idx,<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;());</span><br><span class="line">            <span class="keyword">if</span>(idx%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">                map.get(idx).addFirst(mat[i][j]);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                map.get(idx).add(mat[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span>[] res=<span class="keyword">new</span> <span class="title class_">int</span>[row*col];</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (Integer idx : map.keySet()) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Integer num : map.get(idx)) &#123;</span><br><span class="line">            res[i++]=num;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="法二："><a href="#法二：" class="headerlink" title="法二："></a>法二：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] findDiagonalOrder(<span class="type">int</span>[][] matrix) &#123;</span><br><span class="line"><span class="keyword">if</span> (matrix == <span class="literal">null</span> || matrix.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> <span class="number">0</span>, col = <span class="number">0</span>, pos = <span class="number">0</span>, m = matrix.length, n=matrix[<span class="number">0</span>].length, output [] = <span class="keyword">new</span> <span class="title class_">int</span>[m * n];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (pos = <span class="number">0</span>; pos &lt; m * n; pos++) &#123;</span><br><span class="line">    output[pos] = matrix[row][col];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((row + col) % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// The direction is always up when the sum of row &amp; col is even</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// For last column, go down</span></span><br><span class="line">        <span class="keyword">if</span> (col == n-<span class="number">1</span>) &#123; row++; &#125;                </span><br><span class="line">        </span><br><span class="line">        <span class="comment">// For first row &amp; non-last columns, go right</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (row == <span class="number">0</span>) &#123; col++; &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// For not first row &amp; non-last columns, go up and to the right</span></span><br><span class="line">        <span class="keyword">else</span> &#123; row--; col++; &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// The direction is always down when the sum of row &amp; col is odd</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// For last row, go right</span></span><br><span class="line">        <span class="keyword">if</span> (row == m-<span class="number">1</span>) &#123; col++; &#125; </span><br><span class="line">        </span><br><span class="line">        <span class="comment">//  For non-last row &amp; first column, go down</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (col == <span class="number">0</span>) &#123; row++; &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// For non-last row &amp; non-first column, go down and to the left</span></span><br><span class="line">        <span class="keyword">else</span> &#123; row++; col--; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] findDiagonalOrder(<span class="type">int</span>[][] mat) &#123;</span><br><span class="line">    <span class="type">int</span> row=mat.length;</span><br><span class="line">    <span class="type">int</span> col=mat[<span class="number">0</span>].length;</span><br><span class="line">    <span class="type">int</span>[] res=<span class="keyword">new</span> <span class="title class_">int</span>[row*col];</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> y=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;row*col)&#123;</span><br><span class="line">        res[i++]=mat[x][y];</span><br><span class="line">        <span class="keyword">if</span>((x+y)%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(y==col-<span class="number">1</span>)&#123;</span><br><span class="line">                x++;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(x==<span class="number">0</span>)&#123;</span><br><span class="line">                y++;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                x--;</span><br><span class="line">                y++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(x==row-<span class="number">1</span>)&#123;</span><br><span class="line">                y++;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(y==<span class="number">0</span>)&#123;</span><br><span class="line">                x++;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                x++;</span><br><span class="line">                y--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="581-Shortest-Unsorted-Continuous-Subarray"><a href="#581-Shortest-Unsorted-Continuous-Subarray" class="headerlink" title="581. Shortest Unsorted Continuous Subarray"></a>581. Shortest Unsorted Continuous Subarray</h2><p>好题！</p>
<p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/shortest-unsorted-continuous-subarray/solution/">https://leetcode.com/problems/shortest-unsorted-continuous-subarray/solution/</a></p>
<h3 id="Approach-4-Using-Stack"><a href="#Approach-4-Using-Stack" class="headerlink" title="Approach 4: Using Stack"></a>Approach 4: Using Stack</h3><p>two monotonic stacks</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findUnsortedSubarray</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="type">int</span> l=n;</span><br><span class="line">    <span class="type">int</span> r=<span class="number">0</span>;</span><br><span class="line">    Deque&lt;Integer&gt; stack=<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">while</span>(!stack.isEmpty() &amp;&amp; nums[i]&lt;nums[stack.peek()])&#123;</span><br><span class="line">            l=Math.min(l,stack.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        stack.push(i);</span><br><span class="line">    &#125;</span><br><span class="line">    stack.clear();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> n-<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">while</span>(!stack.isEmpty() &amp;&amp; nums[i]&gt;nums[stack.peek()])&#123;</span><br><span class="line">            r=Math.max(r,stack.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        stack.push(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l&lt;r ? r-l+<span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Approach-5-Without-Using-Extra-Space"><a href="#Approach-5-Without-Using-Extra-Space" class="headerlink" title="Approach 5: Without Using Extra Space"></a>Approach 5: Without Using Extra Space</h3><h2 id="554-Brick-Wall"><a href="#554-Brick-Wall" class="headerlink" title="554. Brick Wall"></a>554. Brick Wall</h2><p>妙用hashmap</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">leastBricks</span><span class="params">(List&lt;List&lt;Integer&gt;&gt; wall)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=wall.size();</span><br><span class="line">    Map&lt;Integer,Integer&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (List&lt;Integer&gt; row : wall) &#123;</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; row.size()-<span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="type">int</span> brick=row.get(j);</span><br><span class="line">            i+=brick;</span><br><span class="line">            map.put(i,map.getOrDefault(i,<span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> max=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (Integer i : map.keySet()) &#123;</span><br><span class="line">        max=Math.max(max,map.get(i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n-max;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="611-Valid-Triangle-Number"><a href="#611-Valid-Triangle-Number" class="headerlink" title="611. Valid Triangle Number"></a>611. Valid Triangle Number</h2><p>花里胡哨，不如brute force</p>
<p>why: nums.length较小，未发挥出优势</p>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= nums.length &lt;= 1000</code></li>
<li><code>0 &lt;= nums[i] &lt;= 1000</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">triangleNumber</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="type">int</span>[] arr=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">1001</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">        arr[num]++;</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">1000</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[i]==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i; j &lt;= <span class="number">1000</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(arr[j]==<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> j; k &lt;= <span class="number">1000</span>; k++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(i+j&lt;=k)&#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(arr[k]==<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(i==j)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(j==k)&#123;</span><br><span class="line">                        res+=arr[i]*(arr[i]-<span class="number">1</span>)*(arr[i]-<span class="number">2</span>)/<span class="number">6</span>;</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        res+=arr[i]*(arr[i]-<span class="number">1</span>)*arr[k]/<span class="number">2</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(j==k)&#123;</span><br><span class="line">                    res+=arr[i]*arr[j]*(arr[j]-<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    res+=arr[i]*arr[j]*arr[k];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">triangleNumber</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i+<span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> j+<span class="number">1</span>; k &lt; n; k++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[i]+nums[j]&lt;=nums[k])&#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                res++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>much better!</p>
<p>注意k的定义，同一个i共用一个k,避免重复比较</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">triangleNumber</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n= nums.length;;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[i]==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> k=i+<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i+<span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="keyword">while</span>(k&lt;n &amp;&amp; nums[i]+nums[j]&gt;nums[k])&#123;</span><br><span class="line">                k++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//[j+1,k)</span></span><br><span class="line">            res+=k-j-<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="616-Add-Bold-Tag-in-String"><a href="#616-Add-Bold-Tag-in-String" class="headerlink" title="616. Add Bold Tag in String"></a>616. Add Bold Tag in String</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">addBoldTag</span><span class="params">(String s, String[] words)</span> &#123;</span><br><span class="line">    Arrays.sort(words,(a,b)-&gt;(b.length()-a.length()));</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    <span class="type">int</span> end=<span class="number">0</span>;  <span class="comment">//[i,end) is bold</span></span><br><span class="line">    <span class="type">boolean</span>[] bold=<span class="keyword">new</span> <span class="title class_">boolean</span>[n];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (String word : words) &#123;</span><br><span class="line">            <span class="keyword">if</span>(s.startsWith(word,i))&#123;</span><br><span class="line">                end=Math.max(end,i+word.length());</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        bold[i]=end&gt;i;	<span class="comment">//神之一手！</span></span><br><span class="line">    &#125;</span><br><span class="line">    StringBuilder sb=<span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!bold[i])&#123;</span><br><span class="line">            sb.append(s.charAt(i));</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> j=i+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(j&lt;n &amp;&amp; bold[j])&#123;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">        sb.append(<span class="string">&quot;&lt;b&gt;&quot;</span>);</span><br><span class="line">        sb.append(s.substring(i,j));</span><br><span class="line">        sb.append(<span class="string">&quot;&lt;/b&gt;&quot;</span>);</span><br><span class="line">        i=j-<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="621-Task-Scheduler"><a href="#621-Task-Scheduler" class="headerlink" title="621. Task Scheduler"></a>621. Task Scheduler</h2><p>greedy</p>
<p>hard to think</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">leastInterval</span><span class="params">(<span class="type">char</span>[] tasks, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] arr=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> total=tasks.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> c : tasks) &#123;</span><br><span class="line">        arr[c-<span class="string">&#x27;A&#x27;</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    Arrays.sort(arr);</span><br><span class="line">    <span class="type">int</span> max=arr[<span class="number">25</span>]-<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> idle=max*n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">24</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[i]==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        idle-=Math.min(max,arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> total+Math.max(idle,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="2365-Task-Scheduler-II"><a href="#2365-Task-Scheduler-II" class="headerlink" title="2365. Task Scheduler II"></a>2365. Task Scheduler II</h2><p> tasks that need to be completed <strong>in order</strong></p>
<p>老老实实 simulation</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">long</span> <span class="title function_">taskSchedulerII</span><span class="params">(<span class="type">int</span>[] tasks, <span class="type">int</span> space)</span> &#123;</span><br><span class="line">    <span class="type">long</span> t=<span class="number">0</span>;</span><br><span class="line">    Map&lt;Integer,Long&gt; next=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();  <span class="comment">//next starting time</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> task : tasks) &#123;</span><br><span class="line">        <span class="type">long</span> time=next.containsKey(task) ? next.get(task) : <span class="number">0</span>;</span><br><span class="line">        t=Math.max(t,time);</span><br><span class="line">        t++;</span><br><span class="line">        next.put(task,t+space);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="769-Max-Chunks-To-Make-Sorted"><a href="#769-Max-Chunks-To-Make-Sorted" class="headerlink" title="769. Max Chunks To Make Sorted"></a>769. Max Chunks To Make Sorted</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxChunksToSorted</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="comment">//1 0 2 3 4</span></span><br><span class="line">    <span class="comment">//4 1 2 3 0</span></span><br><span class="line">    <span class="comment">//arr[0,i] should be 0,1,2,...,i</span></span><br><span class="line">    <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> max=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> n=arr.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        max=Math.max(max,arr[i]);</span><br><span class="line">        <span class="keyword">if</span>(i==max)&#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="768-Max-Chunks-To-Make-Sorted-II"><a href="#768-Max-Chunks-To-Make-Sorted-II" class="headerlink" title="768. Max Chunks To Make Sorted II"></a>768. Max Chunks To Make Sorted II</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxChunksToSorted</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=arr.length;</span><br><span class="line">    <span class="type">int</span>[] rightMin=<span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">    rightMin[n-<span class="number">1</span>]=arr[n-<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> n-<span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        rightMin[i]=Math.min(rightMin[i+<span class="number">1</span>],arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> leftMax=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n-<span class="number">1</span>; i++) &#123;</span><br><span class="line">        leftMax=Math.max(leftMax,arr[i]);</span><br><span class="line">        <span class="keyword">if</span>(leftMax&lt;=rightMin[i+<span class="number">1</span>])&#123;</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="658-Find-K-Closest-Elements"><a href="#658-Find-K-Closest-Elements" class="headerlink" title="658. Find K Closest Elements"></a>658. Find K Closest Elements</h2><p>蛮力：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">findClosestElements</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> k, <span class="type">int</span> x)</span> &#123;</span><br><span class="line">    PriorityQueue&lt;Integer&gt; q=<span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Integer&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Integer a, Integer b)</span> &#123;</span><br><span class="line">            <span class="type">int</span> v1=Math.abs(a-x);</span><br><span class="line">            <span class="type">int</span> v2=Math.abs(b-x);</span><br><span class="line">            <span class="keyword">return</span> v1==v2 ? a-b : v1-v2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : arr) &#123;</span><br><span class="line">        q.offer(num);</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;Integer&gt; res=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i++&lt;k)&#123;</span><br><span class="line">        res.add(q.poll());</span><br><span class="line">    &#125;</span><br><span class="line">    Collections.sort(res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>化劲儿：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">findClosestElements</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> k, <span class="type">int</span> x)</span> &#123;</span><br><span class="line">    <span class="type">int</span> low=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> high=arr.length-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(high-low+<span class="number">1</span>&gt;k)&#123;</span><br><span class="line">        <span class="keyword">if</span>(Math.abs(arr[high]-x)&lt;Math.abs(arr[low]-x))&#123;</span><br><span class="line">            low++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            high--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;Integer&gt; res=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=low; i&lt;=high; i++)&#123;</span><br><span class="line">        res.add(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="735-Asteroid-Collision"><a href="#735-Asteroid-Collision" class="headerlink" title="735. Asteroid Collision"></a>735. Asteroid Collision</h2><p>stack的妙用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] asteroidCollision(<span class="type">int</span>[] asteroids) &#123;</span><br><span class="line">    <span class="type">int</span> n=asteroids.length;</span><br><span class="line">    Deque&lt;Integer&gt; stack=<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(asteroids[i]&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            stack.push(asteroids[i]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> val=-asteroids[i];</span><br><span class="line">            <span class="keyword">while</span>(!stack.isEmpty() &amp;&amp; stack.peek()&gt;<span class="number">0</span> &amp;&amp; stack.peek()&lt;val)&#123;</span><br><span class="line">                stack.pop();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(stack.isEmpty() || stack.peek()&lt;<span class="number">0</span>)&#123;</span><br><span class="line">                stack.push(asteroids[i]);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(stack.peek()==val)&#123;</span><br><span class="line">                stack.pop();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> len=stack.size();</span><br><span class="line">    <span class="type">int</span>[] res=<span class="keyword">new</span> <span class="title class_">int</span>[len];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> len-<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        res[i]=stack.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="274-H-Index"><a href="#274-H-Index" class="headerlink" title="274. H-Index"></a>274. H-Index</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hIndex</span><span class="params">(<span class="type">int</span>[] citations)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=citations.length;</span><br><span class="line">    Arrays.sort(citations);</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;n &amp;&amp; citations[n-<span class="number">1</span>-i]&gt;=i+<span class="number">1</span>)&#123;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="630-Course-Schedule-III"><a href="#630-Course-Schedule-III" class="headerlink" title="630. Course Schedule III"></a>630. Course Schedule III</h2><p>注意：</p>
<ul>
<li>it’s always better to take courses with smaller end time first</li>
<li>if unable to take, swap with the longest previous course</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">scheduleCourse</span><span class="params">(<span class="type">int</span>[][] courses)</span> &#123;</span><br><span class="line">    PriorityQueue&lt;Integer&gt; pq=<span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;((a,b)-&gt;(b-a));</span><br><span class="line">    Arrays.sort(courses,(a,b)-&gt;(a[<span class="number">1</span>]-b[<span class="number">1</span>]));</span><br><span class="line">    <span class="type">int</span> n=courses.length;</span><br><span class="line">    <span class="type">int</span> time=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">int</span>[] c=courses[i];</span><br><span class="line">        <span class="keyword">if</span>(time+c[<span class="number">0</span>]&lt;=c[<span class="number">1</span>])&#123;</span><br><span class="line">            pq.offer(c[<span class="number">0</span>]);</span><br><span class="line">            time+=c[<span class="number">0</span>];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(!pq.isEmpty() &amp;&amp; pq.peek()&gt;c[<span class="number">0</span>])&#123;</span><br><span class="line">                time+=c[<span class="number">0</span>]-pq.poll();</span><br><span class="line">                pq.offer(c[<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pq.size();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://invincible-nerd.github.io/2023/01/01/Bit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="invincible-nerd">
      <meta itemprop="description" content="For explorer everywhere">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IVN">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/Bit/" class="post-title-link" itemprop="url">Bit</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 20:54:25" itemprop="dateCreated datePublished" datetime="2023-01-01T20:54:25+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-09-06 02:04:57" itemprop="dateModified" datetime="2023-09-06T02:04:57+08:00">2023-09-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LeetCode/" itemprop="url" rel="index"><span itemprop="name">LeetCode</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>14k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>13 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Bit-x2F-Bit-Mask好题"><a href="#Bit-x2F-Bit-Mask好题" class="headerlink" title="Bit&#x2F;Bit_Mask好题"></a>Bit&#x2F;Bit_Mask好题</h1><h2 id="137-Single-Number-II"><a href="#137-Single-Number-II" class="headerlink" title="137. Single Number II"></a>137. Single Number II</h2><p><a target="_blank" rel="noopener" href="https://leetcode.com/kenanlv">@kenanlv</a> the part about XOR is often supposed to be textbook knowledge because of well-known swap implementation without tmp variable:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = a^b      # mix of a and b</span><br><span class="line">b = a^b      # a^b^b = a</span><br><span class="line">a = a^b      # a^b^a = b</span><br></pre></td></tr></table></figure>



<p>If you don’t know that idea, the interviewer would probably simplify the task, asking you first to solve the problem “each element appears <em>twice</em> except one, find that one.” That is a very straightforward XOR usage, like in swap above</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seen_once = seen_once^num</span><br></pre></td></tr></table></figure>



<p>Once you’ll figure that out, to go to the idea of two bitmasks instead of one is not a big deal, basically it’s</p>
<p>NOT seen_twice AND (CHANGE see_once)<br>NOT seen_once AND (CHANGE see_twice)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">singleNumber</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">seenOnce</span> <span class="operator">=</span> <span class="number">0</span>, seenTwice = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">      <span class="comment">// first appearence: </span></span><br><span class="line">      <span class="comment">// add num to seen_once </span></span><br><span class="line">      <span class="comment">// don&#x27;t add to seen_twice because of presence in seen_once</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// second appearance: </span></span><br><span class="line">      <span class="comment">// remove num from seen_once </span></span><br><span class="line">      <span class="comment">// add num to seen_twice</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// third appearance: </span></span><br><span class="line">      <span class="comment">// don&#x27;t add to seen_once because of presence in seen_twice</span></span><br><span class="line">      <span class="comment">// remove num from seen_twice</span></span><br><span class="line">      seenOnce = ~seenTwice &amp; (seenOnce ^ num);</span><br><span class="line">      seenTwice = ~seenOnce &amp; (seenTwice ^ num);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> seenOnce;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>开背！</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">singleNumber</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> seenOnce=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> seenTwice=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">        seenOnce=(~seenTwice) &amp; (seenOnce^num);</span><br><span class="line">        seenTwice=(~seenOnce) &amp; (seenTwice^num);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> seenOnce;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="260-Single-Number-III"><a href="#260-Single-Number-III" class="headerlink" title="260. Single Number III"></a>260. Single Number III</h2><p>The bitmask will have all the differences between x and y (the two singles). x has 0 and y has 1 or vice-versa in those bits. You take one difference, the rightmost one.<br>Iterate through array again dividing into two. The ones which has 1 on the rightmost different bit into one group and those who have 0 into another group.<br>Group1 : [x^a^a^b^b] &#x3D; x<br>Group2 : [y^c^c^d^d] &#x3D; y<br>bitmask^x &#x3D; y;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span>[] singleNumber(<span class="type">int</span>[] nums) &#123;</span><br><span class="line">    <span class="comment">// difference between two numbers (x and y) which were seen only once</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">bitmask</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) bitmask ^= num;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// rightmost 1-bit diff between x and y</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">diff</span> <span class="operator">=</span> bitmask &amp; (-bitmask);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// bitmask which will contain only x</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) <span class="keyword">if</span> ((num &amp; diff) != <span class="number">0</span>) x ^= num;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;x, bitmask^x&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] singleNumber(<span class="type">int</span>[] nums) &#123;</span><br><span class="line">    <span class="type">int</span> ab=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">        ab^=num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ab=a^b</span></span><br><span class="line">    <span class="type">int</span> r=ab&amp;(-ab);</span><br><span class="line">    <span class="type">int</span> a=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">        <span class="keyword">if</span>((num&amp;r)!=<span class="number">0</span>)&#123;</span><br><span class="line">            a^=num;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;a,ab^a&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="191-Number-of-1-Bits"><a href="#191-Number-of-1-Bits" class="headerlink" title="191. Number of 1 Bits"></a>191. Number of 1 Bits</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hammingWeight</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(n!=<span class="number">0</span>)&#123;</span><br><span class="line">        count+=n&amp;<span class="number">1</span>;</span><br><span class="line">        <span class="comment">//must use logical shift, not arithmetic shift</span></span><br><span class="line">        n&gt;&gt;&gt;=<span class="number">1</span>; <span class="comment">//n&gt;&gt;=1则不行</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="338-Counting-Bits"><a href="#338-Counting-Bits" class="headerlink" title="338. Counting Bits"></a>338. Counting Bits</h2><p><strong>Follow up:</strong></p>
<ul>
<li>It is very easy to come up with a solution with a runtime of <code>O(n log n)</code>. Can you do it in linear time <code>O(n)</code> and possibly in a single pass?</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0</span></span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="comment">//10</span></span><br><span class="line"><span class="comment">//11</span></span><br><span class="line"><span class="comment">//100</span></span><br><span class="line"><span class="comment">//101</span></span><br><span class="line"><span class="comment">//110</span></span><br><span class="line"><span class="comment">//111</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] countBits(<span class="type">int</span> n) &#123;</span><br><span class="line">    <span class="type">int</span>[] res=<span class="keyword">new</span> <span class="title class_">int</span>[n+<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        res[i]=res[i&gt;&gt;<span class="number">1</span>]+(i&amp;<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="89-Gray-Code"><a href="#89-Gray-Code" class="headerlink" title="89. Gray Code"></a>89. Gray Code</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">grayCode</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    Set&lt;Integer&gt; set=<span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    List&lt;Integer&gt; res=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    res.add(<span class="number">0</span>);</span><br><span class="line">    set.add(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> size=(<span class="type">int</span>)Math.pow(<span class="number">2</span>,n);</span><br><span class="line">    <span class="type">int</span> cur=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;size; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="comment">//use xor (1&lt;&lt;j) to flip one bit</span></span><br><span class="line">            <span class="type">int</span> next=cur^(<span class="number">1</span>&lt;&lt;j);</span><br><span class="line">            <span class="keyword">if</span>(!set.contains(next))&#123;</span><br><span class="line">                set.add(next);</span><br><span class="line">                res.add(next);</span><br><span class="line">                cur=next;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="371-Sum-of-Two-Integers"><a href="#371-Sum-of-Two-Integers" class="headerlink" title="371. Sum of Two Integers"></a>371. Sum of Two Integers</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getSum</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">    <span class="keyword">while</span>(b!=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="type">int</span> answer=a^b;</span><br><span class="line">        <span class="type">int</span> carry=(a&amp;b)&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        a=answer;</span><br><span class="line">        b=carry;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="1506-Find-Root-of-N-Ary-Tree"><a href="#1506-Find-Root-of-N-Ary-Tree" class="headerlink" title="1506. Find Root of N-Ary Tree"></a>1506. Find Root of N-Ary Tree</h2><p>注意：</p>
<ul>
<li>Each node has a <strong>unique</strong> value.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Node <span class="title function_">findRoot</span><span class="params">(List&lt;Node&gt; tree)</span> &#123;</span><br><span class="line">        Set&lt;Integer&gt; set=<span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Node node : tree) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Node child : node.children) &#123;</span><br><span class="line">                set.add(child.val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Node node : tree) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!set.contains(node.val))&#123;</span><br><span class="line">                <span class="keyword">return</span> node;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>Follow up:</strong></p>
<ul>
<li>Could you solve this problem in constant space complexity with a linear time algorithm?</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Node <span class="title function_">findRoot</span><span class="params">(List&lt;Node&gt; tree)</span> &#123;</span><br><span class="line">    <span class="type">int</span> num=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (Node node : tree) &#123;</span><br><span class="line">        <span class="keyword">if</span>(node.children.isEmpty())&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        num^=node.val;</span><br><span class="line">        <span class="keyword">for</span> (Node child : node.children) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!child.children.isEmpty())&#123;</span><br><span class="line">                num^=child.val;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (Node node : tree) &#123;</span><br><span class="line">        <span class="keyword">if</span>(node.val==num)&#123;</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> tree.get(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="1680-Concatenation-of-Consecutive-Binary-Numbers"><a href="#1680-Concatenation-of-Consecutive-Binary-Numbers" class="headerlink" title="1680. Concatenation of Consecutive Binary Numbers"></a>1680. Concatenation of Consecutive Binary Numbers</h2><h3 id="Approach-1-Change-to-Binary-String"><a href="#Approach-1-Change-to-Binary-String" class="headerlink" title="Approach 1: Change to Binary String"></a>Approach 1: Change to Binary String</h3><p>concatenate -&gt; &lt;&lt;1</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">concatenatedBinary</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> mod=(<span class="type">int</span>)<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">    <span class="type">long</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        String s=Integer.toBinaryString(i);<span class="comment">//O(logn)</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; s.length(); j++) &#123;</span><br><span class="line">            res=res*<span class="number">2</span>+s.charAt(j)-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            res%=mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">int</span>)res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Approach-3-Math-Bitwise-Operation"><a href="#Approach-3-Math-Bitwise-Operation" class="headerlink" title="Approach 3: Math (Bitwise Operation)"></a>Approach 3: Math (Bitwise Operation)</h3><h2 id="1404-Number-of-Steps-to-Reduce-a-Number-in-Binary-Representation-to-One"><a href="#1404-Number-of-Steps-to-Reduce-a-Number-in-Binary-Representation-to-One" class="headerlink" title="1404. Number of Steps to Reduce a Number in Binary Representation to One"></a>1404. Number of Steps to Reduce a Number in Binary Representation to One</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LeetCode1404</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">numSteps</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        BigInteger num=<span class="keyword">new</span> <span class="title class_">BigInteger</span>(s,<span class="number">2</span>);</span><br><span class="line">        BigInteger one=<span class="keyword">new</span> <span class="title class_">BigInteger</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        BigInteger two=<span class="keyword">new</span> <span class="title class_">BigInteger</span>(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">        <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(!num.equals(one))&#123;</span><br><span class="line">            <span class="comment">//判断BigInteger的奇偶性</span></span><br><span class="line">            <span class="keyword">if</span>(num.testBit(<span class="number">0</span>))&#123;</span><br><span class="line">                num=num.add(one);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                num=num.divide(two);</span><br><span class="line">            &#125;</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="1318-Minimum-Flips-to-Make-a-OR-b-Equal-to-c"><a href="#1318-Minimum-Flips-to-Make-a-OR-b-Equal-to-c" class="headerlink" title="1318. Minimum Flips to Make a OR b Equal to c"></a>1318. Minimum Flips to Make a OR b Equal to c</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minFlips</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span> &#123;</span><br><span class="line">    String s1=convert(a);</span><br><span class="line">    String s2=convert(b);</span><br><span class="line">    String s3=convert(c);</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        <span class="type">int</span> c1=s1.charAt(i)-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="type">int</span> c2=s2.charAt(i)-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="type">int</span> c3=s3.charAt(i)-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="type">int</span> or=c1|c2;</span><br><span class="line">        <span class="keyword">if</span>(or==c3)&#123;<span class="comment">//0 0, 1 1</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(or==<span class="number">0</span> &amp;&amp; c3==<span class="number">1</span>)&#123;<span class="comment">//0 1</span></span><br><span class="line">            res++;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(c1==<span class="number">1</span> &amp;&amp; c2==<span class="number">1</span>)&#123;</span><br><span class="line">            res+=<span class="number">2</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String <span class="title function_">convert</span><span class="params">(<span class="type">int</span> a)</span>&#123;</span><br><span class="line">    String s=Integer.toBinaryString(a);</span><br><span class="line">    StringBuilder sb=<span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">while</span>(sb.length()+s.length()&lt;<span class="number">32</span>)&#123;</span><br><span class="line">        sb.append(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    sb.append(s);</span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="2680-Maximum-OR"><a href="#2680-Maximum-OR" class="headerlink" title="2680. Maximum OR"></a>2680. Maximum OR</h2><p>Bit + Greedy</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">long</span> <span class="title function_">maximumOr</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="type">long</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="type">long</span> base=<span class="number">0</span>;</span><br><span class="line">    <span class="type">long</span> backup=<span class="number">0</span>; <span class="comment">//at least 2 occurrences for each 1 bit</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">        backup|=base&amp;num;</span><br><span class="line">        base|=num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//long: 10^19, no overflow</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">        res=Math.max(res,(base^num)|backup|(<span class="type">long</span>)num&lt;&lt;k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="2741-Special-Permutations"><a href="#2741-Special-Permutations" class="headerlink" title="2741. Special Permutations"></a>2741. Special Permutations</h2><p>dp + bit mask: using bit masks to present dp states</p>
<p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/special-permutations/discuss/3650431/Easy-BitMask-DP-with-explanation-of-overlapping-or-Top-Down-or-C%2B%2B-beats-100-100">https://leetcode.com/problems/special-permutations/discuss/3650431/Easy-BitMask-DP-with-explanation-of-overlapping-or-Top-Down-or-C%2B%2B-beats-100-100</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//overlapping subproblems in permutation? !</span></span><br><span class="line"><span class="comment">// nums=[3,6,9,36]</span></span><br><span class="line"><span class="comment">// [3,6,9,36] , pre=9, mask=1110</span></span><br><span class="line"><span class="comment">// [6,3,9,36] , pre=9, mask=1110</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span>[][] dp;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> mod=(<span class="type">int</span>)<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">specialPerm</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    dp=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">14</span>][<span class="number">16384</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span>[] arr : dp) &#123;</span><br><span class="line">        Arrays.fill(arr,-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    n=nums.length;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        res=(res+dfs(nums,<span class="number">1</span>,i,<span class="number">1</span>&lt;&lt;i))%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> size, <span class="type">int</span> pre, <span class="type">int</span> mask)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(size==n)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dp[pre][mask]!=-<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> dp[pre][mask];</span><br><span class="line">    &#125;</span><br><span class="line">    dp[pre][mask]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>((mask &amp; (<span class="number">1</span>&lt;&lt;i))!=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(nums[pre]%nums[i]==<span class="number">0</span> || nums[i]%nums[pre]==<span class="number">0</span>)&#123;</span><br><span class="line">            dp[pre][mask]=(dp[pre][mask]+dfs(nums,size+<span class="number">1</span>,i,mask|(<span class="number">1</span>&lt;&lt;i)))%mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[pre][mask];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="464-Can-I-Win"><a href="#464-Can-I-Win" class="headerlink" title="464. Can I Win"></a>464. Can I Win</h2><p>思考：</p>
<ul>
<li>be sensitive when seeing “permutation”, “draw from a common pool without replacement” &#x3D;&gt; DP with BitMask!</li>
<li>notice when seeing target &lt;&#x3D;0, <ul>
<li>if it is the first round, current player wins; </li>
<li>else current player loses.</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;Integer,Boolean&gt; memo=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> target;</span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">canIWin</span><span class="params">(<span class="type">int</span> maxChoosableInteger, <span class="type">int</span> desiredTotal)</span> &#123;</span><br><span class="line">    n=maxChoosableInteger;</span><br><span class="line">    target=desiredTotal;</span><br><span class="line">    <span class="type">int</span> sum=(<span class="number">1</span>+n)*n/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(target&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(sum&lt;target)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dfs(<span class="number">0</span>,target);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span> mask, <span class="type">int</span> target)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(target&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(memo.containsKey(mask))&#123;</span><br><span class="line">        <span class="keyword">return</span> memo.get(mask);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">boolean</span> res=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>((mask&amp;(<span class="number">1</span>&lt;&lt;i))==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!dfs(mask|(<span class="number">1</span>&lt;&lt;i),target-i))&#123;</span><br><span class="line">                res=<span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    memo.put(mask,res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="1125-Smallest-Sufficient-Team"><a href="#1125-Smallest-Sufficient-Team" class="headerlink" title="1125. Smallest Sufficient Team"></a>1125. Smallest Sufficient Team</h2><h3 id="backtracking-TLE"><a href="#backtracking-TLE" class="headerlink" title="backtracking, TLE"></a>backtracking, TLE</h3><p>36&#x2F;38</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; res=<span class="literal">null</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> len;</span><br><span class="line">Map&lt;String,Integer&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">List&lt;Integer&gt; list=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">String[] req_skills;</span><br><span class="line">List&lt;List&lt;String&gt;&gt; people;</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] smallestSufficientTeam(String[] req_skills, List&lt;List&lt;String&gt;&gt; people) &#123;</span><br><span class="line">    n= req_skills.length;</span><br><span class="line">    len=people.size();</span><br><span class="line">    <span class="built_in">this</span>.req_skills=req_skills;</span><br><span class="line">    <span class="built_in">this</span>.people=people;</span><br><span class="line">    backtracking(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span>[] arr=<span class="keyword">new</span> <span class="title class_">int</span>[res.size()];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        arr[i]=res.get(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">backtracking</span><span class="params">(<span class="type">int</span> cur)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(map.size()==n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(res==<span class="literal">null</span> || res.size()&gt;list.size())&#123;</span><br><span class="line">            res=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(list);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cur==len || res!=<span class="literal">null</span> &amp;&amp; list.size()&gt;=res.size())&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> cur; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(useful(i))&#123;</span><br><span class="line">            <span class="keyword">for</span> (String s : people.get(i)) &#123;</span><br><span class="line">                map.put(s,map.getOrDefault(s,<span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            list.add(i);</span><br><span class="line">            backtracking(i+<span class="number">1</span>);</span><br><span class="line">            list.remove(list.size()-<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (String s : people.get(i)) &#123;</span><br><span class="line">                <span class="type">int</span> val=map.get(s);</span><br><span class="line">                <span class="keyword">if</span>(val==<span class="number">1</span>)&#123;</span><br><span class="line">                    map.remove(s);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    map.put(s,val-<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">useful</span><span class="params">(<span class="type">int</span> i)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (String s : people.get(i)) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!map.containsKey(s))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="DP-with-bitmask"><a href="#DP-with-bitmask" class="headerlink" title="DP with bitmask"></a>DP with bitmask</h3><p>注意：</p>
<ul>
<li><code>1 &lt;= req_skills.length &lt;= 16</code></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/smallest-sufficient-team/discuss/334572/JavaC%2B%2BPython-DP-Solution">https://leetcode.com/problems/smallest-sufficient-team/discuss/334572/JavaC%2B%2BPython-DP-Solution</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] smallestSufficientTeam(String[] req_skills, List&lt;List&lt;String&gt;&gt; people) &#123;</span><br><span class="line">       <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> req_skills.length, m = people.size();</span><br><span class="line">       HashMap&lt;String, Integer&gt; skill_index = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">           skill_index.put(req_skills[i], i);</span><br><span class="line">       List&lt;Integer&gt;[] dp = <span class="keyword">new</span> <span class="title class_">List</span>[<span class="number">1</span> &lt;&lt; n];</span><br><span class="line">       dp[<span class="number">0</span>] = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">           <span class="type">int</span> <span class="variable">cur_skill</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">           <span class="keyword">for</span> (String s : people.get(i))</span><br><span class="line">               cur_skill |= <span class="number">1</span> &lt;&lt; skill_index.get(s);</span><br><span class="line">           <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">prev</span> <span class="operator">=</span> <span class="number">0</span>; prev &lt; dp.length; ++prev) &#123;</span><br><span class="line">               <span class="keyword">if</span> (dp[prev] == <span class="literal">null</span>) <span class="keyword">continue</span>;</span><br><span class="line">               <span class="type">int</span> <span class="variable">comb</span> <span class="operator">=</span> prev | cur_skill;</span><br><span class="line">               <span class="keyword">if</span> (dp[comb] == <span class="literal">null</span> || dp[prev].size() + <span class="number">1</span> &lt; dp[comb].size()) &#123;</span><br><span class="line">                   dp[comb] = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(dp[prev]);</span><br><span class="line">                   dp[comb].add(i);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">    <span class="comment">//use Stream to turn List into Array</span></span><br><span class="line">    <span class="comment">//Arrays.stream();	List.stream()</span></span><br><span class="line">       <span class="keyword">return</span> dp[(<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>].stream().mapToInt(i -&gt; i).toArray();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>





<h2 id="465-Optimal-Account-Balancing"><a href="#465-Optimal-Account-Balancing" class="headerlink" title="465. Optimal Account Balancing"></a>465. Optimal Account Balancing</h2><p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/optimal-account-balancing/solution/">https://leetcode.com/problems/optimal-account-balancing/solution/</a></p>
<h3 id="backtracking-x2F-recursion"><a href="#backtracking-x2F-recursion" class="headerlink" title="backtracking&#x2F;recursion"></a>backtracking&#x2F;recursion</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//-4,-2,2,2,2</span></span><br><span class="line"><span class="comment">//0,-2,-2,2,2</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minTransfers</span><span class="params">(<span class="type">int</span>[][] transactions)</span> &#123;</span><br><span class="line">    <span class="comment">//-4,-2,2,2,2</span></span><br><span class="line">    Map&lt;Integer,Integer&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span>[] arr : transactions) &#123;</span><br><span class="line">        map.put(arr[<span class="number">0</span>],map.getOrDefault(arr[<span class="number">0</span>],<span class="number">0</span>)-arr[<span class="number">2</span>]);</span><br><span class="line">        map.put(arr[<span class="number">1</span>],map.getOrDefault(arr[<span class="number">1</span>],<span class="number">0</span>)+arr[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;Integer&gt; list=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Integer key : map.keySet()) &#123;</span><br><span class="line">        <span class="keyword">if</span>(map.get(key)!=<span class="number">0</span>)&#123;</span><br><span class="line">            list.add(map.get(key));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span>[] arr=list.stream().mapToInt(i-&gt;i).toArray();</span><br><span class="line">    <span class="keyword">return</span> dfs(arr,arr.length,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> n, <span class="type">int</span> cur)</span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(cur&lt;n &amp;&amp; arr[cur]==<span class="number">0</span>)&#123;</span><br><span class="line">        cur++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cur==n)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> asset=arr[cur];</span><br><span class="line">    <span class="type">int</span> res=Integer.MAX_VALUE;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=cur+<span class="number">1</span>; i&lt;n; i++)&#123;</span><br><span class="line">        <span class="comment">//0 or same sign, no transaction make sense</span></span><br><span class="line">        <span class="keyword">if</span>(arr[i]*asset&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//else, try to resolve cur by i</span></span><br><span class="line">        arr[i]+=asset;</span><br><span class="line">        <span class="comment">//[0,cur] is all resolved (==0)</span></span><br><span class="line">        res=Math.min(res,<span class="number">1</span>+dfs(arr,n,cur+<span class="number">1</span>));</span><br><span class="line">        arr[i]-=asset;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="DP-with-bitmask-1"><a href="#DP-with-bitmask-1" class="headerlink" title="DP with bitmask"></a>DP with bitmask</h3><p>思路：</p>
<ul>
<li><p>n non-zero balance, each settles with ACH, needs <strong>at most n</strong> transactions</p>
</li>
<li><p>Let one of the people at act as Clearing House, other n-1 settles via him with n-1 transactions. Since the total sum is 0, settling other n-1 with automatically settle this Clearing House guy as well. needs <strong>at most n-1</strong> transactions</p>
</li>
<li><p>if we find 2 zero-balance subgroups, one of size k and other n-k</p>
<ul>
<li>instead of n-1 transactions with a same Clearing guy</li>
<li>make k-1 transactions within first group choosing a Clearing House guy, and n-k-1 transactions within second group choosing another Clearing House guy</li>
<li>only needs n-2 transactions</li>
</ul>
</li>
<li><p>each zero-balance subgroup saves 1 transactions</p>
</li>
<li><p>find the maximum number of zero-balance subgroup!</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] dp;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minTransfers</span><span class="params">(<span class="type">int</span>[][] transactions)</span> &#123;</span><br><span class="line">    Map&lt;Integer,Integer&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span>[] arr : transactions) &#123;</span><br><span class="line">        map.put(arr[<span class="number">0</span>],map.getOrDefault(arr[<span class="number">0</span>],<span class="number">0</span>)+arr[<span class="number">2</span>]);</span><br><span class="line">        map.put(arr[<span class="number">1</span>],map.getOrDefault(arr[<span class="number">1</span>],<span class="number">0</span>)-arr[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;Integer&gt; list=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Integer key : map.keySet()) &#123;</span><br><span class="line">        <span class="keyword">if</span>(map.get(key)!=<span class="number">0</span>)&#123;</span><br><span class="line">            list.add(map.get(key));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//debt: 3 means needing to give 3,</span></span><br><span class="line">    <span class="comment">// -3 means needing to receive 3</span></span><br><span class="line">    <span class="type">int</span>[] arr=list.stream().mapToInt(i-&gt;i).toArray();</span><br><span class="line">    n=arr.length;</span><br><span class="line">    dp=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">1</span>&lt;&lt;n]; <span class="comment">//[1,1&lt;&lt;n -1]</span></span><br><span class="line">    Arrays.fill(dp,-<span class="number">1</span>);</span><br><span class="line">    dp[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="comment">//注意：bit operation优先级低，一定要加括号</span></span><br><span class="line">    <span class="keyword">return</span> n-dfs(arr,(<span class="number">1</span>&lt;&lt;n)-<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> mask)</span>&#123;</span><br><span class="line">    <span class="comment">//maximum number of sub groups that sum = 0</span></span><br><span class="line">    <span class="comment">//normally need n-1 transactions to settle a group</span></span><br><span class="line">    <span class="comment">//but if we find m subgroups of balance 0,</span></span><br><span class="line">    <span class="comment">//we only nned n-m transactions</span></span><br><span class="line">    <span class="keyword">if</span>(dp[mask]!=-<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> dp[mask];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> total=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> max=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> cur=<span class="number">1</span>&lt;&lt;i;</span><br><span class="line">        <span class="keyword">if</span>((mask&amp;cur)!=<span class="number">0</span>)&#123;</span><br><span class="line">            max=Math.max(max,dfs(arr,mask^cur));</span><br><span class="line">            total+=arr[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dp[mask]=max + (total==<span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> dp[mask];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="2708-Maximum-Strength-of-a-Group"><a href="#2708-Maximum-Strength-of-a-Group" class="headerlink" title="2708. Maximum Strength of a Group"></a>2708. Maximum Strength of a Group</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> len;</span><br><span class="line"><span class="type">long</span>[][] dp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">long</span> <span class="title function_">maxStrength</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    n=nums.length;</span><br><span class="line">    len=(<span class="number">1</span>&lt;&lt;n);</span><br><span class="line">    dp=<span class="keyword">new</span> <span class="title class_">long</span>[len][<span class="number">2</span>]; <span class="comment">//positive, negative</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        dp[i][<span class="number">0</span>]=Integer.MIN_VALUE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        dp[(len-<span class="number">1</span>)^(<span class="number">1</span>&lt;&lt;i)][<span class="number">0</span>]=nums[i];</span><br><span class="line">        dp[(len-<span class="number">1</span>)^(<span class="number">1</span>&lt;&lt;i)][<span class="number">1</span>]=nums[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dfs(nums,<span class="number">0</span>)[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">long</span>[] dfs(<span class="type">int</span>[] nums, <span class="type">int</span> mask)&#123;</span><br><span class="line">    <span class="keyword">if</span>(dp[mask][<span class="number">0</span>]!=Integer.MIN_VALUE)&#123;</span><br><span class="line">        <span class="keyword">return</span> dp[mask];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">long</span> min=Integer.MAX_VALUE;</span><br><span class="line">    <span class="type">long</span> max=Integer.MIN_VALUE;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="comment">//mask[i]=0, nums[i] not chosen yet</span></span><br><span class="line">        <span class="keyword">if</span>((mask &amp; (<span class="number">1</span>&lt;&lt;i))==<span class="number">0</span>)&#123;</span><br><span class="line">            min=Math.min(min,nums[i]);</span><br><span class="line">            max=Math.max(max,nums[i]);</span><br><span class="line">            <span class="type">long</span>[] sub=dfs(nums,mask^(<span class="number">1</span>&lt;&lt;i));</span><br><span class="line">            <span class="keyword">if</span>(nums[i]&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                max=Math.max(max,sub[<span class="number">0</span>]*nums[i]);</span><br><span class="line">                min=Math.min(min,sub[<span class="number">1</span>]*nums[i]);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                max=Math.max(max,sub[<span class="number">1</span>]*nums[i]);</span><br><span class="line">                min=Math.min(min,sub[<span class="number">0</span>]*nums[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            max=Math.max(max,sub[<span class="number">0</span>]);</span><br><span class="line">            min=Math.min(min,sub[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dp[mask][<span class="number">0</span>]=max;</span><br><span class="line">    dp[mask][<span class="number">1</span>]=min;</span><br><span class="line">    <span class="keyword">return</span> dp[mask];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://invincible-nerd.github.io/2022/12/30/Math/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="invincible-nerd">
      <meta itemprop="description" content="For explorer everywhere">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IVN">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/30/Math/" class="post-title-link" itemprop="url">Math</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-30 21:08:32" itemprop="dateCreated datePublished" datetime="2022-12-30T21:08:32+08:00">2022-12-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-13 13:34:07" itemprop="dateModified" datetime="2023-07-13T13:34:07+08:00">2023-07-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LeetCode/" itemprop="url" rel="index"><span itemprop="name">LeetCode</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>12k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>11 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Math好题选编"><a href="#Math好题选编" class="headerlink" title="Math好题选编"></a>Math好题选编</h1><h2 id="119-Pascal’s-Triangle-II"><a href="#119-Pascal’s-Triangle-II" class="headerlink" title="119. Pascal’s Triangle II"></a>119. Pascal’s Triangle II</h2><p><strong>Follow up:</strong> Could you optimize your algorithm to use only <code>O(rowIndex)</code> extra space?</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">getRow</span><span class="params">(<span class="type">int</span> rowIndex)</span> &#123;</span><br><span class="line">    <span class="comment">//rowIndex, len=rowIndex+1</span></span><br><span class="line">    <span class="type">int</span>[] arr=<span class="keyword">new</span> <span class="title class_">int</span>[rowIndex+<span class="number">1</span>];</span><br><span class="line">    arr[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; rowIndex + <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i; j &gt; <span class="number">0</span>; j--) &#123;</span><br><span class="line">            <span class="comment">//1				0</span></span><br><span class="line">            <span class="comment">//1 1			1</span></span><br><span class="line">            <span class="comment">//1 2 1			2</span></span><br><span class="line">            <span class="comment">//1 3 3 1		3</span></span><br><span class="line">            <span class="comment">//1 4 6 4 1		4</span></span><br><span class="line">            arr[j]+=arr[j-<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;Integer&gt; res=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; rowIndex + <span class="number">1</span>; i++) &#123;</span><br><span class="line">        res.add(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="204-Count-Primes"><a href="#204-Count-Primes" class="headerlink" title="204. Count Primes"></a>204. Count Primes</h2><p>Use <em>Sieve of Eratosthenes</em>.</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes">https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes</a></p>
<p>To find all the prime numbers less than or equal to a given integer <em>n</em> by Eratosthenes’ method:</p>
<ol>
<li>Create a list of consecutive integers from 2 through <em>n</em>: (2, 3, 4, …, <em>n</em>).</li>
<li>Initially, let <em>p</em> equal 2, the smallest prime number.</li>
<li>Enumerate the multiples of <em>p</em> by counting in increments of <em>p</em> from 2<em>p</em> to <em>n</em>, and mark them in the list (these will be 2<em>p</em>, 3<em>p</em>, 4<em>p</em>, …; the <em>p</em> itself should not be marked).</li>
<li>Find the smallest number in the list greater than <em>p</em> that is not marked. If there was no such number, stop. Otherwise, let <em>p</em> now equal this new number (which is the next prime), and repeat from step 3.</li>
<li>When the algorithm terminates, the numbers remaining not marked in the list are all the primes below <em>n</em>.</li>
</ol>
<h3 id="Time-Limit-Exceeded"><a href="#Time-Limit-Exceeded" class="headerlink" title="Time Limit Exceeded"></a>Time Limit Exceeded</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">countPrimes</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">boolean</span>[] marks=<span class="keyword">new</span> <span class="title class_">boolean</span>[n]; <span class="comment">//[1,n-1]</span></span><br><span class="line">    <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(marks[i])&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(isPrime(i))&#123;</span><br><span class="line">            count++;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">2</span>*i; j&lt;n; j+=i)&#123;</span><br><span class="line">                marks[j]=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isPrime</span><span class="params">(<span class="type">int</span> num)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt; num / <span class="number">2</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(num%i==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Approach-Sieve-of-Eratosthenes"><a href="#Approach-Sieve-of-Eratosthenes" class="headerlink" title="Approach: Sieve of Eratosthenes"></a>Approach: Sieve of Eratosthenes</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">It is not necessary to consider any number greater than the square root of n. </span><br><span class="line"></span><br><span class="line">6 * 1 = 6 = 1 * 6</span><br><span class="line">6 * 2 = 12 = 2 * 6</span><br><span class="line">6 * 3 = 18 = 3 * 6</span><br><span class="line">6 * 4 = 24 = 2 * 12</span><br><span class="line">6 * 5 = 30 = 5 * 6</span><br><span class="line">6 * 6 = 36 &gt; 30</span><br><span class="line"></span><br><span class="line">Notice that every multiple of 6 was already addressed by some multiple of a prime number less than 6.</span><br></pre></td></tr></table></figure>





<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">countPrimes</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">boolean</span>[] marks=<span class="keyword">new</span> <span class="title class_">boolean</span>[n];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=(<span class="type">int</span>)Math.sqrt(n); i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!marks[i])&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i*i; j&lt;n; j+=i)&#123;</span><br><span class="line">                marks[j]=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!marks[i])&#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="229-Majority-Element-II"><a href="#229-Majority-Element-II" class="headerlink" title="229. Majority Element II"></a>229. Majority Element II</h2><h3 id="Approach-1-Boyer-Moore-Voting-Algorithm"><a href="#Approach-1-Boyer-Moore-Voting-Algorithm" class="headerlink" title="Approach 1: Boyer-Moore Voting Algorithm"></a>Approach 1: Boyer-Moore Voting Algorithm</h3><p><strong>Intuition</strong></p>
<p>To figure out a O(1)<em>O</em>(1) space requirement, we would need to get this simple intuition first. For an array of length <code>n</code>:</p>
<ul>
<li>There can be at most <strong>one</strong> majority element which is <strong>more than</strong> <code>⌊n/2⌋</code> times.</li>
<li>There can be at most <strong>two</strong> majority elements which are <strong>more than</strong> <code>⌊n/3⌋</code> times.</li>
<li>There can be at most <strong>three</strong> majority elements which are <strong>more than</strong> <code>⌊n/4⌋</code> times.</li>
</ul>
<p>and so on.</p>
<p>Knowing this can help us understand how we can keep track of majority elements which satisfies O(1)<em>O</em>(1) space requirement.</p>
<ul>
<li>If the current element is equal to one of the potential candidate, the count for that candidate is increased while leaving the count of the other candidate as it is.</li>
<li>If the counter reaches zero, the candidate associated with that counter will be replaced with the next element <strong>if</strong> the next element is not equal to the other candidate as well.</li>
<li>Both counters are decremented <strong>only when</strong> the current element is different from both candidates.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List &lt; Integer &gt; majorityElement(<span class="type">int</span>[] nums) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1st pass</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">count1</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">count2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">candidate1</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">candidate2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> n: nums) &#123;</span><br><span class="line">            <span class="keyword">if</span> (candidate1 != <span class="literal">null</span> &amp;&amp; candidate1 == n) &#123;</span><br><span class="line">                count1++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (candidate2 != <span class="literal">null</span> &amp;&amp; candidate2 == n) &#123;</span><br><span class="line">                count2++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (count1 == <span class="number">0</span>) &#123;</span><br><span class="line">                candidate1 = n;</span><br><span class="line">                count1++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (count2 == <span class="number">0</span>) &#123;</span><br><span class="line">                candidate2 = n;</span><br><span class="line">                count2++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                count1--;</span><br><span class="line">                count2--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2nd pass</span></span><br><span class="line">        <span class="type">List</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span> &lt;&gt; ();</span><br><span class="line"></span><br><span class="line">        count1 = <span class="number">0</span>;</span><br><span class="line">        count2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> n: nums) &#123;</span><br><span class="line">            <span class="keyword">if</span> (candidate1 != <span class="literal">null</span> &amp;&amp; n == candidate1) count1++;</span><br><span class="line">            <span class="keyword">if</span> (candidate2 != <span class="literal">null</span> &amp;&amp; n == candidate2) count2++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="keyword">if</span> (count1 &gt; n/<span class="number">3</span>) result.add(candidate1);</span><br><span class="line">        <span class="keyword">if</span> (count2 &gt; n/<span class="number">3</span>) result.add(candidate2);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="396-Rotate-Function"><a href="#396-Rotate-Function" class="headerlink" title="396. Rotate Function"></a>396. Rotate Function</h2><p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/rotate-function/discuss/87853/Java-O(n)-solution-with-explanation">https://leetcode.com/problems/rotate-function/discuss/87853/Java-O(n)-solution-with-explanation</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">F(k) = 0 * Bk[0] + 1 * Bk[1] + ... + (n-1) * Bk[n-1]</span><br><span class="line">F(k-1) = 0 * Bk-1[0] + 1 * Bk-1[1] + ... + (n-1) * Bk-1[n-1]</span><br><span class="line">       = 0 * Bk[1] + 1 * Bk[2] + ... + (n-2) * Bk[n-1] + (n-1) * Bk[0]</span><br></pre></td></tr></table></figure>



<p>Then,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">F(k) - F(k-1) = Bk[1] + Bk[2] + ... + Bk[n-1] + (1-n)Bk[0]</span><br><span class="line">              = (Bk[0] + ... + Bk[n-1]) - nBk[0]</span><br><span class="line">              = sum - nBk[0]</span><br></pre></td></tr></table></figure>



<p>Thus,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F(k) = F(k-1) + sum - nBk[0]</span><br></pre></td></tr></table></figure>



<p>What is Bk[0]?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">k = 0; B[0] = A[0];</span><br><span class="line">k = 1; B[0] = A[len-1];</span><br><span class="line">k = 2; B[0] = A[len-2];</span><br><span class="line">...</span><br></pre></td></tr></table></figure>





<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxRotateFunction</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> F=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        sum+=nums[i];</span><br><span class="line">        F+=i*nums[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> res=F;</span><br><span class="line">    <span class="comment">//F1-F0=sum-nB(0)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        F=F+sum-n*nums[i];</span><br><span class="line">        res=Math.max(res,F);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="313-Super-Ugly-Number"><a href="#313-Super-Ugly-Number" class="headerlink" title="313. Super Ugly Number"></a>313. Super Ugly Number</h2><p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/super-ugly-number/discuss/277313/My-view-of-this-question-hope-it-can-help-you-understand">https://leetcode.com/problems/super-ugly-number/discuss/277313/My-view-of-this-question-hope-it-can-help-you-understand</a>!!!</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">nthSuperUglyNumber</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>[] primes)</span> &#123;</span><br><span class="line">            PriorityQueue&lt;<span class="type">int</span>[]&gt; queue=<span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;((a,b)-&gt;(a[<span class="number">0</span>]-b[<span class="number">0</span>]));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;primes.length;i++)</span><br><span class="line">        queue.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;primes[i], primes[i], <span class="number">0</span>&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span>[] nums=<span class="keyword">new</span> <span class="title class_">int</span>[n+<span class="number">1</span>];</span><br><span class="line">    nums[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> i=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (i&lt;n)&#123;</span><br><span class="line">        <span class="type">int</span>[] entry=queue.poll();</span><br><span class="line">        <span class="type">int</span> num=entry[<span class="number">0</span>], prime=entry[<span class="number">1</span>], index=entry[<span class="number">2</span>];</span><br><span class="line">		<span class="comment">// remove duplicate</span></span><br><span class="line">        <span class="keyword">if</span> (num!=nums[i-<span class="number">1</span>])&#123;</span><br><span class="line">            nums[i]=num;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        queue.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;prime*nums[index+<span class="number">1</span>], prime, index+<span class="number">1</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> nums[n-<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="50-Pow-x-n"><a href="#50-Pow-x-n" class="headerlink" title="50. Pow(x, n)"></a>50. Pow(x, n)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">double</span> <span class="title function_">myPow</span><span class="params">(<span class="type">double</span> x, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">long</span> N=n;</span><br><span class="line">    <span class="type">double</span> ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(N&lt;<span class="number">0</span>)&#123;</span><br><span class="line">        N=-N;</span><br><span class="line">        x=<span class="number">1</span>/x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">double</span> cur=x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">long</span> i=N; i&gt;<span class="number">0</span>; i/=<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">1</span>)&#123;</span><br><span class="line">            ans*=cur;</span><br><span class="line">        &#125;</span><br><span class="line">        cur*=cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="372-Super-Pow"><a href="#372-Super-Pow" class="headerlink" title="372. Super Pow"></a>372. Super Pow</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">superPow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span>[] b)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> superPow(a,b,b.length,<span class="number">1337</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">superPow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span>[] b, <span class="type">int</span> len, <span class="type">int</span> k)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(len==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> pow(a,b[<span class="number">0</span>],k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pow(superPow(a,b,len-<span class="number">1</span>,k),<span class="number">10</span>,k)*pow(a,b[len-<span class="number">1</span>],k)%k;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">pow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> k)</span>&#123;</span><br><span class="line">    a%=k;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; b; i++) &#123;</span><br><span class="line">        res*=a;</span><br><span class="line">        res%=k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="69-Sqrt-x"><a href="#69-Sqrt-x" class="headerlink" title="69. Sqrt(x)"></a>69. Sqrt(x)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">mySqrt</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">    <span class="type">long</span> left=<span class="number">0</span>;</span><br><span class="line">    <span class="type">long</span> right=x/<span class="number">2</span>+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(left&lt;=right)&#123;</span><br><span class="line">        <span class="type">long</span> mid=left+(right-left)/<span class="number">2</span>;</span><br><span class="line">        <span class="type">long</span> sq=mid*mid;</span><br><span class="line">        <span class="keyword">if</span>(sq==(<span class="type">long</span>)x)&#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="type">int</span>)mid;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sq&gt;x)&#123;</span><br><span class="line">            right=mid-<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            left=mid+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">int</span>)right;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="172-Factorial-Trailing-Zeroes"><a href="#172-Factorial-Trailing-Zeroes" class="headerlink" title="172. Factorial Trailing Zeroes"></a>172. Factorial Trailing Zeroes</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">trailingZeroes</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(n&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        n/=<span class="number">5</span>;</span><br><span class="line">        count+=n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="2571-Minimum-Operations-to-Reduce-an-Integer-to-0"><a href="#2571-Minimum-Operations-to-Reduce-an-Integer-to-0" class="headerlink" title="2571. Minimum Operations to Reduce an Integer to 0"></a>2571. Minimum Operations to Reduce an Integer to 0</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minOperations</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(n!=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//log2n = ln(n) / ln(2)</span></span><br><span class="line">        <span class="type">int</span> x=(<span class="type">int</span>)(Math.log(n)/Math.log(<span class="number">2</span>));</span><br><span class="line">        <span class="type">int</span> bigger=(<span class="type">int</span>)Math.pow(<span class="number">2</span>,x+<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> smaller=(<span class="type">int</span>)Math.pow(<span class="number">2</span>,x);</span><br><span class="line">        <span class="keyword">if</span>(bigger-n&lt;n-smaller)&#123;</span><br><span class="line">            n=bigger-n;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            n=n-smaller;</span><br><span class="line">        &#125;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="326-Power-of-Three"><a href="#326-Power-of-Three" class="headerlink" title="326. Power of Three"></a>326. Power of Three</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPowerOfThree</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> x=(<span class="type">int</span>)(Math.log(Integer.MAX_VALUE)/Math.log(<span class="number">3</span>));</span><br><span class="line">    <span class="type">int</span> mod=(<span class="type">int</span>)Math.pow(<span class="number">3</span>,x);</span><br><span class="line">    <span class="keyword">return</span> n&gt;<span class="number">0</span> &amp;&amp; mod%n==<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPowerOfThree</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">//regular expression</span></span><br><span class="line">    <span class="keyword">return</span> Integer.toString(n,<span class="number">3</span>).matches(<span class="string">&quot;^10*$&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="311-Sparse-Matrix-Multiplication"><a href="#311-Sparse-Matrix-Multiplication" class="headerlink" title="311. Sparse Matrix Multiplication"></a>311. Sparse Matrix Multiplication</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[][] multiply(<span class="type">int</span>[][] mat1, <span class="type">int</span>[][] mat2) &#123;</span><br><span class="line">    <span class="type">int</span> m=mat1.length;</span><br><span class="line">    <span class="type">int</span> k=mat1[<span class="number">0</span>].length;</span><br><span class="line">    <span class="type">int</span> n=mat2[<span class="number">0</span>].length;</span><br><span class="line">    <span class="type">int</span>[][] res=<span class="keyword">new</span> <span class="title class_">int</span>[m][n];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> <span class="number">0</span>; p &lt; k; p++) &#123;</span><br><span class="line">                res[i][j]+=mat1[i][p]*mat2[p][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="1228-Missing-Number-In-Arithmetic-Progression"><a href="#1228-Missing-Number-In-Arithmetic-Progression" class="headerlink" title="1228. Missing Number In Arithmetic Progression"></a>1228. Missing Number In Arithmetic Progression</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">missingNumber</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=arr.length;</span><br><span class="line">    <span class="type">int</span> sum=(arr[<span class="number">0</span>]+arr[n-<span class="number">1</span>])*(n+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : arr) &#123;</span><br><span class="line">        sum-=num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="1010-Pairs-of-Songs-With-Total-Durations-Divisible-by-60"><a href="#1010-Pairs-of-Songs-With-Total-Durations-Divisible-by-60" class="headerlink" title="1010. Pairs of Songs With Total Durations Divisible by 60"></a>1010. Pairs of Songs With Total Durations Divisible by 60</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">numPairsDivisibleBy60</span><span class="params">(<span class="type">int</span>[] time)</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] arr=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">60</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i : time) &#123;</span><br><span class="line">        arr[i%<span class="number">60</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">long</span> res=(<span class="type">long</span>)arr[<span class="number">0</span>]*(arr[<span class="number">0</span>]-<span class="number">1</span>)/<span class="number">2</span>+arr[<span class="number">30</span>]*(arr[<span class="number">30</span>]-<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">31</span>; i &lt; <span class="number">60</span>; i++) &#123;</span><br><span class="line">        res+=arr[i]*arr[<span class="number">60</span>-i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">int</span>)res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="1492-The-kth-Factor-of-n"><a href="#1492-The-kth-Factor-of-n" class="headerlink" title="1492. The kth Factor of n"></a>1492. The kth Factor of n</h2><p>dumb</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">kthFactor</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    List&lt;Integer&gt; list=<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(n%i==<span class="number">0</span>)&#123;</span><br><span class="line">            list.add(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> k&gt;list.size() ? -<span class="number">1</span> : list.get(k-<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>better, but still O(n)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">kthFactor</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n/<span class="number">2</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n%i==<span class="number">0</span>)&#123;</span><br><span class="line">            k--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(k==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> k==<span class="number">1</span> ? n : -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>Follow up:</strong></p>
<p>Could you solve this problem in less than O(n) complexity?</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">kthFactor</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="type">int</span> root=(<span class="type">int</span>)Math.sqrt(n);</span><br><span class="line">    <span class="type">int</span> i=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; i&lt;=root; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n%i==<span class="number">0</span>)&#123;</span><br><span class="line">            k--;</span><br><span class="line">            <span class="keyword">if</span>(k==<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    i--;</span><br><span class="line">    <span class="keyword">if</span>(i*i==n)&#123;</span><br><span class="line">        k++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(;i&gt;=<span class="number">1</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n%i==<span class="number">0</span>)&#123;</span><br><span class="line">            k--;</span><br><span class="line">            <span class="keyword">if</span>(k==<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> n/i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="1344-Angle-Between-Hands-of-a-Clock"><a href="#1344-Angle-Between-Hands-of-a-Clock" class="headerlink" title="1344. Angle Between Hands of a Clock"></a>1344. Angle Between Hands of a Clock</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">double</span> <span class="title function_">angleClock</span><span class="params">(<span class="type">int</span> hour, <span class="type">int</span> minutes)</span> &#123;</span><br><span class="line">    <span class="type">double</span> m=minutes*<span class="number">6</span>;</span><br><span class="line">    <span class="type">double</span> h=((hour+(<span class="type">double</span>)minutes/<span class="number">60</span>)*<span class="number">30</span>)%<span class="number">360</span>;</span><br><span class="line">    <span class="type">double</span> dif=Math.abs(m-h);</span><br><span class="line">    <span class="keyword">return</span> dif&lt;=<span class="number">180</span> ? dif : <span class="number">360</span>-dif;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="973-K-Closest-Points-to-Origin"><a href="#973-K-Closest-Points-to-Origin" class="headerlink" title="973. K Closest Points to Origin"></a>973. K Closest Points to Origin</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[][] kClosest(<span class="type">int</span>[][] points, <span class="type">int</span> k) &#123;</span><br><span class="line">    List&lt;<span class="type">int</span>[]&gt; list=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span>[] point : points) &#123;</span><br><span class="line">        list.add(point);</span><br><span class="line">    &#125;</span><br><span class="line">    Collections.sort(list,(a,b)-&gt;(a[<span class="number">0</span>]*a[<span class="number">0</span>]+a[<span class="number">1</span>]*a[<span class="number">1</span>]-b[<span class="number">0</span>]*b[<span class="number">0</span>]-b[<span class="number">1</span>]*b[<span class="number">1</span>]));</span><br><span class="line">    <span class="type">int</span>[][] res=<span class="keyword">new</span> <span class="title class_">int</span>[k][<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; k; i++) &#123;</span><br><span class="line">        res[i]=list.get(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="1291-Sequential-Digits"><a href="#1291-Sequential-Digits" class="headerlink" title="1291. Sequential Digits"></a>1291. Sequential Digits</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">sequentialDigits</span><span class="params">(<span class="type">int</span> low, <span class="type">int</span> high)</span> &#123;</span><br><span class="line">    List&lt;Integer&gt; res=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span> n=String.valueOf(low).length();</span><br><span class="line">    <span class="type">int</span> num=first(n);</span><br><span class="line">    <span class="keyword">while</span>(num&lt;low)&#123;</span><br><span class="line">        num=next(num);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(num&lt;=high)&#123;</span><br><span class="line">        res.add(num);</span><br><span class="line">        num=next(num);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">first</span><span class="params">(<span class="type">int</span> n)</span>&#123;</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> num=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(n--&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        num*=<span class="number">10</span>;</span><br><span class="line">        i++;</span><br><span class="line">        num+=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">next</span><span class="params">(<span class="type">int</span> num)</span>&#123;</span><br><span class="line">    String s=String.valueOf(num);</span><br><span class="line">    <span class="type">int</span> len=s.length();</span><br><span class="line">    <span class="keyword">if</span>(s.charAt(len-<span class="number">1</span>)!=<span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">        <span class="type">int</span> l=len;</span><br><span class="line">        <span class="type">int</span> add=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(l--&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            add*=<span class="number">10</span>;</span><br><span class="line">            add++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> num+add;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> first(len+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="258-Add-Digits"><a href="#258-Add-Digits" class="headerlink" title="258. Add Digits"></a>258. Add Digits</h2><h3 id="法一："><a href="#法一：" class="headerlink" title="法一："></a>法一：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addDigits</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">    <span class="type">int</span> digits=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(num!=<span class="number">0</span>)&#123;</span><br><span class="line">        digits+=num%<span class="number">10</span>;</span><br><span class="line">        num/=<span class="number">10</span>;</span><br><span class="line">        <span class="keyword">if</span>(num==<span class="number">0</span> &amp;&amp; digits&gt;=<span class="number">10</span>)&#123;</span><br><span class="line">            num=digits;</span><br><span class="line">            digits=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> digits;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="法二："><a href="#法二：" class="headerlink" title="法二："></a>法二：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addDigits</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(num==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(num%<span class="number">9</span>==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">9</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num%<span class="number">9</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="319-Bulb-Switcher"><a href="#319-Bulb-Switcher" class="headerlink" title="319. Bulb Switcher"></a>319. Bulb Switcher</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">bulbSwitch</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">//only perfect square number has odd number of divisors</span></span><br><span class="line">    <span class="comment">//the number of perfect square number in [1,n] = sqrt(n)</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="type">int</span>)Math.sqrt(n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="780-Reaching-Points"><a href="#780-Reaching-Points" class="headerlink" title="780. Reaching Points"></a>780. Reaching Points</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">reachingPoints</span><span class="params">(<span class="type">int</span> sx, <span class="type">int</span> sy, <span class="type">int</span> tx, <span class="type">int</span> ty)</span> &#123;</span><br><span class="line">    <span class="comment">//必须都小，否则break</span></span><br><span class="line">    <span class="keyword">while</span>(sx&lt;tx &amp;&amp; sy&lt;ty)&#123;</span><br><span class="line">        <span class="keyword">if</span>(tx&lt;ty)&#123;</span><br><span class="line">            ty%=tx;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            tx%=ty;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sx==tx &amp;&amp; sy&lt;=ty &amp;&amp; (ty-sy)%sx==<span class="number">0</span> ||</span><br><span class="line">            sy==ty &amp;&amp; sx&lt;=tx &amp;&amp; (tx-sx)%sy==<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="400-Nth-Digit"><a href="#400-Nth-Digit" class="headerlink" title="400. Nth Digit"></a>400. Nth Digit</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findNthDigit</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">//[1,9] 9</span></span><br><span class="line">    <span class="comment">//[10,99] 90</span></span><br><span class="line">    <span class="comment">//[100,999] 900</span></span><br><span class="line">    <span class="type">int</span> start=<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> len=<span class="number">1</span>;</span><br><span class="line">    <span class="type">long</span> range=<span class="number">9</span>;</span><br><span class="line">    <span class="keyword">while</span>(n&gt;len*range)&#123;</span><br><span class="line">        n-=len*range;</span><br><span class="line">        len++;</span><br><span class="line">        range*=<span class="number">10</span>;</span><br><span class="line">        start*=<span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    start+=(n-<span class="number">1</span>)/len;</span><br><span class="line">    <span class="keyword">return</span> Character.getNumericValue(Integer.toString(start).charAt((n-<span class="number">1</span>)%len));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="1360-Number-of-Days-Between-Two-Dates"><a href="#1360-Number-of-Days-Between-Two-Dates" class="headerlink" title="1360. Number of Days Between Two Dates"></a>1360. Number of Days Between Two Dates</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">daysBetweenDates</span><span class="params">(String date1, String date2)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Math.abs(day(date1)-day(date2));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">day</span><span class="params">(String s)</span>&#123;</span><br><span class="line">    <span class="type">int</span> year=Integer.parseInt(s.substring(<span class="number">0</span>,<span class="number">4</span>));</span><br><span class="line">    <span class="type">int</span> month=Integer.parseInt(s.substring(<span class="number">5</span>,<span class="number">7</span>));</span><br><span class="line">    <span class="type">int</span> day=Integer.parseInt(s.substring(<span class="number">8</span>,<span class="number">10</span>));</span><br><span class="line">    <span class="comment">//base: 1971/01/01</span></span><br><span class="line">    <span class="type">int</span> res=<span class="number">365</span>*(year-<span class="number">1971</span>);</span><br><span class="line">    <span class="type">int</span>[] arr=<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">31</span>,<span class="number">28</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; month; i++) &#123;</span><br><span class="line">        res+=arr[i-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    res+=day;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> y=<span class="number">1971</span>; y&lt;year; y++)&#123;</span><br><span class="line">        <span class="keyword">if</span>((y%<span class="number">100</span>!=<span class="number">0</span> &amp;&amp; y%<span class="number">4</span>==<span class="number">0</span>)  || y==<span class="number">2000</span>)&#123;</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(((year%<span class="number">100</span>!=<span class="number">0</span> &amp;&amp; year%<span class="number">4</span>==<span class="number">0</span>) || year==<span class="number">2000</span>) &amp;&amp; month&gt;<span class="number">2</span>)&#123;</span><br><span class="line">        res++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="2761-Prime-Pairs-With-Target-Sum"><a href="#2761-Prime-Pairs-With-Target-Sum" class="headerlink" title="2761. Prime Pairs With Target Sum"></a>2761. Prime Pairs With Target Sum</h2><p>precompute all Prime numbers by sieving</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span>[] arr;</span><br><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">findPrimePairs</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    arr=<span class="keyword">new</span> <span class="title class_">boolean</span>[n+<span class="number">1</span>];</span><br><span class="line">    <span class="comment">//prime: false, not prime: true</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!arr[i])&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">2</span>*i; j&lt;=n; j+=i)&#123;</span><br><span class="line">                arr[j]=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n/<span class="number">2</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!arr[i] &amp;&amp; !arr[n-i])&#123;</span><br><span class="line">            res.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(Arrays.asList(i,n-i)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://invincible-nerd.github.io/2022/12/28/String%E5%A5%BD%E9%A2%98-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="invincible-nerd">
      <meta itemprop="description" content="For explorer everywhere">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IVN">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/28/String%E5%A5%BD%E9%A2%98-2/" class="post-title-link" itemprop="url">String好题(2)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-28 18:02:26" itemprop="dateCreated datePublished" datetime="2022-12-28T18:02:26+08:00">2022-12-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-01 11:16:46" itemprop="dateModified" datetime="2023-03-01T11:16:46+08:00">2023-03-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LeetCode/" itemprop="url" rel="index"><span itemprop="name">LeetCode</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>19k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>17 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="String好题选编-2"><a href="#String好题选编-2" class="headerlink" title="String好题选编(2)"></a>String好题选编(2)</h1><h2 id="340-Longest-Substring-with-At-Most-K-Distinct-Characters"><a href="#340-Longest-Substring-with-At-Most-K-Distinct-Characters" class="headerlink" title="340. Longest Substring with At Most K Distinct Characters"></a>340. Longest Substring with At Most K Distinct Characters</h2><p>typical sliding window</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">lengthOfLongestSubstringKDistinct</span><span class="params">(String s, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="type">int</span> max=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> left=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> right=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    Map&lt;Character,Integer&gt; map=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">while</span>(right&lt;n)&#123;</span><br><span class="line">        <span class="comment">//[left,right)</span></span><br><span class="line">        <span class="type">char</span> c=s.charAt(right++);</span><br><span class="line">        map.put(c,map.getOrDefault(c,<span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span>(map.size()&gt;k)&#123;</span><br><span class="line">            c=s.charAt(left++);</span><br><span class="line">            map.put(c,map.get(c)-<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span>(map.get(c)==<span class="number">0</span>)&#123;</span><br><span class="line">                map.remove(c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(right-left&gt;max)&#123;</span><br><span class="line">            max=right-left;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="394-Decode-String"><a href="#394-Decode-String" class="headerlink" title="394. Decode String"></a>394. Decode String</h2><p>好题！</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Part</span>&#123;</span><br><span class="line">    StringBuilder sb;</span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line">    Part(<span class="type">int</span> num)&#123;</span><br><span class="line">        <span class="built_in">this</span>.sb=<span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="built_in">this</span>.num=num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">decodeString</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    Deque&lt;Part&gt; stack=<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    stack.push(<span class="keyword">new</span> <span class="title class_">Part</span>(<span class="number">1</span>));</span><br><span class="line">    <span class="type">int</span> num=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class="line">        <span class="type">char</span> c=s.charAt(i);</span><br><span class="line">        <span class="keyword">if</span>(Character.isDigit(c))&#123;</span><br><span class="line">            num=num*<span class="number">10</span>+c-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="string">&#x27;[&#x27;</span>) &#123;</span><br><span class="line">            stack.push(<span class="keyword">new</span> <span class="title class_">Part</span>(num));</span><br><span class="line">            num = <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="string">&#x27;]&#x27;</span>)&#123;</span><br><span class="line">            Part p=stack.pop();</span><br><span class="line">            <span class="type">int</span> t=p.num;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; t; j++) &#123;</span><br><span class="line">                stack.peek().sb.append(p.sb);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            stack.peek().sb.append(c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> stack.peek().sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">StrItem</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    </span><br><span class="line">    StrItem(<span class="type">int</span> n) &#123;<span class="built_in">this</span>.num = n;&#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">decodeString</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        Stack&lt;StrItem&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        stack.push(<span class="keyword">new</span> <span class="title class_">StrItem</span>(<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> c: s.toCharArray())</span><br><span class="line">            <span class="keyword">switch</span> (c) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;5&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;6&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;7&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;8&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">                    num = num * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;[&#x27;</span>:</span><br><span class="line">                    stack.push(<span class="keyword">new</span> <span class="title class_">StrItem</span>(num));</span><br><span class="line">                    num = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;]&#x27;</span>:</span><br><span class="line">                    <span class="type">String</span> <span class="variable">curStr</span> <span class="operator">=</span> stack.peek().sb.toString();</span><br><span class="line">                    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> stack.pop().num;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                        stack.peek().sb.append(curStr);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    stack.peek().sb.append(c);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">return</span> stack.pop().sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="395-Longest-Substring-with-At-Least-K-Repeating-Characters"><a href="#395-Longest-Substring-with-At-Least-K-Repeating-Characters" class="headerlink" title="395. Longest Substring with At Least K Repeating Characters"></a>395. Longest Substring with At Least K Repeating Characters</h2><p>hardest sliding window?</p>
<h3 id="法一：divide-and-conquer"><a href="#法一：divide-and-conquer" class="headerlink" title="法一：divide-and-conquer"></a>法一：divide-and-conquer</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">longestSubstring</span><span class="params">(String s, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    <span class="keyword">if</span>(k&lt;<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> helper(s,k,<span class="number">0</span>,n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">helper</span><span class="params">(String s, <span class="type">int</span> k ,<span class="type">int</span> left, <span class="type">int</span> right)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(left&gt;=right)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span>[] counts=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> left; i &lt; right; i++) &#123;</span><br><span class="line">        counts[s.charAt(i)-<span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> start=left;</span><br><span class="line">    <span class="type">int</span> end=left;</span><br><span class="line">    <span class="type">int</span> max=<span class="number">0</span>;</span><br><span class="line">    <span class="type">boolean</span> valid=<span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">while</span>(end&lt;right)&#123;</span><br><span class="line">        <span class="comment">//[left,right)</span></span><br><span class="line">        <span class="type">char</span> c=s.charAt(end);</span><br><span class="line">        <span class="keyword">if</span>(counts[c-<span class="string">&#x27;a&#x27;</span>]&lt;k)&#123;</span><br><span class="line">            valid=<span class="literal">false</span>;</span><br><span class="line">            max=Math.max(max,helper(s,k,start,end));</span><br><span class="line">            start=end+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        end++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> valid ? right-left : Math.max(max,helper(s,k,start,right));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="法二：sliding-window"><a href="#法二：sliding-window" class="headerlink" title="法二：sliding window"></a>法二：sliding window</h3><h2 id="402-Remove-K-Digits"><a href="#402-Remove-K-Digits" class="headerlink" title="402. Remove K Digits"></a>402. Remove K Digits</h2><p>单调栈</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">removeKdigits</span><span class="params">(String num, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=num.length();</span><br><span class="line">    <span class="keyword">if</span>(k==n)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;0&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Deque&lt;Integer&gt; stack=<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> cur=num.charAt(i)-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">while</span>(k&gt;<span class="number">0</span> &amp;&amp; !stack.isEmpty() &amp;&amp; stack.peek()&gt;cur)&#123;</span><br><span class="line">            stack.pop();    <span class="comment">//every pop is one delete, i.e, one use of k</span></span><br><span class="line">            k--;</span><br><span class="line">        &#125;</span><br><span class="line">        stack.push(cur);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(k--&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//still have unused k, i.e, can delete more digit to make num smaller</span></span><br><span class="line">        stack.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    StringBuilder sb=<span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">while</span>(!stack.isEmpty())&#123;</span><br><span class="line">        <span class="comment">//1 2 9</span></span><br><span class="line">        sb.append(stack.pop()); <span class="comment">//921</span></span><br><span class="line">    &#125;</span><br><span class="line">    String res=sb.reverse().toString();</span><br><span class="line">    <span class="keyword">while</span>(res.length()&gt;<span class="number">1</span> &amp;&amp; res.charAt(<span class="number">0</span>)==<span class="string">&#x27;0&#x27;</span>)&#123;</span><br><span class="line">        res=res.substring(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="306-Additive-Number"><a href="#306-Additive-Number" class="headerlink" title="306. Additive Number"></a>306. Additive Number</h2><p>tail recursion</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isAdditiveNumber</span><span class="params">(String num)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> num.length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n / <span class="number">2</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (num.charAt(<span class="number">0</span>) == <span class="string">&#x27;0&#x27;</span> &amp;&amp; i &gt; <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="type">BigInteger</span> <span class="variable">x1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigInteger</span>(num.substring(<span class="number">0</span>, i));</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; Math.max(j, i) &lt;= n - i - j; ++j) &#123;</span><br><span class="line">                <span class="keyword">if</span> (num.charAt(i) == <span class="string">&#x27;0&#x27;</span> &amp;&amp; j &gt; <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">                <span class="type">BigInteger</span> <span class="variable">x2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigInteger</span>(num.substring(i, i + j));</span><br><span class="line">                <span class="keyword">if</span> (isValid(x1, x2, j + i, num)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isValid</span><span class="params">(BigInteger x1, BigInteger x2, <span class="type">int</span> start, String num)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (start == num.length()) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        x2 = x2.add(x1);</span><br><span class="line">        x1 = x2.subtract(x1);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sum</span> <span class="operator">=</span> x2.toString();</span><br><span class="line">        <span class="keyword">return</span> num.startsWith(sum, start) &amp;&amp; isValid(x1, x2, start + sum.length(), num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="227-Basic-Calculator-II"><a href="#227-Basic-Calculator-II" class="headerlink" title="227. Basic Calculator II"></a>227. Basic Calculator II</h2><p>躲不过的计算器</p>
<p>标准版，不考虑括号</p>
<p>无需中缀转后缀，一个stack就够了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">calculate</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    Deque&lt;Integer&gt; stack=<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">char</span> sign=<span class="string">&#x27;+&#x27;</span>;</span><br><span class="line">    <span class="type">int</span> num=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">char</span> c=s.charAt(i);</span><br><span class="line">        <span class="keyword">if</span>(Character.isDigit(c))&#123;</span><br><span class="line">            num*=<span class="number">10</span>;</span><br><span class="line">            num+=c-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!Character.isDigit(c) &amp;&amp; c!=<span class="string">&#x27; &#x27;</span> || i==n-<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(sign==<span class="string">&#x27;+&#x27;</span>)&#123;</span><br><span class="line">                stack.push(num);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(sign==<span class="string">&#x27;-&#x27;</span>)&#123;</span><br><span class="line">                stack.push(-num);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(sign==<span class="string">&#x27;*&#x27;</span>)&#123;</span><br><span class="line">                stack.push(stack.pop()*num);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(sign==<span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">                stack.push(stack.pop()/num);</span><br><span class="line">            &#125;</span><br><span class="line">            num=<span class="number">0</span>;</span><br><span class="line">            sign=c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!stack.isEmpty())&#123;</span><br><span class="line">        res+=stack.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="224-Basic-Calculator"><a href="#224-Basic-Calculator" class="headerlink" title="224. Basic Calculator"></a>224. Basic Calculator</h2><p>半升级版，考虑括号，但不再考虑乘除</p>
<p>依然一个stack搞定</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">calculate</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> sign=<span class="number">1</span>;</span><br><span class="line">    Deque&lt;Integer&gt; stack=<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">char</span> c=s.charAt(i);</span><br><span class="line">        <span class="keyword">if</span>(Character.isDigit(c))&#123;</span><br><span class="line">            <span class="type">int</span> num=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(i&lt;n &amp;&amp; Character.isDigit(s.charAt(i)))&#123;</span><br><span class="line">                num*=<span class="number">10</span>;</span><br><span class="line">                num+=s.charAt(i)-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            i--;</span><br><span class="line">            num*=sign;</span><br><span class="line">            sign=<span class="number">1</span>;</span><br><span class="line">            sum+=num;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="string">&#x27;(&#x27;</span>)&#123;</span><br><span class="line">            stack.push(sum);	<span class="comment">//存储上一阶段结果</span></span><br><span class="line">            stack.push(sign);	<span class="comment">//存储这一阶段的符号</span></span><br><span class="line">            sum=<span class="number">0</span>;</span><br><span class="line">            sign=<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="string">&#x27;)&#x27;</span>)&#123;</span><br><span class="line">            sum*=stack.pop();</span><br><span class="line">            sum+=stack.pop();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>)&#123;</span><br><span class="line">            sign*=-<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">calculate</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">sign</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    Stack&lt;Integer&gt;st = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;s.length();i++)&#123;</span><br><span class="line">        <span class="type">char</span> <span class="variable">ch</span> <span class="operator">=</span> s.charAt(i);</span><br><span class="line">        <span class="keyword">if</span>(Character.isDigit(ch))&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">val</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">             <span class="keyword">while</span>(i &lt; s.length() &amp;&amp; Character.isDigit(s.charAt(i)))&#123;</span><br><span class="line">                 val = val * <span class="number">10</span> + (s.charAt(i) - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">                 i++;</span><br><span class="line">             &#125;</span><br><span class="line">         i--;</span><br><span class="line">         val = val * sign;</span><br><span class="line">         sign = <span class="number">1</span>;</span><br><span class="line">         sum += val;   </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">&#x27;(&#x27;</span>)&#123;</span><br><span class="line">          st.push(sum);</span><br><span class="line">          st.push(sign);</span><br><span class="line">            sum = <span class="number">0</span>;</span><br><span class="line">            sign = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">&#x27;)&#x27;</span>)&#123;</span><br><span class="line">            sum *= st.pop();</span><br><span class="line">            sum += st.pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">&#x27;-&#x27;</span>)&#123;</span><br><span class="line">            sign*= -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="418-Sentence-Screen-Fitting"><a href="#418-Sentence-Screen-Fitting" class="headerlink" title="418. Sentence Screen Fitting"></a>418. Sentence Screen Fitting</h2><p>still hard to understand !</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">wordsTyping</span><span class="params">(String[] sentence, <span class="type">int</span> rows, <span class="type">int</span> cols)</span> &#123;</span><br><span class="line">    String str=String.join(<span class="string">&quot; &quot;</span>,sentence)+<span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="type">int</span> n=str.length();</span><br><span class="line">    <span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; rows; i++) &#123;</span><br><span class="line">        len+=cols;</span><br><span class="line">        <span class="keyword">if</span>(str.charAt(len%n)==<span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">            len++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">while</span>(len&gt;<span class="number">0</span> &amp;&amp; str.charAt((len-<span class="number">1</span>)%n)!=<span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">                len--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> len/n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns a new &#123;<span class="doctag">@code</span> String&#125; composed of copies of the</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> CharSequence elements&#125; joined together with a copy of the</span></span><br><span class="line"><span class="comment"> * specified &#123;<span class="doctag">@code</span> delimiter&#125;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;blockquote&gt;For example,</span></span><br><span class="line"><span class="comment"> * &lt;pre&gt;&#123;<span class="doctag">@code</span></span></span><br><span class="line"><span class="comment"> *     List&lt;String&gt; strings = List.of(&quot;Java&quot;, &quot;is&quot;, &quot;cool&quot;);</span></span><br><span class="line"><span class="comment"> *     String message = String.join(&quot; &quot;, strings);</span></span><br><span class="line"><span class="comment"> *     //message returned is: &quot;Java is cool&quot;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     Set&lt;String&gt; strings =</span></span><br><span class="line"><span class="comment"> *         new LinkedHashSet&lt;&gt;(List.of(&quot;Java&quot;, &quot;is&quot;, &quot;very&quot;, &quot;cool&quot;));</span></span><br><span class="line"><span class="comment"> *     String message = String.join(&quot;-&quot;, strings);</span></span><br><span class="line"><span class="comment"> *     //message returned is: &quot;Java-is-very-cool&quot;</span></span><br><span class="line"><span class="comment"> * &#125;&lt;/pre&gt;&lt;/blockquote&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Note that if an individual element is &#123;<span class="doctag">@code</span> null&#125;, then &#123;<span class="doctag">@code</span> &quot;null&quot;&#125; is added.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  delimiter a sequence of characters that is used to separate each</span></span><br><span class="line"><span class="comment"> *         of the &#123;<span class="doctag">@code</span> elements&#125; in the resulting &#123;<span class="doctag">@code</span> String&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  elements an &#123;<span class="doctag">@code</span> Iterable&#125; that will have its &#123;<span class="doctag">@code</span> elements&#125;</span></span><br><span class="line"><span class="comment"> *         joined together.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> a new &#123;<span class="doctag">@code</span> String&#125; that is composed from the &#123;<span class="doctag">@code</span> elements&#125;</span></span><br><span class="line"><span class="comment"> *         argument</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> NullPointerException If &#123;<span class="doctag">@code</span> delimiter&#125; or &#123;<span class="doctag">@code</span> elements&#125;</span></span><br><span class="line"><span class="comment"> *         is &#123;<span class="doctag">@code</span> null&#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span>    #join(CharSequence,CharSequence...)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span>    java.util.StringJoiner</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.8</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">wordsTyping</span><span class="params">(String[] sentence, <span class="type">int</span> rows, <span class="type">int</span> cols)</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (sentence.length == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// convert string array to a string sentence with space between every word</span></span><br><span class="line"><span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> String.join(<span class="string">&quot; &quot;</span>, sentence) + <span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> str.length();</span><br><span class="line"><span class="type">int</span> <span class="variable">lenSum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; rows; i++) &#123;</span><br><span class="line">    lenSum += cols;</span><br><span class="line">    <span class="comment">// if last character is space, add effective length by 1, since we put a space after input sentence before</span></span><br><span class="line">    <span class="keyword">if</span> (str.charAt(lenSum % n) == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">        lenSum++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// otherwise, find the most recent space position</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// DO NOT FORGET to MOD n since we may repeat many times of entire sentence in a single line</span></span><br><span class="line">        <span class="keyword">while</span> (lenSum &gt; <span class="number">0</span> &amp;&amp; str.charAt((lenSum - <span class="number">1</span>) % n) != <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">            lenSum--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> lenSum / n; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="415-Add-Strings"><a href="#415-Add-Strings" class="headerlink" title="415. Add Strings"></a>415. Add Strings</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">addStrings</span><span class="params">(String num1, String num2)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n1=num1.length();</span><br><span class="line">    <span class="type">int</span> n2=num2.length();</span><br><span class="line">    StringBuilder sb=<span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="type">int</span> pre=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= Math.max(n1, n2); i++) &#123;</span><br><span class="line">        <span class="type">int</span> c1=n1-i&gt;=<span class="number">0</span> ? num1.charAt(n1-i)-<span class="string">&#x27;0&#x27;</span> : <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> c2=n2-i&gt;=<span class="number">0</span> ? num2.charAt(n2-i)-<span class="string">&#x27;0&#x27;</span> : <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> cur=c1+c2+pre;</span><br><span class="line">        pre=cur/<span class="number">10</span>;</span><br><span class="line">        sb.append(cur%<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(pre!=<span class="number">0</span>)&#123;</span><br><span class="line">        sb.append(pre);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sb.reverse().toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="484-Find-Permutation"><a href="#484-Find-Permutation" class="headerlink" title="484. Find Permutation"></a>484. Find Permutation</h2><p>Given a string <code>s</code>, reconstruct the lexicographically smallest permutation <code>perm</code> and return it.</p>
<p>思路：</p>
<ol>
<li>要想结果最小，则要尽可能把小的数字放前面</li>
<li>即：发现有increase，则立即出掉</li>
<li>若是decrease，则无法出掉，只能先存着</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] findPermutation(String s) &#123;</span><br><span class="line">    <span class="type">int</span> n=s.length()+<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span>[] res=<span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">    <span class="type">int</span> j=<span class="number">0</span>;</span><br><span class="line">    Deque&lt;Integer&gt; stack=<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= s.length(); i++) &#123;</span><br><span class="line">        <span class="type">char</span> c=s.charAt(i-<span class="number">1</span>);</span><br><span class="line">        stack.push(i);</span><br><span class="line">        <span class="keyword">if</span>(c==<span class="string">&#x27;I&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">while</span>(!stack.isEmpty())&#123;</span><br><span class="line">                res[j++]=stack.pop();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    stack.push(s.length()+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span>(!stack.isEmpty())&#123;</span><br><span class="line">        res[j++]=stack.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="451-Sort-Characters-By-Frequency"><a href="#451-Sort-Characters-By-Frequency" class="headerlink" title="451. Sort Characters By Frequency"></a>451. Sort Characters By Frequency</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">frequencySort</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    Map&lt;Character,Integer&gt; count=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">char</span> c=s.charAt(i);</span><br><span class="line">        count.put(c,count.getOrDefault(c,<span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    TreeMap&lt;Integer, List&lt;Character&gt;&gt; map=<span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Character c : count.keySet()) &#123;</span><br><span class="line">        <span class="type">int</span> freq=count.get(c);</span><br><span class="line">        map.putIfAbsent(freq,<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">        map.get(freq).add(c);</span><br><span class="line">    &#125;</span><br><span class="line">    StringBuilder sb=<span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">for</span> (Integer f : map.keySet()) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Character c : map.get(f)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; f; j++) &#123;</span><br><span class="line">                sb.append(c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sb.reverse().toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="556-Next-Greater-Element-III"><a href="#556-Next-Greater-Element-III" class="headerlink" title="556. Next Greater Element III"></a>556. Next Greater Element III</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">nextGreaterElement</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">//first non-ascending i</span></span><br><span class="line">    <span class="comment">//first j &gt; i</span></span><br><span class="line">    <span class="comment">//swap i,j</span></span><br><span class="line">    <span class="comment">//reverse [i+1,end]</span></span><br><span class="line">    <span class="comment">//163542</span></span><br><span class="line">    <span class="comment">//164532</span></span><br><span class="line">    <span class="comment">//164235</span></span><br><span class="line">    <span class="comment">//14321</span></span><br><span class="line">    <span class="keyword">if</span>(n==Integer.MAX_VALUE)&#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    String s=String.valueOf(n);</span><br><span class="line">    <span class="type">int</span> len=s.length();</span><br><span class="line">    <span class="type">int</span>[] nums=<span class="keyword">new</span> <span class="title class_">int</span>[len];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        nums[i]=s.charAt(i)-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> i=len-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&gt;<span class="number">0</span> &amp;&amp; nums[i-<span class="number">1</span>]&gt;=nums[i])&#123;</span><br><span class="line">        i--;</span><br><span class="line">    &#125;</span><br><span class="line">    i--;</span><br><span class="line">    <span class="keyword">if</span>(i&lt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> j=len-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; j&gt;i; j--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[j]&gt;nums[i])&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    swap(nums,i,j);</span><br><span class="line">    reverse(nums,i+<span class="number">1</span>,len-<span class="number">1</span>);</span><br><span class="line">    StringBuilder sb=<span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">        sb.append(num);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">long</span> <span class="variable">res</span> <span class="operator">=</span> Long.valueOf(sb.toString());</span><br><span class="line">    <span class="keyword">return</span> res&lt;=Integer.MAX_VALUE ? (<span class="type">int</span>)res : -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">reverse</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> start, <span class="type">int</span> end)</span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(start&lt;end)&#123;</span><br><span class="line">        swap(nums,start++,end--);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> i, <span class="type">int</span> j)</span>&#123;</span><br><span class="line">    <span class="type">int</span> temp=nums[i];</span><br><span class="line">    nums[i]=nums[j];</span><br><span class="line">    nums[j]=temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="583-Delete-Operation-for-Two-Strings"><a href="#583-Delete-Operation-for-Two-Strings" class="headerlink" title="583. Delete Operation for Two Strings"></a>583. Delete Operation for Two Strings</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minDistance</span><span class="params">(String word1, String word2)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n1=word1.length();</span><br><span class="line">    <span class="type">int</span> n2=word2.length();</span><br><span class="line">    <span class="type">int</span>[][] dp=<span class="keyword">new</span> <span class="title class_">int</span>[n1+<span class="number">1</span>][n2+<span class="number">1</span>];</span><br><span class="line">    <span class="comment">//0 1 ... n2</span></span><br><span class="line">    <span class="comment">//1</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="comment">//n1</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n1; i++) &#123;</span><br><span class="line">        dp[i][<span class="number">0</span>]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n2; i++) &#123;</span><br><span class="line">        dp[<span class="number">0</span>][i]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n1; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= n2; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(word1.charAt(i-<span class="number">1</span>)==word2.charAt(j-<span class="number">1</span>))&#123;</span><br><span class="line">                dp[i][j]=dp[i-<span class="number">1</span>][j-<span class="number">1</span>];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                dp[i][j]=Math.min(dp[i-<span class="number">1</span>][j],dp[i][j-<span class="number">1</span>])+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[n1][n2];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="467-Unique-Substrings-in-Wraparound-String"><a href="#467-Unique-Substrings-in-Wraparound-String" class="headerlink" title="467. Unique Substrings in Wraparound String"></a>467. Unique Substrings in Wraparound String</h2><p>Brute Force超时</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findSubstringInWraproundString</span><span class="params">(String p)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=p.length();</span><br><span class="line">    Set&lt;String&gt; set=<span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        StringBuilder sb=<span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="type">char</span> cur=p.charAt(j);</span><br><span class="line">            <span class="keyword">if</span>(sb.length()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="type">char</span> last=sb.charAt(sb.length()-<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(!(last==<span class="string">&#x27;z&#x27;</span> &amp;&amp; cur==<span class="string">&#x27;a&#x27;</span> || cur-last==<span class="number">1</span>))&#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            sb.append(cur);</span><br><span class="line">            set.add(sb.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> set.size();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/unique-substrings-in-wraparound-string/discuss/95439/Concise-Java-solution-using-DP">https://leetcode.com/problems/unique-substrings-in-wraparound-string/discuss/95439/Concise-Java-solution-using-DP</a></p>
<p>另类DP: </p>
<ul>
<li>子问题为由每个字母结尾的 longest continuous substring</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findSubstringInWraproundString</span><span class="params">(String p)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=p.length();</span><br><span class="line">    <span class="type">int</span>[] arr=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> cur=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(cur==<span class="number">0</span> || p.charAt(i-<span class="number">1</span>)==<span class="string">&#x27;z&#x27;</span> &amp;&amp; p.charAt(i)==<span class="string">&#x27;a&#x27;</span></span><br><span class="line">                || p.charAt(i)-p.charAt(i-<span class="number">1</span>)==<span class="number">1</span>)&#123;</span><br><span class="line">            cur++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            cur=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> idx=p.charAt(i)-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        arr[idx]=Math.max(arr[idx],cur);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">        res+=arr[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="2546-Apply-Bitwise-Operations-to-Make-Strings-Equal"><a href="#2546-Apply-Bitwise-Operations-to-Make-Strings-Equal" class="headerlink" title="2546. Apply Bitwise Operations to Make Strings Equal"></a>2546. Apply Bitwise Operations to Make Strings Equal</h2><p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/apply-bitwise-operations-to-make-strings-equal/discuss/3083831/JavaC%2B%2BPython-1-line-Check-1">https://leetcode.com/problems/apply-bitwise-operations-to-make-strings-equal/discuss/3083831/JavaC%2B%2BPython-1-line-Check-1</a></p>
<p>Enumerate the values for <code>s[i]</code> and <code>s[j]</code><br><code>(0, 0)</code> -&gt; <code>(0, 0)</code><br><code>(1, 0)</code> -&gt; <code>(1, 1)</code><br><code>(0, 1)</code> -&gt; <code>(1, 1)</code><br><code>(1, 1)</code> -&gt; <code>(1, 0)</code></p>
<p><strong>To summrize the rule</strong></p>
<ol>
<li>Two 0s stay 0s.</li>
<li>If we have 1, we can make any 0 to 1.</li>
<li>If we have at least two 1s, we can make any 1 to 0.</li>
</ol>
<p><strong>Continue to sunmmrize</strong></p>
<ol>
<li>All 0 string can not change.</li>
<li>Any other strings can transform from each other.</li>
</ol>
<p><strong>So we only need to check</strong><br>if <code>s</code> has 1.<br>if <code>target</code> has 1.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">makeStringsEqual</span><span class="params">(String s, String target)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> s.contains(<span class="string">&quot;1&quot;</span>)==target.contains(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="2531-Make-Number-of-Distinct-Characters-Equal"><a href="#2531-Make-Number-of-Distinct-Characters-Equal" class="headerlink" title="2531. Make Number of Distinct Characters Equal"></a>2531. Make Number of Distinct Characters Equal</h2><p>every possible swap, 26*26</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isItPossible</span><span class="params">(String word1, String word2)</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] arr1=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span>[] arr2=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> count1=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> count2=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; word1.length(); i++) &#123;</span><br><span class="line">        <span class="type">char</span> c=word1.charAt(i);</span><br><span class="line">        <span class="keyword">if</span>(arr1[c-<span class="string">&#x27;a&#x27;</span>]==<span class="number">0</span>)&#123;</span><br><span class="line">            count1++;</span><br><span class="line">        &#125;</span><br><span class="line">        arr1[c-<span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; word2.length(); i++) &#123;</span><br><span class="line">        <span class="type">char</span> c=word2.charAt(i);</span><br><span class="line">        <span class="keyword">if</span>(arr2[c-<span class="string">&#x27;a&#x27;</span>]==<span class="number">0</span>)&#123;</span><br><span class="line">            count2++;</span><br><span class="line">        &#125;</span><br><span class="line">        arr2[c-<span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(arr1[i]==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; <span class="number">26</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(arr2[j]==<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i==j &amp;&amp; count1==count2)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> a=count1;</span><br><span class="line">            <span class="keyword">if</span>(arr1[i]==<span class="number">1</span>)&#123;</span><br><span class="line">                a--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(arr1[j]==<span class="number">0</span> || arr1[i]==<span class="number">1</span> &amp;&amp; i==j)&#123;</span><br><span class="line">                a++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> b=count2;</span><br><span class="line">            <span class="keyword">if</span>(arr2[j]==<span class="number">1</span>)&#123;</span><br><span class="line">                b--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(arr2[i]==<span class="number">0</span> || arr2[j]==<span class="number">1</span> &amp;&amp; i==j)&#123;</span><br><span class="line">                b++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(a==b)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="763-Partition-Labels"><a href="#763-Partition-Labels" class="headerlink" title="763. Partition Labels"></a>763. Partition Labels</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">partitionLabels</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    List&lt;Integer&gt; res=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    <span class="type">char</span>[] chars=s.toCharArray();</span><br><span class="line">    <span class="type">int</span>[] last=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        last[chars[i]-<span class="string">&#x27;a&#x27;</span>]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    Set&lt;Integer&gt; set=<span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span> start=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        set.add(chars[i]-<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">        <span class="type">boolean</span> valid=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> idx : set) &#123;</span><br><span class="line">            <span class="keyword">if</span>(last[idx]&gt;i)&#123;</span><br><span class="line">                valid=<span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(valid)&#123;</span><br><span class="line">            res.add(i-start+<span class="number">1</span>);</span><br><span class="line">            start=i+<span class="number">1</span>;</span><br><span class="line">            set.clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="647-Palindromic-Substrings"><a href="#647-Palindromic-Substrings" class="headerlink" title="647. Palindromic Substrings"></a>647. Palindromic Substrings</h2><p>好题好解，一鸭三吃！</p>
<h3 id="Approach-1-Check-All-Substrings"><a href="#Approach-1-Check-All-Substrings" class="headerlink" title="Approach #1: Check All Substrings"></a>Approach #1: Check All Substrings</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">countSubstrings</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    <span class="type">char</span>[] chars=s.toCharArray();</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt;= i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(isPalindrome(chars,j,i))&#123;</span><br><span class="line">                res++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isPalindrome</span><span class="params">(<span class="type">char</span>[] chars, <span class="type">int</span> j, <span class="type">int</span> i)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(j==i)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(j&lt;=i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(chars[j]!=chars[i])&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        j++;</span><br><span class="line">        i--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Approach-3-Expand-Around-Possible-Centers"><a href="#Approach-3-Expand-Around-Possible-Centers" class="headerlink" title="Approach #3: Expand Around Possible Centers"></a>Approach #3: Expand Around Possible Centers</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">countSubstrings</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        res+=count(s,i,i)+count(s,i,i+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">count</span><span class="params">(String s, <span class="type">int</span> left, <span class="type">int</span> right)</span>&#123;</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(left&gt;=<span class="number">0</span> &amp;&amp; right&lt;s.length()</span><br><span class="line">            &amp;&amp; s.charAt(left)==s.charAt(right))&#123;</span><br><span class="line">        left--;</span><br><span class="line">        right++;</span><br><span class="line">        res++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="524-Longest-Word-in-Dictionary-through-Deleting"><a href="#524-Longest-Word-in-Dictionary-through-Deleting" class="headerlink" title="524. Longest Word in Dictionary through Deleting"></a>524. Longest Word in Dictionary through Deleting</h2><p>through deleting ? just skipping!</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">findLongestWord</span><span class="params">(String s, List&lt;String&gt; dictionary)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    Collections.sort(dictionary, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;String&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(String o1, String o2)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> o1.length()!=o2.length() ? o2.length()-o1.length() : o1.compareTo(o2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">for</span> (String word : dictionary) &#123;</span><br><span class="line">        <span class="type">int</span> idx=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(s.charAt(i)==word.charAt(idx))&#123;</span><br><span class="line">                idx++;</span><br><span class="line">                <span class="keyword">if</span>(idx==word.length())&#123;</span><br><span class="line">                    <span class="keyword">return</span> word;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="720-Longest-Word-in-Dictionary"><a href="#720-Longest-Word-in-Dictionary" class="headerlink" title="720. Longest Word in Dictionary"></a>720. Longest Word in Dictionary</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">longestWord</span><span class="params">(String[] words)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n= words.length;</span><br><span class="line">    Arrays.sort(words,(a,b)-&gt;(a.length()!=b.length() ? b.length()-a.length() : a.compareTo(b)));</span><br><span class="line">    Set&lt;String&gt; set=<span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;(Arrays.asList(words));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        String word=words[i];</span><br><span class="line">        <span class="type">int</span> j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; j &lt; word.length(); j++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!set.contains(word.substring(<span class="number">0</span>,j+<span class="number">1</span>)))&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(j==word.length())&#123;</span><br><span class="line">            <span class="keyword">return</span> word;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="767-Reorganize-String"><a href="#767-Reorganize-String" class="headerlink" title="767. Reorganize String"></a>767. Reorganize String</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">reorganizeString</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="type">char</span>[] chars = s.toCharArray();</span><br><span class="line">    <span class="type">int</span>[] arr=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="type">int</span> n=s.length();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> c : chars) &#123;</span><br><span class="line">        arr[c-<span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> max=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> maxIdx=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[i]&gt;max)&#123;</span><br><span class="line">            max=arr[i];</span><br><span class="line">            maxIdx=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2 3   2 4</span></span><br><span class="line">    <span class="comment">//3 4</span></span><br><span class="line">    <span class="keyword">if</span>(max&gt;(n+<span class="number">1</span>)/<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> idx=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(arr[maxIdx]&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        chars[idx]=(<span class="type">char</span>)(<span class="string">&#x27;a&#x27;</span>+maxIdx);</span><br><span class="line">        idx+=<span class="number">2</span>;</span><br><span class="line">        arr[maxIdx]--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">while</span>(arr[i]&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(idx&gt;=n)&#123;</span><br><span class="line">                idx=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            chars[idx]=(<span class="type">char</span>)(<span class="string">&#x27;a&#x27;</span>+i);</span><br><span class="line">            arr[i]--;</span><br><span class="line">            idx+=<span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(chars);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="937-Reorder-Data-in-Log-Files"><a href="#937-Reorder-Data-in-Log-Files" class="headerlink" title="937. Reorder Data in Log Files"></a>937. Reorder Data in Log Files</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String[] reorderLogFiles(String[] logs) &#123;</span><br><span class="line">    List&lt;Integer&gt; digits=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//[string,identifier,content]</span></span><br><span class="line">    PriorityQueue&lt;String[]&gt; pq=<span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;String[]&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(String[] a, String[] b)</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span>(a[<span class="number">2</span>].equals(b[<span class="number">2</span>]))&#123;</span><br><span class="line">                        <span class="keyword">return</span> a[<span class="number">1</span>].compareTo(b[<span class="number">1</span>]);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> a[<span class="number">2</span>].compareTo(b[<span class="number">2</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="type">int</span> n=logs.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>; j&lt;n; j++) &#123;</span><br><span class="line">        String log=logs[j];</span><br><span class="line">        <span class="type">int</span> idx=log.indexOf(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        String identifier=log.substring(<span class="number">0</span>,idx);</span><br><span class="line">        String content=log.substring(idx+<span class="number">1</span>);</span><br><span class="line">        <span class="type">boolean</span> isDigit=Character.isDigit(content.charAt(<span class="number">0</span>));</span><br><span class="line">        <span class="keyword">if</span>(isDigit)&#123;</span><br><span class="line">            digits.add(j);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            pq.offer(<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;log,identifier,content&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    String[] res=<span class="keyword">new</span> <span class="title class_">String</span>[n];</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!pq.isEmpty())&#123;</span><br><span class="line">        res[i++]=pq.poll()[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> idx=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;n)&#123;</span><br><span class="line">        res[i++]=logs[digits.get(idx++)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://invincible-nerd.github.io/2022/12/13/quotes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="invincible-nerd">
      <meta itemprop="description" content="For explorer everywhere">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IVN">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/13/quotes/" class="post-title-link" itemprop="url">quotes</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-13 22:04:00" itemprop="dateCreated datePublished" datetime="2022-12-13T22:04:00+08:00">2022-12-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-12-14 14:42:07" itemprop="dateModified" datetime="2022-12-14T14:42:07+08:00">2022-12-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9A%8F%E7%AC%94/" itemprop="url" rel="index"><span itemprop="name">随笔</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>Let no feeling of discouragement prey upon you, and in the end you are sure to succeed.</p>
<p>​                                                                                <em>Abraham Lincoln</em></p>
</blockquote>
<blockquote>
<p>You become responsible, forever, for what you have tamed.</p>
<p>​                                                                                <em>Oscar Wilde</em></p>
</blockquote>
<blockquote>
<p>Laziness is nothing more than the habit of resting before you get tired.</p>
<p>​                                                                                <em>Jules Renard</em></p>
</blockquote>
<blockquote>
<p>A day without laughter is a day wasted.</p>
<p>​                                                                                <em>Charlie Chaplin</em></p>
</blockquote>
<blockquote>
<p>Knowledge speaks, but wisdom listens.</p>
<p>​                                                                                <em>Jimi Hendrix</em></p>
</blockquote>
<blockquote>
<p>Life is something that happens when you can’t get to sleep.</p>
<p>​                                                                                <em>Fran Lebowitz</em></p>
</blockquote>
<blockquote>
<p>Truth is more of a stranger than fiction.</p>
<p>​                                                                                <em>Fran Lebowitz</em></p>
</blockquote>
<blockquote>
<p>Everyone is a moon and has a dark side which he never shows to anybody.</p>
<p>​                                                                                <em>Mark Twain</em></p>
</blockquote>
<blockquote>
<p>Art is making something out of nothing and selling it.</p>
<p>​                                                                                <em>Frank Zappa</em></p>
</blockquote>
<blockquote>
<p>Better to write for yourself and have no public, than to write for the public and have no self.</p>
<p>​                                                                                <em>Cyril Connolly</em></p>
</blockquote>
<blockquote>
<p>It is our choices that show what we truly are, far more than our abilities.</p>
<p>​                                                                                <em>J. K. Rowling</em></p>
</blockquote>
<blockquote>
<p>Everything is funny as long as it is happening to somebody else.</p>
<p>​                                                                                <em>Will Rogers</em></p>
</blockquote>
<blockquote>
<p>When you have eliminated the impossible, whatever remains, however improbable, must be the truth.</p>
<p>​                                                                                <em>Sir Arthur Conan Doyle</em></p>
</blockquote>
<blockquote>
<p>A good novel tells us the truth about its hero; but a bad novel tells us the truth about its author.</p>
<p>​                                                                                <em>G. K. Chesterton</em></p>
</blockquote>
<blockquote>
<p>Famous remarks are very seldom quoted correctly.</p>
<p>​                                                                                <em>Simeon Strunsky</em></p>
</blockquote>
<blockquote>
<p>The two most important days in your life are the day you are born and the day you find out why.</p>
<p>​                                                                                <em>Mark Twain</em></p>
</blockquote>
<blockquote>
<p>The two most important days in your life are the day you are born and the day you find out why.</p>
<p>​                                                                                <em>Mark Twain</em></p>
</blockquote>
<blockquote>
<p>Fashion is a form of ugliness so intolerable that we have to alter it every six months.</p>
<p>​                                                                                <em>Oscar Wilde</em></p>
</blockquote>
<blockquote>
<p>Education’s purpose is to replace an empty mind with an open one.</p>
<p>​                                                                                <em>Malcolm Forbes</em></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://invincible-nerd.github.io/2022/12/11/Segment-Tree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="invincible-nerd">
      <meta itemprop="description" content="For explorer everywhere">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IVN">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/11/Segment-Tree/" class="post-title-link" itemprop="url">Segment Tree</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-12 12:13:47" itemprop="dateCreated datePublished" datetime="2022-12-12T12:13:47+08:00">2022-12-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-12-28 13:53:12" itemprop="dateModified" datetime="2022-12-28T13:53:12+08:00">2022-12-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LeetCode/" itemprop="url" rel="index"><span itemprop="name">LeetCode</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>4.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Segment-Tree选编"><a href="#Segment-Tree选编" class="headerlink" title="Segment Tree选编"></a>Segment Tree选编</h1><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>如何表示线段树？</p>
<ol>
<li>直接用node构造一棵树</li>
<li>用一个数组模拟一棵树</li>
</ol>
<p>三大功能：</p>
<ol>
<li>build</li>
<li>querySum</li>
<li>update</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NumArray</span> &#123;</span><br><span class="line">    SegmentTree tree;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">NumArray</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        tree = <span class="keyword">new</span> <span class="title class_">SegmentTree</span>(nums);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">        tree.update(i, val);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sumRange</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> tree.querySum(i, j);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SegmentTree</span>&#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">root</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        SegmentTree(<span class="type">int</span>[] array)&#123;</span><br><span class="line">            <span class="built_in">this</span>.root = build(<span class="number">0</span>, array.length-<span class="number">1</span>, array);</span><br><span class="line">        &#125;</span><br><span class="line">        Node <span class="title function_">build</span><span class="params">(<span class="type">int</span> start, <span class="type">int</span> end, <span class="type">int</span>[] array)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (start&gt;end)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(start, end);</span><br><span class="line">            <span class="keyword">if</span> (start==end)&#123;</span><br><span class="line">                node.sum = array[start];</span><br><span class="line">                <span class="keyword">return</span> node;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> start + (end-start)/<span class="number">2</span>;</span><br><span class="line">            node.left = build(start, mid, array);</span><br><span class="line">            node.right = build(mid+<span class="number">1</span>, end, array);</span><br><span class="line">            node.sum = node.left.sum + node.right.sum;</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="title function_">querySum</span><span class="params">(<span class="type">int</span> start, <span class="type">int</span> end)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> querySum(root, start, end);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="title function_">querySum</span><span class="params">(Node root, <span class="type">int</span> start, <span class="type">int</span> end)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (start&gt;end)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (root.start==start &amp;&amp; root.end==end)&#123;</span><br><span class="line">                <span class="keyword">return</span> root.sum;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> root.start + (root.end-root.start)/<span class="number">2</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">leftsum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">rightsum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (start&lt;=mid)&#123;</span><br><span class="line">                leftsum = querySum(root.left, start, Math.min(mid, end));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (end&gt;=mid+<span class="number">1</span>)&#123;</span><br><span class="line">                rightsum = querySum(root.right, Math.max(mid+<span class="number">1</span>, start), end);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> leftsum+rightsum;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(<span class="type">int</span> index, <span class="type">int</span> value)</span>&#123;</span><br><span class="line">            update(root, index, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Node root, <span class="type">int</span> index, <span class="type">int</span> value)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (root.start==index &amp;&amp; root.end==index)&#123;</span><br><span class="line">                root.sum = value;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> root.start + (root.end-root.start)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (index &lt;= mid)&#123;</span><br><span class="line">                update(root.left, index, value);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                update(root.right, index, value);</span><br><span class="line">            &#125;</span><br><span class="line">            root.sum = root.left.sum + root.right.sum;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">        <span class="type">int</span> start;</span><br><span class="line">        <span class="type">int</span> end;</span><br><span class="line">        <span class="type">int</span> sum;</span><br><span class="line">        Node left;</span><br><span class="line">        Node right;</span><br><span class="line">        Node(<span class="type">int</span> start, <span class="type">int</span> end)&#123;</span><br><span class="line">            <span class="built_in">this</span>.start = start;</span><br><span class="line">            <span class="built_in">this</span>.end = end;</span><br><span class="line">            sum = <span class="number">0</span>;</span><br><span class="line">            left = <span class="literal">null</span>;</span><br><span class="line">            right = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="327-Count-of-Range-Sum"><a href="#327-Count-of-Range-Sum" class="headerlink" title="327. Count of Range Sum"></a>327. Count of Range Sum</h2><p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/count-of-range-sum/discuss/1674377/Java-Segment-Tree-With-Explanation">https://leetcode.com/problems/count-of-range-sum/discuss/1674377/Java-Segment-Tree-With-Explanation</a></p>
<p>prefix_sum超时，考虑用segment_tree</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Time Limit Exceeded</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">countRangeSum</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> lower, <span class="type">int</span> upper)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n=nums.length;</span><br><span class="line">    <span class="comment">//pres[i]=[0,i]=pres[i-1]+nums[i]</span></span><br><span class="line">    <span class="type">long</span>[] pres=<span class="keyword">new</span> <span class="title class_">long</span>[n];</span><br><span class="line">    pres[<span class="number">0</span>]=nums[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        pres[i]=pres[i-<span class="number">1</span>]+nums[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//sums(i,j)=[0,j]-[0,i-1]=pres[j]-pres[i-1]</span></span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="type">long</span> sum= i==<span class="number">0</span> ? pres[j] : pres[j]-pres[i-<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span>(sum&gt;=lower &amp;&amp; sum&lt;=upper)&#123;</span><br><span class="line">                res++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/count-of-range-sum/solution/by-ac_oier-b36o/">https://leetcode.cn/problems/count-of-range-sum/solution/by-ac_oier-b36o/</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    树状数组模板</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> <span class="number">0</span>;    <span class="comment">// 树状数组索引</span></span><br><span class="line">    <span class="type">int</span>[] tr = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">3</span> * <span class="number">100010</span>]; <span class="comment">// 树状数组节点(数目等于元素坑位数)</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">lowBit</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 往u坑位加上x</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> u; i &lt;= idx; i += lowBit(i)) &#123;</span><br><span class="line">            tr[i] += x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询[1,x]前缀和</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">query</span><span class="params">(<span class="type">int</span> u)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> u; i &gt; <span class="number">0</span>; i -= lowBit(i)) &#123;</span><br><span class="line">            res += tr[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">countRangeSum</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> lower, <span class="type">int</span> upper)</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        离散化+树状数组:</span></span><br><span class="line"><span class="comment">        题目原意:给定数组nums,寻找nums中区间和在[lower,upper]的区间sum[i,j]个数</span></span><br><span class="line"><span class="comment">        设当前区间区间为[i,j],移动j指针,我们只需要的求出每个以j结尾的区间有多少个是区间和在[lower,upper]即可</span></span><br><span class="line"><span class="comment">        朴素的解法中我们可以扫描k∈[0,i-1],求适合的k有多少个,时间复杂度综合为O(N^2)</span></span><br><span class="line"><span class="comment">        逆向思维,我们把目光放在[0,k]区间上,设sum[0,i]=sum[0,k]+sum[k+1,i]=s</span></span><br><span class="line"><span class="comment">        其中lower&lt;=sum[k+1,i]&lt;=upper --&gt; lower&lt;=s-sum[0,k]&lt;=upper --&gt; s-upper&lt;=sum[0,k]&lt;=s-lower</span></span><br><span class="line"><span class="comment">        我们把问题就转化为了求在[0,i-1]区间内前缀和为[s-upper,s-lower]的个数</span></span><br><span class="line"><span class="comment">        求前缀和&quot;个数&quot;,同时前缀和的值域范围爆炸,我们把可能出现的前缀和直接离散化分散到特定数据结构</span></span><br><span class="line"><span class="comment">        然后统计[s-upper,s-lower]范围内的前缀和个数可以抽象成 前面前缀和出现了就在对应坑位数目+1 ,然后再进行区间求和</span></span><br><span class="line"><span class="comment">        此处要想在O(logN)内求出某个区间的和(前缀和作差得到)就要用到树状数组</span></span><br><span class="line"><span class="comment">        前缀和可能出现的情况数目为:3*1e5</span></span><br><span class="line"><span class="comment">        总体时间复杂度:O(NlogN) 空间复杂度:O(N)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// 将前缀和进行去重</span></span><br><span class="line">        HashSet&lt;Long&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();    <span class="comment">// 存储可能出现的前缀和</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">preSum</span> <span class="operator">=</span> <span class="number">0L</span>;</span><br><span class="line">        set.add(<span class="number">0L</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            preSum += num;</span><br><span class="line">            set.add(preSum);</span><br><span class="line">            set.add(preSum - upper);</span><br><span class="line">            set.add(preSum - lower);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 排序并离散化</span></span><br><span class="line">        List&lt;Long&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(set);</span><br><span class="line">        Collections.sort(list);</span><br><span class="line">        HashMap&lt;Long, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();   <span class="comment">// 存储某个前缀和对应的索引</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">long</span> sum : list) map.put(sum, ++idx);   <span class="comment">// 树状数组索引从1开始</span></span><br><span class="line">        preSum = <span class="number">0L</span>;</span><br><span class="line">        add(map.get(preSum), <span class="number">1</span>);    <span class="comment">// 初始化前缀和为0的坑位+1</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            preSum += num;</span><br><span class="line">            <span class="comment">// a 为前缀和preSum-lower对应坑位; b 为前缀和preSum-upper对应坑位</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> map.get(preSum - lower), b = map.get(preSum - upper);</span><br><span class="line">            res += query(a) - query(b - <span class="number">1</span>); <span class="comment">// 累加[preSum-upper,preSum-lower]前缀和个数</span></span><br><span class="line">            <span class="comment">// 记得是先求完前缀和个数再更新,保证树状数组是[0,i-1]状态下的</span></span><br><span class="line">            add(map.get(preSum), <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://invincible-nerd.github.io/2022/12/04/COEN317/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="invincible-nerd">
      <meta itemprop="description" content="For explorer everywhere">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IVN">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/04/COEN317/" class="post-title-link" itemprop="url">COEN317</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-04 22:20:42" itemprop="dateCreated datePublished" datetime="2022-12-04T22:20:42+08:00">2022-12-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-12-05 14:22:15" itemprop="dateModified" datetime="2022-12-05T14:22:15+08:00">2022-12-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>22k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>20 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="COEN-317-Distributed-system"><a href="#COEN-317-Distributed-system" class="headerlink" title="COEN 317     Distributed system"></a>COEN 317     Distributed system</h1><h2 id="09-x2F-21"><a href="#09-x2F-21" class="headerlink" title="09&#x2F;21"></a>09&#x2F;21</h2><h3 id="layer-tier"><a href="#layer-tier" class="headerlink" title="layer tier"></a>layer tier</h3><ul>
<li>layer: software</li>
<li>tier: hardware</li>
</ul>
<h3 id="layerd-architecture-style"><a href="#layerd-architecture-style" class="headerlink" title="layerd architecture style"></a>layerd architecture style</h3><ul>
<li>separation of concerns</li>
<li>unnecessary transaction</li>
<li>grey line, hard to decide which layer to put</li>
</ul>
<h3 id="event-based-architecture-styles"><a href="#event-based-architecture-styles" class="headerlink" title="event based architecture styles"></a>event based architecture styles</h3><ul>
<li>dynamic</li>
<li>at the beginning, each component don’t know who to communicate to</li>
<li>after that, can point-to-point</li>
</ul>
<h3 id="middleware"><a href="#middleware" class="headerlink" title="middleware"></a>middleware</h3><ul>
<li>libararies, runtime environment</li>
<li>JVM</li>
</ul>
<h3 id="blocking"><a href="#blocking" class="headerlink" title="blocking"></a>blocking</h3><ul>
<li><p>sent&#x2F;transmission !&#x3D; reach the destination</p>
</li>
<li><p>blocking: suspended until transmission finishes</p>
</li>
<li><p>transmission:  IT DEPENDS!</p>
<ol>
<li><p>sending message buffer</p>
</li>
<li><p>channel</p>
</li>
<li><p>receiving messsage buffer</p>
</li>
</ol>
</li>
</ul>
<h3 id="persistent-communication"><a href="#persistent-communication" class="headerlink" title="persistent communication"></a>persistent communication</h3><ul>
<li>message queue</li>
<li>need to store data</li>
</ul>
<h3 id="asynchronous"><a href="#asynchronous" class="headerlink" title="asynchronous"></a>asynchronous</h3><ul>
<li>synchronous: wait unitl <strong>delivery</strong>, not process of the data</li>
</ul>
<h3 id="soft-state"><a href="#soft-state" class="headerlink" title="soft state"></a>soft state</h3><p>cache</p>
<h2 id="09-x2F-26"><a href="#09-x2F-26" class="headerlink" title="09&#x2F;26"></a>09&#x2F;26</h2><ul>
<li><p>application-specific protocol</p>
</li>
<li><p>application-independent protocol: </p>
<p><strong>middleware</strong></p>
</li>
<li><p>TCP&#x2F;IP protocol:</p>
<p>local OS</p>
</li>
</ul>
<h3 id="why-layered"><a href="#why-layered" class="headerlink" title="why layered?"></a>why layered?</h3><p>separation of concerns</p>
<h3 id="OSI-reference-model"><a href="#OSI-reference-model" class="headerlink" title="OSI reference model"></a>OSI reference model</h3><ol>
<li><p>application</p>
</li>
<li><p>presentation</p>
<ul>
<li>process information for applications</li>
<li>serialization&#x2F;deserialization</li>
<li>encryption&#x2F;decryption</li>
</ul>
</li>
<li><p>session</p>
</li>
<li><p>transport</p>
<ul>
<li>end-to-end communication between different applications</li>
</ul>
</li>
<li><p>network</p>
<ul>
<li>routing packets</li>
</ul>
</li>
<li><p>data link</p>
<ul>
<li>send, detect and corrent data frames</li>
<li>data frames: units of bits</li>
</ul>
</li>
<li><p>physical layer</p>
<ul>
<li>actual transfer of binary bits data</li>
</ul>
</li>
</ol>
<p>​          </p>
<h3 id="TCP-x2F-IP-protocol-suite"><a href="#TCP-x2F-IP-protocol-suite" class="headerlink" title="TCP&#x2F;IP protocol suite"></a>TCP&#x2F;IP protocol suite</h3><ol>
<li><p>application</p>
<ul>
<li>HTTP, FTP, SMTP</li>
<li>process-to-process</li>
</ul>
</li>
<li><p>transport</p>
<ul>
<li>TCP, UDP</li>
<li>host-to-host</li>
</ul>
</li>
<li><p>internet</p>
<ul>
<li><p>IP</p>
</li>
<li><p>routing table</p>
<p>host a-&gt; router -&gt; router -&gt; host b</p>
</li>
</ul>
</li>
<li><p>link</p>
</li>
</ol>
<p>​        </p>
<h3 id="TCP-UDP"><a href="#TCP-UDP" class="headerlink" title="TCP UDP"></a>TCP UDP</h3><ul>
<li><p>TCP</p>
<p>data in streams</p>
</li>
<li><p>UDP</p>
<p>data in messages</p>
</li>
</ul>
<h3 id="remote-procedure-calls"><a href="#remote-procedure-calls" class="headerlink" title="remote procedure calls"></a>remote procedure calls</h3><p>remote invocation</p>
<ul>
<li>one-way RPC</li>
<li>asynchronous RPC</li>
</ul>
<h3 id="remote-object-calls"><a href="#remote-object-calls" class="headerlink" title="remote object calls"></a>remote object calls</h3><h3 id="message-brokers"><a href="#message-brokers" class="headerlink" title="message brokers"></a>message brokers</h3><ul>
<li><p>between clients and servers</p>
</li>
<li><p>beyond simple queues</p>
</li>
<li><p>message will be persistent</p>
</li>
</ul>
<h3 id="socket-APIs"><a href="#socket-APIs" class="headerlink" title="socket APIs"></a>socket APIs</h3><ul>
<li>transport-level socket programming via socket interface</li>
<li>message-oriented transient communication at the <strong>transport layer</strong></li>
</ul>
<h3 id="Messaging-passing-interface"><a href="#Messaging-passing-interface" class="headerlink" title="Messaging-passing interface"></a>Messaging-passing interface</h3><ul>
<li>message-oriented transient communication at the <strong>application layer</strong></li>
</ul>
<h3 id="queuing-model"><a href="#queuing-model" class="headerlink" title="queuing model"></a>queuing model</h3><ul>
<li><p>message-oriented persistent communication</p>
</li>
<li><p>asynchronous&#x2F;time uncoupling</p>
</li>
<li><p>advanced message queuing protocol</p>
<p>rabbitMQ</p>
</li>
</ul>
<h2 id="0928"><a href="#0928" class="headerlink" title="0928"></a>0928</h2><h3 id="why-some-inaccuracy-is-tolerable"><a href="#why-some-inaccuracy-is-tolerable" class="headerlink" title="why some inaccuracy is tolerable?"></a>why some inaccuracy is tolerable?</h3><ol>
<li>more than one failure detection mechanism</li>
<li>in heart-beating, after some times it will correct itself</li>
</ol>
<h3 id="atomic-gt-reliable"><a href="#atomic-gt-reliable" class="headerlink" title="atomic &gt; reliable"></a>atomic &gt; reliable</h3><ul>
<li>atomic: all or none receive the message   <strong>overkill</strong></li>
<li>reliable: we can tolerate some inaccuracy</li>
</ul>
<h3 id="centralized-heart-beating-out-of-consideration"><a href="#centralized-heart-beating-out-of-consideration" class="headerlink" title="centralized heart-beating   out of consideration!"></a>centralized heart-beating   out of consideration!</h3><ul>
<li>single point  &#x2F;   performance</li>
<li>too much workload for the center node</li>
<li>can not be dynamic:  the center needs to know the global state</li>
<li>saturated</li>
</ul>
<h3 id="ring-heart-beating-valid"><a href="#ring-heart-beating-valid" class="headerlink" title="ring heart-beating  valid"></a>ring heart-beating  valid</h3><ul>
<li>predecessor and successor</li>
<li>what if 2 nodes fail?     stablization protocol</li>
<li>detection is too slow</li>
</ul>
<h3 id="all-to-all-heart-beating-valid"><a href="#all-to-all-heart-beating-valid" class="headerlink" title="all-to-all heart-beating    valid"></a>all-to-all heart-beating    valid</h3><ul>
<li>full of unnecessary message</li>
<li>can not be dynamic</li>
</ul>
<h3 id="false-positive-x2F-false-negative"><a href="#false-positive-x2F-false-negative" class="headerlink" title="false positive  &#x2F;   false negative"></a>false positive  &#x2F;   false negative</h3><ul>
<li>inaccurate</li>
<li>incomplete!   intolerable</li>
</ul>
<h3 id="local-buffers-processes-and-channels"><a href="#local-buffers-processes-and-channels" class="headerlink" title="local buffers   processes and channels"></a>local buffers   processes and channels</h3><ul>
<li>copy message to outgoing message buffer   send</li>
<li>copy message from incoming message buffer   receive</li>
<li>latency: in channel and in operation system</li>
</ul>
<h3 id="process-failure-x2F-channel-failure"><a href="#process-failure-x2F-channel-failure" class="headerlink" title="process failure &#x2F; channel failure"></a>process failure &#x2F; channel failure</h3><h2 id="1003"><a href="#1003" class="headerlink" title="1003"></a>1003</h2><h3 id="virtualization"><a href="#virtualization" class="headerlink" title="virtualization"></a>virtualization</h3><ul>
<li>Virtual Machine Memory &#x3D; Hypervisor</li>
</ul>
<ol>
<li><p>platform virtualization, hosted VM<br>shared OS</p>
<ol>
<li>hardware</li>
<li>host OS<br>Patch, upgrade together</li>
<li>hypervisor, virtualizing the OS</li>
<li>applications, limited(no kernel module)<br>example: Linux container<br>host OS adminstrater sees everything! not fully isolated!<br>reboot OS? all down!</li>
</ol>
</li>
<li><p>full virtualization, native VM<br>independent guest OS</p>
<ol>
<li>hardware</li>
<li>hypervisor, virtualizing the hardware</li>
<li>virtual hardwares, including VCPU, VNIC</li>
<li>guest OSs(Windows, Linux, MacOS)</li>
<li>applications<br>fully isolated!<br>less scalable<br>better performance</li>
</ol>
</li>
<li><p>combined<br>within each guest OS, platform virtualization(virtualzing some guest OS)</p>
</li>
</ol>
<h3 id="network-address-translation"><a href="#network-address-translation" class="headerlink" title="network address translation"></a>network address translation</h3><p>NIC: Network Interface Control<br>NAT: Network address translation<br>hardware: MAC, Media Access Control<br>VMs: MACs<br>query NAT table for every connection<br>improvement: SRIOV</p>
<h4 id="SRIOV"><a href="#SRIOV" class="headerlink" title="SRIOV"></a>SRIOV</h4><p>integrate NAT into NIC<br>PCIe: Peripheral Component Interconnect express     chip-to-chip interconnect<br>Ethernet: via cables                                system-to-system</p>
<h3 id="network-bridging"><a href="#network-bridging" class="headerlink" title="network bridging"></a>network bridging</h3><p>poor scalability<br>bridge over the hypervisor for better performance</p>
<h3 id="host-only-networking"><a href="#host-only-networking" class="headerlink" title="host only networking"></a>host only networking</h3><p>inter instance communication, VM to VM</p>
<h2 id="1005"><a href="#1005" class="headerlink" title="1005"></a>1005</h2><h3 id="P2P-exmaple-Napster"><a href="#P2P-exmaple-Napster" class="headerlink" title="P2P exmaple: Napster"></a>P2P exmaple: Napster</h3><ul>
<li>server <ol>
<li>stores no files</li>
<li>maintains a table</li>
<li>response with where to download the music(IP address, port)</li>
</ol>
</li>
<li>client stores their own data</li>
<li>server search: <strong>ternary tree</strong> algorithm</li>
<li>problem:<ol>
<li>infringement of copyright</li>
<li>security : each peer exposes a port; clear-text communication</li>
<li>fault-tolerance: centralized server, centralized algorithm<br><strong>single point of failure</strong></li>
</ol>
</li>
</ul>
<h3 id="Distributed-Hash-Table"><a href="#Distributed-Hash-Table" class="headerlink" title="Distributed Hash Table"></a>Distributed Hash Table</h3><ul>
<li><p>objects: files</p>
</li>
<li><p>bucket: nodes</p>
</li>
<li><p>hash function: consistent hashing    <strong>hash ring</strong><br>SHA-1(<strong>filename</strong> IP address, port)  &#x3D;&gt; 160-bit string(key) <strong>m bits</strong><br>may use leader-election algorithm</p>
</li>
<li><p>routing mechanism: </p>
<ul>
<li>routing: all operations, including <strong>insert, lookup and delete</strong></li>
<li>each node knows its successor and predecessor <strong>node id: 0~pow(2,m)-1</strong></li>
<li>each node computes a finger table(routing table, nodes it knows)</li>
<li>if doesn’t have the file(after local search), querying, <strong>each step halves the distance O(log(N))</strong><ol>
<li>go(forward) to the farthest node in finger table, but no crossing the key</li>
<li>if none exist, send query to successor</li>
</ol>
</li>
<li>all query steps are RPCs</li>
</ul>
</li>
<li><p>search under peer failures</p>
<ul>
<li>one solution: maintain <strong>(r)</strong> more than one successor entries instead of one <ul>
<li>if one query fails, go to the next successor</li>
<li>sender’s finger table not yet corrected</li>
</ul>
</li>
<li>one solution: replicate file&#x2F;key at r successors and predecessors</li>
</ul>
</li>
<li><p>new peers joining  (dynamic changes <strong>churn</strong>)</p>
<ul>
<li>stablization protocol followed by all nodes    <strong>stablization algorithm</strong><ul>
<li>periodically check and update</li>
<li>ensure non-loopiness</li>
</ul>
</li>
<li>copy keys and update finger table</li>
<li>bandwidth cost   busy network</li>
<li>alternatives: store and replicate only pointers to files(meta info)</li>
</ul>
</li>
</ul>
<h2 id="1010"><a href="#1010" class="headerlink" title="1010"></a>1010</h2><h3 id="naming-in-distributed-systems"><a href="#naming-in-distributed-systems" class="headerlink" title="naming in distributed systems"></a>naming in distributed systems</h3><ul>
<li><p>same name; unique identifier</p>
</li>
<li><p>address &#x3D; identifer + access point</p>
</li>
<li><p>context is import! </p>
<ul>
<li>global</li>
<li>local</li>
</ul>
</li>
<li><p>dynamic or static binding?</p>
</li>
</ul>
<h3 id="broadcast-link-network"><a href="#broadcast-link-network" class="headerlink" title="broadcast link network"></a>broadcast link network</h3><ul>
<li>identifier: IP and MAC address    <strong>Media Access Control</strong></li>
<li>arp -a    every node in the network will broadcast their id</li>
</ul>
<h3 id="independent-nodes-P2P-system"><a href="#independent-nodes-P2P-system" class="headerlink" title="independent nodes   P2P system"></a>independent nodes   P2P system</h3><ul>
<li>identifier: hash to 160-bits-string, then truncate it to m bits(name space)</li>
<li>name resolution: distributed hash tables</li>
<li>shaw-one algorithm</li>
</ul>
<h3 id="flat-naming"><a href="#flat-naming" class="headerlink" title="flat naming"></a>flat naming</h3><ul>
<li>no structure, just plain bits</li>
<li>ip address</li>
</ul>
<h3 id="structured-naming"><a href="#structured-naming" class="headerlink" title="structured naming"></a>structured naming</h3><ul>
<li>directory</li>
<li>file system: <ul>
<li>alias: short, multiple names</li>
<li>multiple path to one file</li>
</ul>
</li>
</ul>
<h3 id="centralized-management-generic-problems"><a href="#centralized-management-generic-problems" class="headerlink" title="centralized management    generic problems"></a>centralized management    generic problems</h3><ul>
<li>global state: no one can know all</li>
<li>transaction for second</li>
<li>single point of failure</li>
</ul>
<h3 id="hard-links-amp-amp-symbolic-links"><a href="#hard-links-amp-amp-symbolic-links" class="headerlink" title="hard links &amp;&amp; symbolic links"></a>hard links &amp;&amp; symbolic links</h3><ul>
<li><p>hard links:</p>
<ul>
<li>When adding one hard link, this file’s reference count++</li>
<li>must delete reference count before deleting</li>
</ul>
</li>
<li><p>symbolic links:</p>
<ul>
<li>When adding one link, the file will store the meta data pointing to the original file</li>
<li>linux: ln -s</li>
</ul>
</li>
</ul>
<h3 id="mounting"><a href="#mounting" class="headerlink" title="mounting"></a>mounting</h3><ul>
<li>nfs protocol       </li>
<li>remote server B: share file&#x2F;directory<ul>
<li>linux: exportfs &#x2F;home&#x2F;steen</li>
</ul>
</li>
<li>local server A: mount remote shared file&#x2F;directory locally<ul>
<li>linux: mount B.ip:&#x2F;home&#x2F;steen &#x2F;remote&#x2F;vu </li>
<li>linux: cd &#x2F;remote&#x2F;vu</li>
</ul>
</li>
</ul>
<h3 id="name-resolution"><a href="#name-resolution" class="headerlink" title="name resolution"></a>name resolution</h3><ul>
<li><p>client send query to name servers<br>host query DNS server</p>
</li>
<li><p>linux: </p>
<ul>
<li>the host knows where to query in DNS<br>&#x2F;etc&#x2F;reslve.conf</li>
</ul>
<ol>
<li>nslookup  <a target="_blank" rel="noopener" href="http://www.scu.edu/">www.scu.edu</a></li>
<li>dig</li>
</ol>
</li>
<li><p>iterative</p>
</li>
<li><p>recursive</p>
</li>
<li><p>redundancy and caching server</p>
<ul>
<li>speed</li>
<li>fault tolerance</li>
</ul>
</li>
<li><p>caching on the client side: local browser name resolver</p>
</li>
</ul>
<h3 id="attribute-based-naming"><a href="#attribute-based-naming" class="headerlink" title="attribute-based naming"></a>attribute-based naming</h3><ul>
<li>tuple&#x2F;triple: key, value&#x2F;set of values</li>
<li>Lightweigh Directory Access Protocol</li>
<li>when sending email, client query LDAP server<br>west coast, east coast, europe, …</li>
<li>Directory Information Base  <strong>data sharding</strong></li>
</ul>
<h2 id="1017"><a href="#1017" class="headerlink" title="1017"></a>1017</h2><h3 id="gossip-multicast"><a href="#gossip-multicast" class="headerlink" title="gossip  multicast"></a>gossip  multicast</h3><ul>
<li>fault tolerance</li>
<li>scalability     sending messages fast</li>
</ul>
<h3 id="centralized-approach"><a href="#centralized-approach" class="headerlink" title="centralized approach"></a>centralized approach</h3><ul>
<li>performance bottleneck   not scalable</li>
<li>single point of failure  not reliable</li>
<li>communication channel may be unreliable<ul>
<li>acknowlegement      protocol</li>
</ul>
</li>
</ul>
<h3 id="tree-based-mechanism"><a href="#tree-based-mechanism" class="headerlink" title="tree-based mechanism"></a>tree-based mechanism</h3><ul>
<li>overheads:<ol>
<li>someone needs to be responsible to set up and maintain the tree</li>
<li>acknowledgement    ACKs &#x2F; NAKs</li>
<li>RMTP      SRM</li>
</ol>
</li>
</ul>
<h3 id="gossip-protocol-epidemic-multicast"><a href="#gossip-protocol-epidemic-multicast" class="headerlink" title="gossip protocol     epidemic multicast"></a>gossip protocol     epidemic multicast</h3><ul>
<li><p>every round, pick random targets and send messages via UDP</p>
</li>
<li><p>may have duplicates(send messages back)</p>
</li>
<li><p>once become infected, do the same</p>
</li>
<li><p>push vs pull</p>
<ul>
<li>push: whenever have a new mutlicast message</li>
<li>pull: periodically poll<br>if node crashes, after coming back, and poll messages   fault-tolerant</li>
</ul>
</li>
<li><p>topology-aware gossip:</p>
<ul>
<li>to reduce router load</li>
<li>fix: pick gossip target in its subnet</li>
</ul>
</li>
</ul>
<h2 id="1024"><a href="#1024" class="headerlink" title="1024"></a>1024</h2><h3 id="time-and-ordering"><a href="#time-and-ordering" class="headerlink" title="time and ordering"></a>time and ordering</h3><ul>
<li>host1, host2, host3</li>
<li>t1    t2      t3</li>
<li>each have local clocks(local frequencies)</li>
<li>within host1, different processes, all have same time t1</li>
<li>each process will order tasks it has</li>
<li>However, to order p1 from host1 and p2 from host2? <strong>Time Synchronization</strong></li>
</ul>
<h3 id="time-synchronization"><a href="#time-synchronization" class="headerlink" title="time synchronization"></a>time synchronization</h3><ol>
<li>external time synchronization: <ul>
<li>rely on external time source</li>
<li>when off bounds, sychronize</li>
<li>Cristian’s algorithm, NTP</li>
<li>problem: unbounded latency in asynchronous system:<ol>
<li>network latency</li>
<li>processing latency</li>
</ol>
</li>
</ul>
</li>
<li>internal time synchronization: <ul>
<li>between hosts’s processes, clock skew</li>
<li>when off bounds, sychronize</li>
<li>Berkeley algorithm</li>
<li>problem: time drift from the UTC(correct time)</li>
</ul>
</li>
<li>logical time synchronization</li>
</ol>
<h3 id="clock-skew-amp-amp-clock-drift"><a href="#clock-skew-amp-amp-clock-drift" class="headerlink" title="clock skew &amp;&amp; clock drift"></a>clock skew &amp;&amp; clock drift</h3><ul>
<li>clock skew; distance</li>
<li>clock drift: speeds difference</li>
<li>non-zero clock skew: clocks are not synchronized</li>
<li>non-zero clock drift: the skew will increase</li>
</ul>
<h3 id="cristian’s-algorithm"><a href="#cristian’s-algorithm" class="headerlink" title="cristian’s algorithm"></a>cristian’s algorithm</h3><ul>
<li>RTT: round-trip time</li>
<li>erro is at most (RTT-min2-min1)&#x2F;2</li>
<li>still has problem:<br>bounded error &#x3D;&gt; error rate more than zero<br>what if processes asynchronize within the bound? &#x3D;&gt; won’t trigger the algorithm</li>
</ul>
<h3 id="Network-Time-Protocol"><a href="#Network-Time-Protocol" class="headerlink" title="Network Time Protocol"></a>Network Time Protocol</h3><ul>
<li>to reduce min1, min2</li>
<li>leaf nodes are clients</li>
<li>child has ts1, tr1, ts2, tr2, then calculate the offset &#x3D; (tr1-tr2+ts2-ts1)&#x2F;2</li>
<li>error: difference between the calcuated offset and the real offset</li>
<li>still have a non-zero error!! &#x3D;&gt; still invalid in asynchronous distributed system</li>
</ul>
<h3 id="logical-time-instead-of-absolute-time"><a href="#logical-time-instead-of-absolute-time" class="headerlink" title="logical time, instead of absolute time"></a>logical time, instead of absolute time</h3><ul>
<li>Leslie Lamport, Turing award</li>
<li>causality: <ol>
<li>ordering within one process</li>
<li>send-recieve message between two processes</li>
</ol>
</li>
<li>transitivity</li>
<li>lamport timestaps   ts&#x3D;max(local,msg)+1</li>
<li>timestamp doesn’t not determine order, only causal path does!</li>
<li>timestamps only matter if there is a causal path!</li>
<li>when there is no causal path? concurrent events</li>
<li>shortcoming: can’t tell where two events are concurrent or not</li>
</ul>
<h3 id="vector-timestamps"><a href="#vector-timestamps" class="headerlink" title="vector timestamps"></a>vector timestamps</h3><ul>
<li>n processes &#x3D;&gt; n elements within the vector</li>
<li>each process maintains a vector</li>
<li>causality: iff VT1 &lt;&#x3D; VT2</li>
<li>concurrent (VT1 ||| VT2): !(VT1 &lt;&#x3D; VT2) &amp;&amp; !(VT2 &lt;&#x3D; VT1)</li>
</ul>
<h2 id="1026"><a href="#1026" class="headerlink" title="1026"></a>1026</h2><h3 id="coordination-coordinator-x2F-leader-x2F-introducer"><a href="#coordination-coordinator-x2F-leader-x2F-introducer" class="headerlink" title="coordination  coordinator&#x2F;leader&#x2F;introducer"></a>coordination  coordinator&#x2F;leader&#x2F;introducer</h3><ol>
<li>receive client requrest &#x3D;&gt; forward to appropriate host</li>
<li>handling of failure&#x2F;join&#x2F;leave</li>
</ol>
<ul>
<li><p>property&#x2F;attribute: cpu, disk, ID, space</p>
</li>
<li><p>safety: get an election result</p>
</li>
<li><p>liveness: election terminates</p>
</li>
</ul>
<h3 id="ring-election-protocol-consensus-problem"><a href="#ring-election-protocol-consensus-problem" class="headerlink" title="ring election protocol    consensus problem"></a>ring election protocol    consensus problem</h3><ul>
<li>elect highest id process as leader</li>
<li>received id &#x3D;&#x3D; this.id &#x3D;&gt; elected!!</li>
<li>whenever a new node joins, run the protocol<br>either become the new leader, or get the leader</li>
</ul>
<h3 id="fixing-for-failure"><a href="#fixing-for-failure" class="headerlink" title="fixing for failure"></a>fixing for failure</h3><ul>
<li>have predecessor&#x2F;successor detect failure</li>
<li>use the failure detector</li>
</ul>
<h3 id="bully-algorithm"><a href="#bully-algorithm" class="headerlink" title="bully algorithm"></a>bully algorithm</h3><ul>
<li>premise: all knows all</li>
<li>handle failures better</li>
</ul>
<h3 id="google-chubby"><a href="#google-chubby" class="headerlink" title="google chubby"></a>google chubby</h3><ul>
<li>quorum: voting set</li>
<li>master lease: time duration</li>
</ul>
<h3 id="apache-zookeeper"><a href="#apache-zookeeper" class="headerlink" title="apache zookeeper"></a>apache zookeeper</h3><ul>
<li>paxos: Zookeeper Atomic Broadcast</li>
</ul>
<h2 id="1031"><a href="#1031" class="headerlink" title="1031"></a>1031</h2><h3 id="transaction"><a href="#transaction" class="headerlink" title="transaction"></a>transaction</h3><ul>
<li>series of operations executed by client</li>
<li>each operation is a RPC to a server</li>
<li>either <strong>commit</strong> or <strong>abort</strong></li>
</ul>
<h3 id="atomicity"><a href="#atomicity" class="headerlink" title="atomicity"></a>atomicity</h3><ul>
<li>all or nothing; commit or abort</li>
<li>failure&#x2F;exception: roll back(undone)</li>
</ul>
<h3 id="consistency"><a href="#consistency" class="headerlink" title="consistency"></a>consistency</h3><ul>
<li>if the server starts in a consistent state, the transaction ends the server in a consistent state </li>
<li>Data is in a consistent state when a transaction starts and when it ends. For example, in an application that transfers funds from one account to another, the consistency property ensures that the total value of funds in both the accounts is the same at the start and end of each transaction.</li>
</ul>
<h3 id="isolation"><a href="#isolation" class="headerlink" title="isolation"></a>isolation</h3><ul>
<li>scenario: concurrency of transactions     </li>
<li>two transactions can not update the same object<br>one has to wait for the prior to commit</li>
</ul>
<ol>
<li>no access to intermediate result&#x2F;states of other transactions</li>
<li>free from interference by operations of other transactions</li>
</ol>
<h3 id="durability"><a href="#durability" class="headerlink" title="durability"></a>durability</h3><ul>
<li>transactions’effects are saved in permanent storage</li>
</ul>
<h3 id="multiple-servers-within-one-transaction-–-distributed-transaction"><a href="#multiple-servers-within-one-transaction-–-distributed-transaction" class="headerlink" title="multiple servers within one transaction – distributed transaction"></a>multiple servers within one transaction – distributed transaction</h3><ul>
<li>solution: 2-phase commit</li>
</ul>
<h3 id="lost-update-problem"><a href="#lost-update-problem" class="headerlink" title="lost update problem"></a>lost update problem</h3><ul>
<li>depending on how the server schedules, one of the update wil be lost</li>
<li>cause of problem: inconsistency, simultaneous access of a shared&amp;unsynchronized object; write-write conflict</li>
</ul>
<h3 id="inconsistent-retrieval-problem"><a href="#inconsistent-retrieval-problem" class="headerlink" title="inconsistent retrieval problem"></a>inconsistent retrieval problem</h3><h3 id="concurrent-transactions"><a href="#concurrent-transactions" class="headerlink" title="concurrent transactions"></a>concurrent transactions</h3><ul>
<li>transaction per second</li>
<li>goal: increase concurrency while maintaining correctness(ACID)</li>
</ul>
<h3 id="serial-amp-interleaving-schedule"><a href="#serial-amp-interleaving-schedule" class="headerlink" title="serial &amp; interleaving schedule"></a>serial &amp; interleaving schedule</h3><ul>
<li>serializability: T1,T2 &#x3D;&#x3D; T1.T2 or T2.T1</li>
<li>why: serial executions are most consistent</li>
</ul>
<h3 id="conflicting-operations"><a href="#conflicting-operations" class="headerlink" title="conflicting operations"></a>conflicting operations</h3><ul>
<li><p>same object: </p>
<ol>
<li>read write</li>
<li>write read</li>
<li>write write</li>
</ol>
</li>
<li><p>serially equivalent</p>
</li>
</ul>
<h3 id="prevent-violation-of-isolation"><a href="#prevent-violation-of-isolation" class="headerlink" title="prevent violation of isolation"></a>prevent violation of isolation</h3><ul>
<li><p>pessimistic</p>
<ol>
<li><p>exclusive locking</p>
<ol>
<li>before read&#x2F;write, lock(O)</li>
<li>either enter the lock or wait</li>
<li>when done, unlock(O)</li>
</ol>
<ul>
<li>improvement: exclusive locking is an overkill for read</li>
</ul>
</li>
<li><p>another approach: read&#x2F;write modes</p>
<ul>
<li>read_lock(O), write_lock(O), unlock(O)</li>
</ul>
</li>
</ol>
</li>
<li><p>optimistic</p>
<ol>
<li>check commit time&#x2F;serial equivalence</li>
</ol>
</li>
</ul>
<h3 id="two-phase-locking-protocol"><a href="#two-phase-locking-protocol" class="headerlink" title="two-phase locking protocol"></a>two-phase locking protocol</h3><ul>
<li>guarantee serial equivalence</li>
</ul>
<ol>
<li>growing phase: only acquires or promotes lock</li>
<li>shrinking phase: only release lock</li>
</ol>
<ul>
<li>drawback: deadlock</li>
<li>detect deadlocks in a wait-for graph</li>
</ul>
<h3 id="3-necessary-conditions-for-deadlock"><a href="#3-necessary-conditions-for-deadlock" class="headerlink" title="3 necessary conditions for deadlock"></a>3 necessary conditions for deadlock</h3><ol>
<li>Some objects are accessed in exclusive lock modes</li>
<li>Transactions holding locks cannotbe preempted</li>
<li>There is a circular wait (cycle) in the Wait-for graph</li>
</ol>
<h3 id="Coffman-conditions-if-all-four-simultaneously-x3D-gt-deadlock"><a href="#Coffman-conditions-if-all-four-simultaneously-x3D-gt-deadlock" class="headerlink" title="Coffman conditions    if all four simultaneously &#x3D;&gt; deadlock"></a>Coffman conditions    if all four simultaneously &#x3D;&gt; deadlock</h3><ol>
<li>mutual exlusion    resources</li>
<li>hold and wait      processes</li>
<li>no preemption      process holding resources</li>
<li>cirular wait</li>
</ol>
<h3 id="optimistic-lock"><a href="#optimistic-lock" class="headerlink" title="optimistic lock"></a>optimistic lock</h3><ul>
<li>example: dropbox</li>
<li>first-cut</li>
<li>ordering</li>
<li>multi-version concurrency control: svn</li>
</ul>
<h2 id="1102"><a href="#1102" class="headerlink" title="1102"></a>1102</h2><h3 id="distributed-system-mutual-exclusion"><a href="#distributed-system-mutual-exclusion" class="headerlink" title="distributed system mutual exclusion"></a>distributed system mutual exclusion</h3><ul>
<li><p>ATM<br>avoid WW conflicts, serial equivalence: false</p>
</li>
<li><p>distributed file systems<br>accessing objects in a safe and consistent way<br>server cooridination<br>in industry, Chubby, Apache Zookeeper</p>
</li>
<li><p>piece of code we ensure that there is at most one process executing it at any point of time</p>
</li>
<li><p><strong>critical section</strong> of the process</p>
<ol>
<li>enter()</li>
<li>accessResource()</li>
<li>exit()</li>
</ol>
</li>
</ul>
<h3 id="single-OS-process-synchronization"><a href="#single-OS-process-synchronization" class="headerlink" title="single OS: process synchronization"></a>single OS: process synchronization</h3><ul>
<li><p>semaphore</p>
<ul>
<li><p>signalling mechanism</p>
</li>
<li><p>an integer variable S, initialized with the number of resources available</p>
</li>
<li><p>only two functions can change its value: </p>
<ol>
<li>wait():</li>
</ol>
<ul>
<li>if S&gt;0: S–, accessResource()</li>
<li>if S&#x3D;&#x3D;0: wait</li>
</ul>
<ol>
<li>signal(): S++</li>
</ol>
</li>
</ul>
</li>
<li><p>mutex</p>
<ul>
<li>mutual exclusion object</li>
<li>locked-based technique</li>
<li>lock, use, release</li>
</ul>
</li>
</ul>
<h3 id="need-to-guarantee-3-properties"><a href="#need-to-guarantee-3-properties" class="headerlink" title="need to guarantee 3 properties"></a>need to guarantee 3 properties</h3><ol>
<li>safety(essential)<br>at most one at a time</li>
<li>liveness(essential)<br>all request for a CS is granted eventually</li>
<li>ordering(desirable)</li>
</ol>
<h3 id="distributed-system-central-solution"><a href="#distributed-system-central-solution" class="headerlink" title="distributed system: central solution"></a>distributed system: central solution</h3><ul>
<li>elect a central master(leader)</li>
<li>master keeps:<ol>
<li>a <strong>queue</strong> of waiting requests from processes</li>
<li>a special <strong>token</strong> which allows its holder to access CS</li>
</ol>
</li>
<li>any process in group:<ol>
<li>enter()<ul>
<li>send a request to master</li>
<li>wait for token from master</li>
</ul>
</li>
<li>exit()<ul>
<li>send back token</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="analyzing-performance-metrics"><a href="#analyzing-performance-metrics" class="headerlink" title="analyzing performance   metrics"></a>analyzing performance   metrics</h3><ul>
<li>bandwidth</li>
<li>client delay</li>
<li>synchronization delay</li>
</ul>
<h3 id="ring-based-mutual-exlusion"><a href="#ring-based-mutual-exlusion" class="headerlink" title="ring based mutual exlusion"></a>ring based mutual exlusion</h3><ul>
<li>safety: yes</li>
<li>liveness: yes</li>
<li>ordering: no<br>the nature of ring topology</li>
</ul>
<h3 id="Ricart-Agrawala’s-Algorithm"><a href="#Ricart-Agrawala’s-Algorithm" class="headerlink" title="Ricart-Agrawala’s Algorithm"></a>Ricart-Agrawala’s Algorithm</h3><ul>
<li>premise: reliable all-to-all communication</li>
<li>no token</li>
<li>uses the notion of causality and multicast<br>send messages of <strong>&lt;timestamp, process id&gt;</strong></li>
<li>lowing waiting time to enter CS</li>
<li>state<ul>
<li>wanted</li>
<li>held</li>
<li>released</li>
</ul>
</li>
</ul>
<h3 id="Maekawa’s-Algorithm"><a href="#Maekawa’s-Algorithm" class="headerlink" title="Maekawa’s Algorithm"></a>Maekawa’s Algorithm</h3><ul>
<li>voting set(<strong>quorum</strong>)</li>
<li>safety but not liveness</li>
</ul>
<h2 id="1107"><a href="#1107" class="headerlink" title="1107"></a>1107</h2><h3 id="replication-control"><a href="#replication-control" class="headerlink" title="replication control"></a>replication control</h3><ul>
<li>example: airline booking system</li>
<li>one client, query which one of multiple servers</li>
<li>multiple clients, coordinations; concurrency</li>
</ul>
<h3 id="why-replication-x3D-gt-higher-availability"><a href="#why-replication-x3D-gt-higher-availability" class="headerlink" title="why replication &#x3D;&gt; higher availability"></a>why replication &#x3D;&gt; higher availability</h3><ol>
<li>fault-tolerance</li>
<li>load balancing</li>
</ol>
<h3 id="availability-vs-reliability"><a href="#availability-vs-reliability" class="headerlink" title="availability vs reliability"></a>availability vs reliability</h3><ul>
<li><p>availability: </p>
<ol>
<li>The <strong>percentage of time</strong> that the infrastructure, system, or solution is <strong>operational</strong> under normal circumstances.</li>
<li>Percentage of availability &#x3D; (total elapsed time – sum of downtime)&#x2F;total elapsed time</li>
</ol>
</li>
<li><p>reliability: </p>
<ol>
<li>The <strong>probability</strong> that the system will meet certain performance standards and <strong>yield correct output</strong> for a specific time.</li>
<li><strong>Mean Time Betwen Failures</strong></li>
<li>MTBF &#x3D; (total elapsed time – sum of downtime)&#x2F;number of failures</li>
</ol>
</li>
<li><p>The measurement of Availability is driven by <strong>time loss</strong> whereas the measurement of Reliability is driven by the <strong>frequency and impact of failures</strong>. </p>
</li>
<li><p>Mathematically, the Availability of a system can be treated as a function of its Reliability. In other words, Reliability can be considered <strong>a subset of Availability</strong>.</p>
</li>
</ul>
<h3 id="maintain-two-properties"><a href="#maintain-two-properties" class="headerlink" title="maintain two properties"></a>maintain two properties</h3><ol>
<li><p>replication <strong>consistency</strong></p>
<ul>
<li>All clients see single consistent copy of data, in spite of replication</li>
<li>For transactions, ACID</li>
<li>achieved by passive&#x2F;active replication</li>
</ul>
</li>
<li><p>replication <strong>transparency</strong></p>
<ul>
<li>transparent to a single client</li>
<li>achieved by FEs</li>
</ul>
</li>
</ol>
<h3 id="replication-consistency"><a href="#replication-consistency" class="headerlink" title="replication consistency"></a>replication consistency</h3><ul>
<li>two ways to forward updates from front-ends to replica group<ol>
<li>passive replication<ol>
<li>leader election, select a primary replica (master)</li>
<li>FEs send request to the master</li>
</ol>
</li>
<li>active replication <ul>
<li>treats all replicas indentically</li>
</ul>
</li>
</ol>
</li>
<li>both approaches: <strong>replicated state machine</strong></li>
</ul>
<h3 id="passive-replication"><a href="#passive-replication" class="headerlink" title="passive replication"></a>passive replication</h3><ul>
<li>election: ring, bully, Google Chubby</li>
</ul>
<h3 id="active-replication"><a href="#active-replication" class="headerlink" title="active replication"></a>active replication</h3><ul>
<li>FEs send multicast requests: gossip</li>
<li>multicast ordering:<ol>
<li>FIFO</li>
<li>causal ordering, Lamport timestamp</li>
<li>total ordering<ul>
<li>object-based: timestamp, size, etc</li>
</ul>
</li>
<li>hybrid ordering</li>
</ol>
</li>
</ul>
<h3 id="one-copy-serializability"><a href="#one-copy-serializability" class="headerlink" title="one-copy serializability"></a>one-copy serializability</h3><ul>
<li>a concurrent execution of transactions equivalent to a serial execution of these transactions</li>
<li>one-copy: results should be consistent&#x2F;the same: doesn’t matter if I execute a, or b, or both</li>
<li>if non-replication: just order the concurrent transactions; ensure <strong>correctness</strong></li>
<li>when replicated:</li>
</ul>
<h3 id="distributed-transactions"><a href="#distributed-transactions" class="headerlink" title="distributed transactions"></a>distributed transactions</h3><ul>
<li>transaction: sequence of R&#x2F;W operations</li>
<li>main challenge: maintain ACID, especially Atomiciy</li>
<li>atomic commit problem:<ol>
<li>commit itself is distributed</li>
<li>make sure commit itself is atomic</li>
</ol>
</li>
</ul>
<h3 id="one-phase-commit-not-usable"><a href="#one-phase-commit-not-usable" class="headerlink" title="one-phase commit    not usable"></a>one-phase commit    not usable</h3><ul>
<li>special server called coordinator, which initiates atomic commit</li>
<li>tell other servers to either commit or abort</li>
<li>why not usable<ol>
<li>one-way communication<br>server has no say(can not time out), just coordinator telling servers what to do</li>
<li>server may crash before receiving commit message</li>
</ol>
</li>
</ul>
<h3 id="two-phase-commit"><a href="#two-phase-commit" class="headerlink" title="two-phase commit"></a>two-phase commit</h3><ol>
<li>coordinator prepared to save</li>
<li>servers respond with yes&#x2F;no</li>
<li>coordinator decides whether commit or abort</li>
</ol>
<h3 id="two-phase-commit-failures"><a href="#two-phase-commit-failures" class="headerlink" title="two-phase commit failures:"></a>two-phase commit failures:</h3><ol>
<li>server crashes<br>save tentative updates into permanent storage right before replying yes&#x2F;no</li>
<li>coordinator crashes:<br>log all decisions and received messages on disk</li>
<li>message loss: <strong>pessimistic</strong><ol>
<li>prepare message loss</li>
<li>yes&#x2F;no message loss</li>
<li>commit&#x2F;abort</li>
</ol>
</li>
</ol>
<h2 id="1109"><a href="#1109" class="headerlink" title="1109"></a>1109</h2><h3 id="distributed-systems-snapshots"><a href="#distributed-systems-snapshots" class="headerlink" title="distributed systems snapshots"></a>distributed systems snapshots</h3><ul>
<li>example:<br>transactions, take a global snapshot to construct the weight-for graph</li>
<li>distributed system global snapshot:<ol>
<li>process state</li>
<li>communiation channel<br><em>two main parts of distributed system: hosts and communications</em></li>
</ol>
</li>
</ul>
<h3 id="uses-of-having-a-global-picture"><a href="#uses-of-having-a-global-picture" class="headerlink" title="uses of having a global picture"></a>uses of having a global picture</h3><ol>
<li>checkpointing: can restart distributed application on failure</li>
<li>garbage collection: objects at servers that don’t have any other objects at any servers with pointers to them</li>
<li>deadlock detection: useful in database transaction systems</li>
<li>termination of computation: useful in batch computing systems</li>
</ol>
<h3 id="how-to-take-a-global-snapshot"><a href="#how-to-take-a-global-snapshot" class="headerlink" title="how to take a global snapshot"></a>how to take a global snapshot</h3><ul>
<li><p>obvious first solution</p>
<ol>
<li>synchronize clocks of all processes</li>
<li>then ask all processes to record their states at known time t</li>
</ol>
</li>
<li><p>problems:</p>
<ol>
<li>time synchronization always has error  <strong>clock skew</strong></li>
<li>also, doesn’t record the state of messages in the channels</li>
</ol>
</li>
<li><p>again: synchronization is not required! causality is enough!<br>(global) state to state movement obeys causality</p>
<ol>
<li>process receives message</li>
<li>process sends message</li>
<li>proces takes a step</li>
</ol>
</li>
</ul>
<h3 id="system-model"><a href="#system-model" class="headerlink" title="system model"></a>system model</h3><h3 id="requirements"><a href="#requirements" class="headerlink" title="requirements"></a>requirements</h3><ol>
<li>snapshot should not interfere with normal applcation actions&#x2F;sending messages</li>
<li>each process is able to record its own state<br>its heap, registers, program counter, code, etc (<strong>coredump</strong>)</li>
<li>global state is collected in a distributed manner</li>
<li>any process may initiate the snapshot</li>
</ol>
<h3 id="Chandy-Lamport-global-snapshot-algorithm"><a href="#Chandy-Lamport-global-snapshot-algorithm" class="headerlink" title="Chandy-Lamport global snapshot algorithm"></a>Chandy-Lamport global snapshot algorithm</h3><ul>
<li>initiator process records its own state</li>
<li>create and send <strong>Marker</strong> messages to all other processes via outgoing channels<br>turn on recording on all incoming channels</li>
<li>other processes start recording on each of the incoming channels<ul>
<li>if first marker message:<ol>
<li>record its own state</li>
<li>mark incoming channel as emtpy (<strong>&lt;&gt;</strong>)</li>
<li>turn on recording on other incoming channels</li>
<li>send out markers</li>
</ol>
</li>
<li>already seen a marker message:<ol>
<li>k: sender; i: receiver</li>
<li>mark the state of channel Cki as all the messages that have arrived on it since recording was turned on for Cki</li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="consistent-cut"><a href="#consistent-cut" class="headerlink" title="consistent cut"></a>consistent cut</h3><ul>
<li><p>cut: time frontier at each process and at each channel</p>
<ul>
<li>in the cut</li>
<li>out of the cut</li>
</ul>
</li>
<li><p>consistent cut: a cut that obeys causality<br>event e in cut C; f happens before e (f-&gt;e)<br>then event f is also in the cut C</p>
</li>
<li><p>any run of the Chandy-Lamport gloabal snapshot algorithm creates a consistent cut</p>
</li>
</ul>
<h3 id="correctness-in-distributed-systems"><a href="#correctness-in-distributed-systems" class="headerlink" title="correctness in distributed systems"></a>correctness in distributed systems</h3><ul>
<li>liveness:<br>guarantee that something good will happen, eventually<br>eventually: does not imply a time bound, but if you let the system run long enough, then…<ul>
<li>examples:<ol>
<li>distributed computation: guarantee that it will terminate</li>
<li>completeness in failure detectors: every failure is eventually detected by some non-faulty process</li>
<li>consensus (election, Google Chubby): all processes eventually decide on a value</li>
</ol>
</li>
</ul>
</li>
<li>safety:<br>guarantee that something bad will never happen<ul>
<li>examples:<ol>
<li>there is no deadlock in a distributed system</li>
<li>no object is orphaned in a distributed system</li>
<li>accuracy in failure detectors</li>
<li>in consensus: no two processes decide on different values</li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="stable-properties"><a href="#stable-properties" class="headerlink" title="stable properties"></a>stable properties</h3><ul>
<li>stable: once true, stays true forever afterwards</li>
<li>all stable properties can be detected using the Chandy-Lamport algorithm</li>
</ul>
<h2 id="1114"><a href="#1114" class="headerlink" title="1114"></a>1114</h2><h3 id="file-system"><a href="#file-system" class="headerlink" title="file system"></a>file system</h3><ul>
<li>higher level of abstraction</li>
<li>file contents:<ol>
<li>header:<ol>
<li>timestamps</li>
<li>file type</li>
<li>ownership</li>
<li>access control list</li>
<li>reference count: number of directories containing this file</li>
</ol>
</li>
<li>blocks</li>
</ol>
</li>
<li>directory</li>
</ul>
<h3 id="unix-file-system-local-methods"><a href="#unix-file-system-local-methods" class="headerlink" title="unix file system  local methods"></a>unix file system  local methods</h3><ul>
<li>file descriptors<ol>
<li>open</li>
<li>creat</li>
<li>close</li>
</ol>
</li>
<li>read-write pointer<ol>
<li>read</li>
<li>write</li>
<li>lseek</li>
</ol>
</li>
<li>status<ol>
<li>link</li>
<li>unlink</li>
<li>stat&#x2F;fstat</li>
</ol>
</li>
</ul>
<h3 id="distributed-file-systems"><a href="#distributed-file-systems" class="headerlink" title="distributed file systems"></a>distributed file systems</h3><ol>
<li>transparency</li>
<li>support concurrent clients</li>
<li>replcation: fault-tolerance</li>
</ol>
<ul>
<li>idempotent</li>
<li>stateless</li>
</ul>
<h3 id="security"><a href="#security" class="headerlink" title="security"></a>security</h3><ol>
<li>autentication</li>
<li>authorization:<ol>
<li>Access Control Lists, per file</li>
<li>Capability Lists, per user</li>
</ol>
</li>
</ol>
<h3 id="why-DFS-not-using-file-descriptors"><a href="#why-DFS-not-using-file-descriptors" class="headerlink" title="why DFS not using file descriptors?"></a>why DFS not using file descriptors?</h3><ol>
<li>transparency: client should not know the absolute position of the file</li>
<li>confusion: a file may be replicated across multiple servers, each having a file descriptor</li>
</ol>
<h3 id="Network-File-System"><a href="#Network-File-System" class="headerlink" title="Network File System"></a>Network File System</h3><ul>
<li><p>virtual file system: provide transparency</p>
<ul>
<li>local unix file system, if file is local</li>
<li>NFS client system, if file is not local<ul>
<li>do RPCs</li>
</ul>
</li>
</ul>
</li>
<li><p>server: exportfs</p>
</li>
<li><p>client: mount</p>
<ul>
<li>not clone, but hook(point to)</li>
<li>unlink dropbox, where file is local</li>
</ul>
</li>
</ul>
<h3 id="why-not-clone"><a href="#why-not-clone" class="headerlink" title="why not clone?"></a>why not clone?</h3><ul>
<li>replcation: consistency</li>
</ul>
<h3 id="virtual-file-system-module"><a href="#virtual-file-system-module" class="headerlink" title="virtual file system module"></a>virtual file system module</h3><ul>
<li>allow processes to access files via file descriptors</li>
<li>transparency: local and romote files look the same</li>
<li>“NFS file handles”</li>
<li>v-node</li>
</ul>
<h3 id="server-optimizations"><a href="#server-optimizations" class="headerlink" title="server optimizations"></a>server optimizations</h3><ul>
<li><p>server caching: locality of access</p>
</li>
<li><p>writes: two flavors</p>
<ol>
<li>delayed write:</li>
</ol>
<ul>
<li>write in memory, flush to disk every 30s</li>
<li>non-blocking</li>
<li>fast but not consistent</li>
</ul>
<ol start="2">
<li>write-through</li>
</ol>
<ul>
<li>blocking</li>
<li>consistent but may be slow(latency)</li>
</ul>
</li>
</ul>
<h3 id="client-optimization"><a href="#client-optimization" class="headerlink" title="client optimization"></a>client optimization</h3><ul>
<li>client caching</li>
<li>cache recently-accessed blocks</li>
<li>when block is written, do a delayed-write to server</li>
<li>compromise between consistency and efficiency</li>
</ul>
<h3 id="AFS"><a href="#AFS" class="headerlink" title="AFS"></a>AFS</h3><ul>
<li>whole file serving</li>
<li>whole file caching</li>
</ul>
<h2 id="1116"><a href="#1116" class="headerlink" title="1116"></a>1116</h2><h3 id="security-threats"><a href="#security-threats" class="headerlink" title="security threats"></a>security threats</h3><ol>
<li>leakage</li>
<li>tampering</li>
<li>vandalism</li>
</ol>
<h3 id="common-attacks"><a href="#common-attacks" class="headerlink" title="common attacks"></a>common attacks</h3><ol>
<li>eavesdropping: taps into network</li>
<li>masquerading: pretend</li>
<li>message tampering: modify</li>
<li>replay attack</li>
<li>denial of service: bombard a port</li>
</ol>
<h3 id="CIA-properties"><a href="#CIA-properties" class="headerlink" title="CIA properties"></a>CIA properties</h3><ul>
<li>confidentiality</li>
<li>integrity</li>
<li>availability</li>
</ul>
<h3 id="separate-policy-from-mechanism"><a href="#separate-policy-from-mechanism" class="headerlink" title="separate policy from mechanism"></a>separate policy from mechanism</h3><ul>
<li>policy: what’s the goal</li>
<li>mechanism: how the goal is accomplished</li>
</ul>
<h3 id="Mechanisms-Golden-A’s"><a href="#Mechanisms-Golden-A’s" class="headerlink" title="Mechanisms: Golden A’s"></a>Mechanisms: Golden A’s</h3><ul>
<li>authentication:<br>is a user claiming to be Alice, really Alice?</li>
<li>authorization:<br>Yes, it is Alice, but is Alice allowed to perfrom the requested operation?</li>
<li>auditing:<br>How did Eve manage to attack the system and breach defenses?<br>Usually done by continuously logging all operations.<br>No attack should go unnoticed!</li>
</ul>
<h3 id="designing-secure-systems"><a href="#designing-secure-systems" class="headerlink" title="designing secure systems"></a>designing secure systems</h3><ul>
<li>don’t know how powerful attacker is</li>
<li>when designing a secruity protocol, need to:<ol>
<li>specify <strong>Attacker Model</strong><br>capabilities of attacker; tied to reality, no imagination<ul>
<li>study</li>
</ul>
</li>
<li>design security mechanisms to satisfy policy under the attacker model<ul>
<li>engineers implement the mechanisms</li>
</ul>
</li>
<li>prove that mechanisms satisfy policy under attacker model<ul>
<li>a second organization may come into play, try to attack</li>
</ul>
</li>
<li>measure effect on overall performance in the common ase, i.e., no attacks<br>compare: <ul>
<li>no-security-control throughput</li>
<li>throughput with security control</li>
</ul>
</li>
</ol>
</li>
<li>security is not a one-time deal!</li>
</ul>
<h3 id="basic-cryptography"><a href="#basic-cryptography" class="headerlink" title="basic cryptography"></a>basic cryptography</h3><ul>
<li>key: <ul>
<li>sequence of bytes assigned to a user</li>
<li>can be used to lock a message, and only this key can be used to unlock that locked message</li>
</ul>
</li>
</ul>
<h3 id="encryption"><a href="#encryption" class="headerlink" title="encryption"></a>encryption</h3><ul>
<li>encrypted message &#x3D; encrypt(original message, key) </li>
<li>decrypted message &#x3D; decrypt(encrypted message, key)</li>
</ul>
<h3 id="two-cryptography-systems"><a href="#two-cryptography-systems" class="headerlink" title="two cryptography systems"></a>two cryptography systems</h3><ol>
<li><p>symmetric key systems: DES</p>
<ul>
<li>shared keys</li>
<li>hard to revoke permissions from principals</li>
</ul>
</li>
<li><p>public-private key systems: RSA, PGP</p>
<ul>
<li>private key</li>
<li>public key: known to all</li>
<li>anything encrypted with Kapriv can be decrypted only with Kapub</li>
<li>anything encrypted with Kapub can be decrypted only with Kapriv</li>
<li>relatively costly: 2 operations, at least one is costly</li>
</ul>
</li>
<li><p>combination: use public-private key system to generate shared key</p>
</li>
</ol>
<h3 id="authentication"><a href="#authentication" class="headerlink" title="authentication"></a>authentication</h3><ul>
<li>direct authentication</li>
<li>indirect authentication: uses a trusted third-party server, authentication server</li>
</ul>
<h3 id="digital-signatures"><a href="#digital-signatures" class="headerlink" title="digital signatures"></a>digital signatures</h3><ul>
<li>between two parties</li>
<li>SHA-1, MD-5</li>
</ul>
<h3 id="digital-certificates"><a href="#digital-certificates" class="headerlink" title="digital certificates"></a>digital certificates</h3><ul>
<li>transitivity: chains of certificates</li>
<li>trace back</li>
</ul>
<h3 id="authorization"><a href="#authorization" class="headerlink" title="authorization"></a>authorization</h3><ul>
<li><p>Access Control Matrix</p>
</li>
<li><p>Access Control Lists, per file&#x2F;object</p>
</li>
<li><p>Capability Lists, per user&#x2F;principal</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://invincible-nerd.github.io/2022/12/04/COEN317-midterm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="invincible-nerd">
      <meta itemprop="description" content="For explorer everywhere">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IVN">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/04/COEN317-midterm/" class="post-title-link" itemprop="url">COEN317_midterm</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-04 22:20:28" itemprop="dateCreated datePublished" datetime="2022-12-04T22:20:28+08:00">2022-12-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-12-05 14:23:16" itemprop="dateModified" datetime="2022-12-05T14:23:16+08:00">2022-12-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>12k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>11 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="midterm-review"><a href="#midterm-review" class="headerlink" title="midterm review"></a>midterm review</h1><h2 id="Chap-1-Intro"><a href="#Chap-1-Intro" class="headerlink" title="Chap 1   Intro"></a>Chap 1   Intro</h2><h3 id="what’s-a-distributed-system"><a href="#what’s-a-distributed-system" class="headerlink" title="what’s a distributed system"></a>what’s a distributed system</h3><ul>
<li>definitions: <ol>
<li>a collection of independent computers that appears to users as a single coherent system</li>
<li>a collection of autonomous computers linked by a computer network and supported by software that enables the collection to operate as an integrated facility</li>
<li>crash you never heard of stops you from getting work done</li>
</ol>
</li>
<li><strong>types:</strong></li>
</ul>
<h3 id="what-do-we-want-from-distributed-system"><a href="#what-do-we-want-from-distributed-system" class="headerlink" title="what do we want from distributed system"></a>what do we want from distributed system</h3><ul>
<li><p>resource sharing: </p>
<ol>
<li>Quality of Service, trade-offs</li>
</ol>
</li>
<li><p>transparency: information hiding applied to distributed systems</p>
<ol>
<li>hiding different aspects of distribution from clients</li>
<li>make the system more user friendly</li>
<li>appears to users and applications as a single computer system</li>
<li>users&#x2F;apps should be able to access remote resources the same way they access local resources</li>
</ol>
<ul>
<li>types:<ol>
<li>access: hide differences in data representation and how a resource is accessed</li>
<li>location: hide where a resource is located</li>
<li>migration: hide that a resource may move to another location</li>
<li>relocation: hide that a resource may be moved to another location while in use</li>
<li>replication: hide that a resource is replicated</li>
<li>concurrency: hide that a resource may be shared by several competitive users</li>
<li>failure: hide the failure and recovery of a resource</li>
</ol>
</li>
</ul>
</li>
<li><p>openness:</p>
<ul>
<li>offer services according to standard rules</li>
<li>In other words, the interfaces to the system are clearly specified and freely available</li>
<li>formalized in protocols, not proprietary</li>
<li>definitions are language and machine independent    interoperate</li>
<li><strong>separating policy from mechanism</strong></li>
</ul>
</li>
<li><p>scalability: able to grow to meet increasing demands </p>
<ol>
<li>3 dimensions of scalability</li>
</ol>
<ul>
<li>size: users&#x2F;resources<ul>
<li>performance bottlneck: centralized server, data, algorithms</li>
</ul>
</li>
<li>geographically: topologically<ul>
<li>LAN: synchronous, fast ,reliable</li>
<li>WAN: asynchronous, slow, unreliable</li>
</ul>
</li>
<li><strong>administratively</strong>: independent organizations&#x2F;domains</li>
</ul>
<ol start="2">
<li>vertical horizontal</li>
<li>problems:</li>
</ol>
<ul>
<li>trade-off: scalability, security</li>
</ul>
<ol start="4">
<li>scaling techniques</li>
</ol>
<ul>
<li>caching: proximity, client decision</li>
<li>replicate: consistency vs scalability</li>
<li>asynchronous: hiding communication latency</li>
<li>synchronous</li>
<li>hierachies, domains, zones     split</li>
</ul>
</li>
</ul>
<h3 id="elements-of-distributed-system"><a href="#elements-of-distributed-system" class="headerlink" title="elements of distributed system"></a>elements of distributed system</h3><ul>
<li>networks</li>
<li>hosts</li>
<li>middleware</li>
</ul>
<h3 id="architecture-styles"><a href="#architecture-styles" class="headerlink" title="architecture styles"></a>architecture styles</h3><ul>
<li><p>describe a particular way to configure a collection of components and connectors</p>
</li>
<li><p>layered</p>
</li>
<li><p>object-based: object + RPC&#x2F;RMI</p>
</li>
<li><p>event&#x2F;publish-subscribe: </p>
<ul>
<li>publish to event bus &#x3D;&gt; event bus delivers</li>
<li>asynchronous communciation, decouples senders&amp;receivers</li>
</ul>
</li>
<li><p>shared data-space: </p>
<ul>
<li>publish to shared persistent data space &#x3D;&gt; data space delivers</li>
</ul>
</li>
<li><p>client&#x2F;server model:</p>
<ul>
<li>user-interface level: GUI</li>
<li>processing level: core functionality</li>
<li>data level: interacts with database or file system</li>
<li>two-tiered: <ul>
<li>thin-client: GUI</li>
<li>fat-client: user interface + processing + some data</li>
</ul>
</li>
<li>three-tiered:<ul>
<li>application server acting as a client</li>
<li>client &#x3D;&gt; middleware &#x3D;&gt; resource management server</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="various-configurations-of-distributed-systems"><a href="#various-configurations-of-distributed-systems" class="headerlink" title="various configurations of distributed systems"></a>various configurations of distributed systems</h3><h3 id="example-distributed-systems"><a href="#example-distributed-systems" class="headerlink" title="example distributed systems"></a>example distributed systems</h3><h2 id="Chap-2-3-Communications-Foudamentals"><a href="#Chap-2-3-Communications-Foudamentals" class="headerlink" title="Chap 2,3   Communications  Foudamentals"></a>Chap 2,3   Communications  Foudamentals</h2><h3 id="packets"><a href="#packets" class="headerlink" title="packets"></a>packets</h3><ul>
<li>segment &#x3D; original data + transport layer header</li>
<li>packet &#x3D; segment + network layer header</li>
<li>fram &#x3D; packet + data link layer header</li>
</ul>
<h3 id="protocols"><a href="#protocols" class="headerlink" title="protocols"></a>protocols</h3><ul>
<li>connection-oriented: setup of communication first</li>
<li>connectionless: no setup of communication</li>
<li>application-specific vs application-independent</li>
</ul>
<h3 id="blocking-x2F-unblocking-communication-calls"><a href="#blocking-x2F-unblocking-communication-calls" class="headerlink" title="blocking&#x2F;unblocking communication calls"></a>blocking&#x2F;unblocking communication calls</h3><ul>
<li>blocking: process&#x2F;thread execution is suspended until transmission finishes</li>
<li>unblocking: execution continues without waiting for the finish of the transmission</li>
</ul>
<h3 id="layering"><a href="#layering" class="headerlink" title="layering"></a>layering</h3><ul>
<li>do I need other intermediators to relay the message?</li>
</ul>
<h3 id="layered-protocols"><a href="#layered-protocols" class="headerlink" title="layered protocols"></a>layered protocols</h3><h3 id="application-layering"><a href="#application-layering" class="headerlink" title="application layering"></a>application layering</h3><h3 id="communication-between-processes"><a href="#communication-between-processes" class="headerlink" title="communication between processes"></a>communication between processes</h3><h3 id="middleware-and-application-protocols"><a href="#middleware-and-application-protocols" class="headerlink" title="middleware and application protocols"></a>middleware and application protocols</h3><ul>
<li>application layer protocols</li>
<li>between application and transport: middleware</li>
<li>program and network layer</li>
</ul>
<h3 id="layered-network-models"><a href="#layered-network-models" class="headerlink" title="layered network models"></a>layered network models</h3><ul>
<li><p>OSI 7-layer model     Open System Interconnection</p>
<ul>
<li>application: support application-specific needs</li>
<li>presentation: process information format and deliver(serialize and encrypt)</li>
<li>session: manage communication sessions among applications</li>
<li>transport: end-to-end communication for applications</li>
<li>network: route data packets among senders&#x2F;receivers</li>
<li>data link: send, detect and correct data frames(units of bits)</li>
<li>physical: transfer bits over physical interfaces(fiber optics)</li>
</ul>
</li>
<li><p>TCP&#x2F;IP 4-layer</p>
<ul>
<li>application: SMTP,HTTP,FTP,Telnet</li>
<li>transport: UCP,TCP</li>
<li>network: IP</li>
<li>link: most network hardware   Ethernet&#x2F;fiber&#x2F;satellite</li>
</ul>
</li>
<li><p>Ethernet: local area network</p>
</li>
<li><p>Inter-network Protocols       IP</p>
<ul>
<li>define datagram as the basic data unit</li>
<li>define the internet address schema</li>
<li>routes datagrams to destinations</li>
<li>divides and assembles datagrams</li>
</ul>
</li>
</ul>
<h3 id="addressing-and-routing"><a href="#addressing-and-routing" class="headerlink" title="addressing and routing"></a>addressing and routing</h3><ul>
<li>TCP<ul>
<li>Transmission Control Protocol</li>
<li>data sent via streams of bytes</li>
</ul>
</li>
<li>UDP<ul>
<li>User Datagram Protocol</li>
<li>data sent in messages</li>
</ul>
</li>
<li>communication ports and sockets</li>
</ul>
<h3 id="multicast-more-than-one-recipient"><a href="#multicast-more-than-one-recipient" class="headerlink" title="multicast : more than one recipient"></a>multicast : more than one recipient</h3><h3 id="client-x2F-server-communication-protocols"><a href="#client-x2F-server-communication-protocols" class="headerlink" title="client&#x2F;server communication protocols"></a>client&#x2F;server communication protocols</h3><h3 id="processing-multiple-requests"><a href="#processing-multiple-requests" class="headerlink" title="processing multiple requests"></a>processing multiple requests</h3><ul>
<li>iterative processing:<br>receive &#x3D;&gt; process &#x3D;&gt; return result &#x3D;&gt; wait for new</li>
<li>concurrent processing:<br>receive &#x3D;&gt; ask another to process &#x3D;&gt; wait for new<br>                      process &#x3D;&gt; return result</li>
<li>using replicated processes</li>
<li>using multiple threads</li>
<li>using message brokers&#x2F;space repository</li>
</ul>
<h3 id="communication-types"><a href="#communication-types" class="headerlink" title="communication types"></a>communication types</h3><ul>
<li>transient: messages are kept in the communication temporarily only if both the sender and the receiver are live</li>
<li>persistent: messages are kept in the communciation system until they are delivered to the receiver</li>
<li>synchronous: <ul>
<li>the sender waits until it knows the messages have been delivered to the receiver</li>
<li>blocking send&#x2F;receive</li>
</ul>
</li>
<li>asynchronous: <ul>
<li>the process continues as soon as sending messages have been copied to the local buffer    </li>
<li>non-blocking send</li>
<li>callback mechanisms</li>
</ul>
</li>
</ul>
<h3 id="stateful-x2F-stateless-server"><a href="#stateful-x2F-stateless-server" class="headerlink" title="stateful&#x2F;stateless server"></a>stateful&#x2F;stateless server</h3><ul>
<li>keep clients’ state information</li>
</ul>
<h2 id="Chap-4-5-6-9-Commuications-Programming"><a href="#Chap-4-5-6-9-Commuications-Programming" class="headerlink" title="Chap 4,5,6,9 Commuications     Programming"></a>Chap 4,5,6,9 Commuications     Programming</h2><h3 id="ports"><a href="#ports" class="headerlink" title="ports"></a>ports</h3><h3 id="sockets"><a href="#sockets" class="headerlink" title="sockets"></a>sockets</h3><ul>
<li>how does an application use the transport layer communciation to send&#x2F;receive messages?   Transport-level socket programming via socket interface</li>
<li>socket interface: socket APIs</li>
<li>what is a socket: a communication end point to&#x2F;from which an application can send&#x2F;receive data through the underlying network</li>
<li>message-oriented transient communication at transport level</li>
<li>client: connect, send, receive</li>
<li>server: bind, listen&#x2F;accept, recieve, process, send</li>
</ul>
<h3 id="binding"><a href="#binding" class="headerlink" title="binding"></a>binding</h3><ul>
<li>attach a local address to a socket</li>
</ul>
<h3 id="datagram-sockets"><a href="#datagram-sockets" class="headerlink" title="datagram sockets"></a>datagram sockets</h3><h3 id="UDP-User-Datagram-Protocol"><a href="#UDP-User-Datagram-Protocol" class="headerlink" title="UDP   User Datagram Protocol"></a>UDP   User Datagram Protocol</h3><h3 id="locating-resources-on-the-network"><a href="#locating-resources-on-the-network" class="headerlink" title="locating resources on the network"></a>locating resources on the network</h3><h3 id="network-programming-sockets"><a href="#network-programming-sockets" class="headerlink" title="network programming: sockets"></a>network programming: sockets</h3><h3 id="socket-programming-with-TCP"><a href="#socket-programming-with-TCP" class="headerlink" title="socket programming with TCP"></a>socket programming with TCP</h3><h3 id="models-for-application-communications"><a href="#models-for-application-communications" class="headerlink" title="models for application communications"></a>models for application communications</h3><ul>
<li>RPC, remote procedure call<ul>
<li>asynchronous RPC:<ol>
<li>synchronize at request submission</li>
<li>synchronize at request delivery</li>
</ol>
</li>
<li>synchronous RPC:<ol>
<li>synchronize after processed by server</li>
</ol>
</li>
</ul>
</li>
<li>message-oriented communication<ul>
<li>transient   socket</li>
<li>persistent  message-queuing<ul>
<li>time uncoupling</li>
</ul>
</li>
</ul>
</li>
<li>stream-oriented communication</li>
<li>multicast communication</li>
</ul>
<h3 id="remote-objects-and-RMI"><a href="#remote-objects-and-RMI" class="headerlink" title="remote objects and RMI"></a>remote objects and RMI</h3><ul>
<li>distributed&#x2F;remote objects</li>
<li>RMI, Remote Method Invocation</li>
</ul>
<h3 id="web-services"><a href="#web-services" class="headerlink" title="web services"></a>web services</h3><ul>
<li>architecture</li>
<li>REST<ol>
<li>resources are identified and accessed through URIs</li>
<li>resources are data and functionality</li>
<li>a web service manages a set of resources</li>
<li>a client and a service exchange representation of resources via standardized interface and protocols</li>
</ol>
</li>
<li>cloud computing&#x2F; cloud resources: file, storage, compute machine, middleware</li>
</ul>
<h3 id="stream-data-programming"><a href="#stream-data-programming" class="headerlink" title="stream data programming"></a>stream data programming</h3><ul>
<li>data stream: a sequence of data units<br>reading bytes from a file and sending bytes via a TCP socket</li>
<li>can be used for: <ol>
<li>continuous media: video</li>
<li>discrete media: stock market events&#x2F;twitter events</li>
</ol>
</li>
<li>timing issues   transmission modes<ol>
<li>asynchronous: no contraints of delay(when the transmission completes)</li>
<li>synchronous: maximum end-to-end delay defined for each data unit</li>
<li>iochronous: maximum and minimum delay defined</li>
</ol>
</li>
</ul>
<h3 id="group-communication"><a href="#group-communication" class="headerlink" title="group communication"></a>group communication</h3><ul>
<li><p>use multicast messages</p>
<ol>
<li>IP multicast</li>
<li>application-level multicast</li>
</ol>
<ul>
<li>application processes are organized into an overlay network, in mesh or tree</li>
</ul>
</li>
<li><p>atomic multicast: messages are received either by every memeber or by none of them</p>
</li>
<li><p>reliable multicast: messages are delivered to all members in the best effort, but not guaranteed</p>
</li>
</ul>
<h3 id="gossip-based-communication"><a href="#gossip-based-communication" class="headerlink" title="gossip based communication"></a>gossip based communication</h3><ul>
<li>why? It can spread messages fast and reliably.</li>
<li>periodically transmit to b random targets</li>
<li>other nodes do same after receiving multicast</li>
</ul>
<h2 id="Chap-10-Naming"><a href="#Chap-10-Naming" class="headerlink" title="Chap 10 Naming"></a>Chap 10 Naming</h2><h3 id="definitions"><a href="#definitions" class="headerlink" title="definitions:"></a>definitions:</h3><ul>
<li>entity: any kind of object in distributed system:<br>process, file, printer, host, communication endpoint</li>
<li>naming services:<ul>
<li>usefulness: <ul>
<li>identification</li>
<li>providing detailed description</li>
<li>foundations for communication, security, auditing</li>
</ul>
</li>
</ul>
</li>
<li>name space:<ul>
<li>contains all valid names recognized and managed by a service</li>
</ul>
</li>
<li>naming domain:<ul>
<li>name space with a single administrative authority which manages names for the name space</li>
</ul>
</li>
<li>name resolution: <ul>
<li>a process to look up information&#x2F;attributes from a name</li>
<li>mounting: <ul>
<li>a directory node in a remote server can be mounted into a local node</li>
</ul>
</li>
</ul>
</li>
<li>name: set of bits&#x2F;characters used to refer to an entity&#x2F;a collective of entities, in a context</li>
<li>identifier: a name that uniquely identifies an entity</li>
<li>address: the name of an access point, the location of an entity</li>
</ul>
<h3 id="design-principles"><a href="#design-principles" class="headerlink" title="design principles:"></a>design principles:</h3><ul>
<li>flat naming:<ul>
<li>identifiers have no structured description, just a set of bits<br>m-bits in distributed hash table</li>
</ul>
</li>
<li>structured naming:<ul>
<li>hard links: multiple absolute paths names referring to the same node</li>
<li>symbolic links: leaf node storing an absolute path name</li>
</ul>
</li>
<li>attribute based naming:</li>
</ul>
<h3 id="naming-services"><a href="#naming-services" class="headerlink" title="naming services:"></a>naming services:</h3><ul>
<li>DNS</li>
<li>distributed naming service<ul>
<li>global layer: com, org, us, edu</li>
<li>administrational layer: yale.cs.linda</li>
<li>managerial layer: robot.txt</li>
</ul>
</li>
<li>iterative&#x2F;recursive name resolution<ul>
<li>client’s name resolver &#x3D;&gt; name server &#x3D;&gt;client’s name resolver </li>
<li>iterative name resolution at resolver side </li>
<li>iterative name resolution at server side</li>
<li>recursive name resolution</li>
</ul>
</li>
<li>administrative zones</li>
<li>caching servers<ul>
<li>scalabiltiy<ul>
<li>response time</li>
<li>fault tolerance</li>
</ul>
</li>
</ul>
</li>
<li>Directory Service(LDAP,RDF)<ul>
<li>LDAP implementation, flow</li>
</ul>
</li>
</ul>
<h3 id="attributed-based-naming"><a href="#attributed-based-naming" class="headerlink" title="attributed-based naming"></a>attributed-based naming</h3><ul>
<li>a tuple(attribute,value) can be used to describe a property</li>
<li>directory service</li>
<li>hierachical implementation: LDAP</li>
<li>decentralized implementations</li>
</ul>
<h3 id="name-and-name-services"><a href="#name-and-name-services" class="headerlink" title="name and name services"></a>name and name services</h3><h3 id="naming-space-and-implementation"><a href="#naming-space-and-implementation" class="headerlink" title="naming space and implementation"></a>naming space and implementation</h3><h3 id="flat-naming-and-simple-resolutions"><a href="#flat-naming-and-simple-resolutions" class="headerlink" title="flat naming and simple resolutions"></a>flat naming and simple resolutions</h3><h3 id="structured-naming"><a href="#structured-naming" class="headerlink" title="structured naming"></a>structured naming</h3><h3 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h3><h2 id="Virtualization"><a href="#Virtualization" class="headerlink" title="Virtualization"></a>Virtualization</h2><h3 id="definitions-1"><a href="#definitions-1" class="headerlink" title="definitions"></a>definitions</h3><ul>
<li><p>hypervisor</p>
<ol>
<li>type 1:</li>
</ol>
<ul>
<li>right on top of computer hardware</li>
<li>all guest operating systems are a layer above the hypervisor</li>
</ul>
<ol start="2">
<li>type 2:  VMware workstation</li>
</ol>
<ul>
<li>run over a host OS</li>
<li>the second layer over the hardware</li>
<li>the guest OSs run a layer over the hypervisor(the third layer)</li>
</ul>
</li>
<li><p>virtual machine</p>
<ul>
<li>virtual machine layer, VMM, hypervisor: software that runs in a layer between a hypervisor&#x2F;host OS and one of more VMs</li>
</ul>
</li>
<li><p>full vs platform virtualization</p>
<ol>
<li>full virtualization    native VM<ul>
<li>complete simulation of underlying hardware, all instructions</li>
<li>hardware architectural support provided to allow virtualziation</li>
</ul>
</li>
<li>platform virtualization    hosted VM<ul>
<li>limited simulation of underlying hardware</li>
</ul>
</li>
</ol>
</li>
<li><p>native vs hosted VM</p>
</li>
</ul>
<h3 id="performance-x2F-efficiency-analysis"><a href="#performance-x2F-efficiency-analysis" class="headerlink" title="performance&#x2F;efficiency analysis"></a>performance&#x2F;efficiency analysis</h3><ul>
<li>virtual networking <ul>
<li>bridging: guest OS is given direct access to the host’s NIC independent of the host OS</li>
<li>NAT: guest OS is given a virtual NIC<br>network traffic &#x3D;&gt; virtual NIC &#x3D;&gt; host OS &#x3D;&gt; physical NIC</li>
<li>Host Only: virtual NIC has no direct route to physical NIC</li>
</ul>
</li>
<li>virtual IO<ul>
<li>emulation: scalable, low performance</li>
<li>direct IO: unscalable, high performance</li>
</ul>
</li>
<li>SRIOV<ul>
<li>solution to 50 VMs but 5 I&#x2F;O devices </li>
<li>allow PCIe device to present itself as multiple virtual interfaces </li>
<li>best performance</li>
<li>limitation: VF configuration depends on PF configuration, thus can not configure</li>
</ul>
</li>
<li>trade off</li>
</ul>
<h3 id="case-study"><a href="#case-study" class="headerlink" title="case study"></a>case study</h3><ul>
<li>XEN architecture<ul>
<li>domain 0 for control and I&#x2F;O</li>
</ul>
</li>
<li>Amazon AWS&#x2F;Google</li>
</ul>
<h3 id="virtual-machine"><a href="#virtual-machine" class="headerlink" title="virtual machine"></a>virtual machine</h3><h3 id="virtual-machine-architecture"><a href="#virtual-machine-architecture" class="headerlink" title="virtual machine architecture"></a>virtual machine architecture</h3><h3 id="virtual-I-x2F-O-and-networking"><a href="#virtual-I-x2F-O-and-networking" class="headerlink" title="virtual I&#x2F;O and networking"></a>virtual I&#x2F;O and networking</h3><h2 id="Chap-13-Peer-to-Peer-System"><a href="#Chap-13-Peer-to-Peer-System" class="headerlink" title="Chap 13, Peer to Peer System"></a>Chap 13, Peer to Peer System</h2><h3 id="history-Napster"><a href="#history-Napster" class="headerlink" title="history   Napster"></a>history   Napster</h3><ul>
<li>servers store table: filename, peer pointer(ip address, port number)</li>
<li>peers store their own files</li>
<li>all communications use TCP</li>
<li>problem: <ol>
<li>centralized server: congestion</li>
<li>centralized server: single point of failure</li>
<li>security: plaintext messages</li>
</ol>
</li>
</ul>
<h3 id="distributed-hash-table"><a href="#distributed-hash-table" class="headerlink" title="distributed hash table"></a>distributed hash table</h3><ul>
<li>to insert, lookup and delete objects with keys</li>
<li>key, object(file)</li>
</ul>
<h3 id="Chord"><a href="#Chord" class="headerlink" title="Chord"></a>Chord</h3><ul>
<li>finger table: ft[m] [0,m-1]<ul>
<li>ft[i] &#x3D; first peer with id &gt;&#x3D; (n+pow(2,i)) mod pow(2,m) </li>
<li>file is stored at first peer with id &gt;&#x3D; file_key mod pow(2,m)</li>
</ul>
</li>
<li>efficiency analysis: O(log(n)) for insertion and lookup given correct finger table entries</li>
<li>lookup algorithm, finger table<ul>
<li>local search</li>
<li>query largest successor&#x2F;finger table entry &lt;&#x3D; k</li>
<li>if none exist, query next successor</li>
</ul>
</li>
<li>new nodes joining</li>
<li>stablization algorithm: O(n^2) rounds for strict stablization</li>
<li>rate of churn per hour: define r(successor and predecessor)</li>
</ul>
<h2 id="Failure-Detection"><a href="#Failure-Detection" class="headerlink" title="Failure Detection"></a>Failure Detection</h2><h3 id="two-different-system-models"><a href="#two-different-system-models" class="headerlink" title="two different system models"></a>two different system models</h3><ul>
<li>synchronous distributed system</li>
<li>asynchronous distributed system   <ul>
<li>no bounds on process execution</li>
<li>no bounds on message transmission delay </li>
<li>the Internet</li>
</ul>
</li>
</ul>
<h3 id="failure-model"><a href="#failure-model" class="headerlink" title="failure model"></a>failure model</h3><ul>
<li>process omission failure<ul>
<li>crash-stop</li>
<li>crash-recovery</li>
</ul>
</li>
</ul>
<h3 id="type-of-failure-detection"><a href="#type-of-failure-detection" class="headerlink" title="type of failure detection"></a>type of failure detection</h3><ul>
<li>process failure</li>
<li>arbitrary failure<ul>
<li>arbitrary process failure</li>
<li>arbitrary channel failure</li>
</ul>
</li>
<li>communication failure<ul>
<li>send omission</li>
<li>channel omission</li>
<li>receive omission</li>
</ul>
</li>
<li>completeness and accuracy<ul>
<li>completness: no misses</li>
<li>accuracy: no mistakes<br>Every detected failure corresponds to a crashed process.</li>
</ul>
</li>
<li>synchronous and asynchronous model</li>
<li>measuring accuracy(metrics)<ul>
<li>speed: detection time</li>
<li>accuracy: <ol>
<li>mistake recurrence time</li>
<li>mistake duration time</li>
<li>number of false failure detections per time</li>
<li>number of undetected failures per time</li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="process-failure"><a href="#process-failure" class="headerlink" title="process failure"></a>process failure</h3><p>pj fails</p>
<ul>
<li>ping-ack<br>pi Ping&#x3D;&gt; pj, pj Ack&#x3D;&gt; pi</li>
<li>heartbeat<br>pj Heartbeat&#x3D;&gt; pi</li>
<li>satifies completness and accuracy in synchronous systems</li>
<li>satifies completness and probabilistic accuracy in asynchronous systems</li>
</ul>
<h3 id="implement-heartbeat-in-a-distributed-system-environment"><a href="#implement-heartbeat-in-a-distributed-system-environment" class="headerlink" title="implement heartbeat in a distributed system environment"></a>implement heartbeat in a distributed system environment</h3><ul>
<li>want all to know the failure</li>
<li>combine failure detection with a dissemination protocol</li>
<li>central, ring, all-to-all</li>
<li>heartbeat combined reliable multicast protocol</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://invincible-nerd.github.io/2022/12/04/COEN317_final/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="invincible-nerd">
      <meta itemprop="description" content="For explorer everywhere">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IVN">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/04/COEN317_final/" class="post-title-link" itemprop="url">COEN317 Final Review</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-04 16:34:54" itemprop="dateCreated datePublished" datetime="2022-12-04T16:34:54+08:00">2022-12-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-12-05 11:49:59" itemprop="dateModified" datetime="2022-12-05T11:49:59+08:00">2022-12-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CS/" itemprop="url" rel="index"><span itemprop="name">CS</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>19k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>17 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="COEN317-Final-Review"><a href="#COEN317-Final-Review" class="headerlink" title="COEN317 Final Review"></a>COEN317 Final Review</h1><h2 id="Global-Time-and-Global-State"><a href="#Global-Time-and-Global-State" class="headerlink" title="Global Time and Global State"></a>Global Time and Global State</h2><ul>
<li>Asynchronous distributed systems consist of several  processes without common memory which communicate  via messages with <strong>unpredictable transmission delays</strong></li>
<li>Global time &amp; global state are hard to realize in distributed  systems<ul>
<li>Processes are distributed geographically</li>
<li>Rate of event occurrence can be high (unpredictable)</li>
<li>Event execution times can be small</li>
</ul>
</li>
<li>We can only approximate the global view<ul>
<li>Simulate a global time – Logical Clocks</li>
<li>Simulate a global state – Global Snapshots</li>
</ul>
</li>
</ul>
<h2 id="Simulating-global-time"><a href="#Simulating-global-time" class="headerlink" title="Simulating global time"></a>Simulating global time</h2><ul>
<li><p>An accurate notion of global time is difficult to achieve in distributed systems.</p>
<ul>
<li>We often derive “causality” from loosely synchronized clocks</li>
</ul>
</li>
<li><p>Clocks in a distributed system drift</p>
<ul>
<li>Relative to each other</li>
<li>Relative to a real world clock<ul>
<li>Determination of this real world clock itself may be an issue</li>
</ul>
</li>
<li>Clock Skew versus Drift<ul>
<li>Clock Skew &#x3D; Relative Difference in clock values of two processes</li>
<li>Clock Drift &#x3D; Relative Difference in clock frequencies (rates) of two  processes</li>
</ul>
</li>
</ul>
</li>
<li><p>Clock synchronization is needed to simulate global time</p>
<ul>
<li>Correctness – consistency, fairness</li>
</ul>
</li>
<li><p>Physical Clocks vs. Logical clocks </p>
<ul>
<li>Physical clocks - must not deviate from the real-time by more than a  certain amount.</li>
</ul>
</li>
</ul>
<h2 id="Cristian’s-Time-Server-Algorithm"><a href="#Cristian’s-Time-Server-Algorithm" class="headerlink" title="Cristian’s (Time Server) Algorithm"></a>Cristian’s (Time Server) Algorithm</h2><ul>
<li><p>Uses <strong>a time server</strong> to synchronize clocks</p>
<ul>
<li>Time server keeps the reference time (say UTC)</li>
<li>A client asks the time server for time, the server responds with its current  time, and the client uses the received value <strong>T</strong> to set its clock</li>
</ul>
</li>
<li><p>But network round-trip time introduces errors…</p>
<ul>
<li><p>Let <strong>RTT</strong> &#x3D; response-received-time – request-sent-time (measurable at  client),</p>
</li>
<li><p>If we know </p>
<ul>
<li>(a) <strong>min1</strong> &#x3D; minimum P -&gt; S latency </li>
<li>(b) <strong>min2</strong> &#x3D; minimum S -&gt; P latency </li>
<li>(c) that the server timestamped the message at the last possible instant  before sending it back</li>
</ul>
</li>
<li><p>Then, the actual time could be between <strong>[T+min2,T+RTT— min1]</strong></p>
</li>
<li><p>P sets its time to halfway through this interval</p>
<ul>
<li>To: t + (RTT+min2-min1)&#x2F;2</li>
</ul>
</li>
<li><p>Error is at most (RTT-min2-min1)&#x2F;2 </p>
<ul>
<li>Bounded!</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Berkeley-UNIX-algorithm"><a href="#Berkeley-UNIX-algorithm" class="headerlink" title="Berkeley UNIX algorithm"></a>Berkeley UNIX algorithm</h2><ul>
<li>One daemon without UTC</li>
<li>Periodically, this <strong>daemon</strong> polls and asks all the machines for their  time</li>
<li>The machines respond.</li>
<li>The daemon computes an average time and then broadcasts this  average time.</li>
</ul>
<h2 id="Decentralized-Averaging-Algorithm"><a href="#Decentralized-Averaging-Algorithm" class="headerlink" title="Decentralized Averaging Algorithm"></a>Decentralized Averaging Algorithm</h2><ul>
<li>Each machine has a daemon without UTC</li>
<li>Periodically, at fixed agreed-upon times, each machine broadcasts its  local time.</li>
<li>Each of them calculates the average time by averaging all the received  local times.</li>
</ul>
<h2 id="Network-Time-Protocol-NTP"><a href="#Network-Time-Protocol-NTP" class="headerlink" title="Network Time Protocol (NTP)"></a>Network Time Protocol (NTP)</h2><ul>
<li>Most widely used physical clock synchronization protocol on the Internet</li>
<li>Hierarchical tree of time servers.<ul>
<li>The primary server at the root synchronizes with the UTC.</li>
<li>Secondary servers - backup to primary server.</li>
<li>Lowest</li>
<li>synchronization subnet with clients.</li>
</ul>
</li>
</ul>
<p><img src="/images/317/NTP.JPG"></p>
<p><img src="/images/317/NTP1.JPG"></p>
<p><img src="/images/317/NTP2.JPG"></p>
<p><img src="/images/317/NTP3.JPG"></p>
<p><img src="/images/317/NTP4.JPG"></p>
<h2 id="Event-Ordering"><a href="#Event-Ordering" class="headerlink" title="Event Ordering"></a>Event Ordering</h2><ul>
<li>Lamport defined the “happens before” (-&gt;) relation<ul>
<li>If a and b are events in the same process, and a occurs before b, then  a-&gt;b.</li>
<li>If a is the event of a message being sent by one process and b is the  event of the message being received by another process, then a -&gt; b.</li>
<li>If X -&gt; Y and Y-&gt; Z then X -&gt; Z.</li>
</ul>
</li>
<li>If a -&gt; b then time (a) &lt; time (b)</li>
</ul>
<h2 id="Causal-Ordering"><a href="#Causal-Ordering" class="headerlink" title="Causal Ordering"></a>Causal Ordering</h2><ul>
<li><p>“Happens Before” also called causal ordering</p>
</li>
<li><p>Possible to draw a causality relation between 2 events if</p>
<ul>
<li>They happen in the same process</li>
<li>There is a chain of messages between them</li>
</ul>
</li>
<li><p>“Happens Before” notion is not straightforward in distributed system</p>
<ul>
<li><p>No guarantees of synchronized clocks</p>
</li>
<li><p>Communication latency</p>
</li>
</ul>
</li>
</ul>
<h2 id="Types-of-Logical-Clocks"><a href="#Types-of-Logical-Clocks" class="headerlink" title="Types of Logical Clocks"></a>Types of Logical Clocks</h2><ul>
<li>Systems of logical clocks differ in their representation of logical time  and also in the protocol to update the logical clocks.</li>
<li>2 kinds of logical clocks<ul>
<li>Lamport</li>
<li>Vector</li>
</ul>
</li>
</ul>
<h2 id="Lamport-Clock"><a href="#Lamport-Clock" class="headerlink" title="Lamport Clock"></a>Lamport Clock</h2><ul>
<li><p>Proposed by Lamport in 1978 as an attempt to totally order events in  a distributed system.</p>
</li>
<li><p>Each process uses a local counter (clock) which is an integer</p>
<ul>
<li><p>initial value of counter is set to a non-negative integer or zero</p>
</li>
<li><p>A process increments its counter when a send or an instruction happens at it.</p>
<p>The counter is assigned to the event as its timestamp.</p>
</li>
<li><p>Each process keeps its own logical clock used to timestamp events</p>
</li>
</ul>
</li>
<li><p>A send (message) event carries its timestamp</p>
</li>
<li><p>For a receive (message) event the counter is updated by</p>
<ul>
<li>max(local clock, message timestamp) + 1</li>
</ul>
</li>
</ul>
<p><img src="/images/317/Lamport1.JPG"></p>
<h2 id="Vector-Timestamp"><a href="#Vector-Timestamp" class="headerlink" title="Vector Timestamp"></a>Vector Timestamp</h2><ul>
<li>In the system of vector clocks, the time domain is represented by a set of  n-dimensional non-negative integer vectors.</li>
<li>Each process has a clock Ci consisting of a vector of length n, where n is  the total number of processes vt[1..n], where vt[j ] is the local logical  clock of Pj and describes the logical time progress at process Pj .</li>
<li>Incrementing vector clocks<ul>
<li>On an instruction or send event at process i, it increments only its ith element of its vector clock</li>
</ul>
</li>
<li>Each message carries the send-event’s vector timestamp  Vmessage[1…N]</li>
<li>On receiving a message at process i:<ul>
<li>Vi[i] &#x3D; Vi[i] + 1</li>
<li>Vi[j] &#x3D; max(Vmessage[j], Vi[j]) for j≠ i</li>
</ul>
</li>
<li>Vector Clocks example</li>
</ul>
<p><img src="/images/317/Vector.JPG"></p>
<p><img src="/images/317/Vector1.JPG"></p>
<p><img src="/images/317/Vector2.JPG"></p>
<p><img src="/images/317/Vector3.JPG"></p>
<p><img src="/images/317/Vector4.JPG"></p>
<h2 id="Global-State"><a href="#Global-State" class="headerlink" title="Global State"></a>Global State</h2><ul>
<li>Recording the global state of a distributed system on-the-fly is an  important paradigm.<ul>
<li>Challenge: lack of globally shared memory, global clock and unpredictable message  delays in a distributed system</li>
</ul>
</li>
<li>Notions of global time and global state closely related</li>
<li>A process can (without freezing the whole computation) compute the  best possible approximation of global state</li>
<li>A global state that could have occurred<ul>
<li>No process in the system can decide whether the state did really occur</li>
<li>Guarantee stable properties (i.e. once they become true, they remain true)</li>
</ul>
</li>
</ul>
<h2 id="Consistent-Cuts"><a href="#Consistent-Cuts" class="headerlink" title="Consistent Cuts"></a>Consistent Cuts</h2><ul>
<li>A cut (or time slice) is a zigzag line cutting a time diagram  into 2 parts (past and future)</li>
<li>Consistent Cut: a cut that obeys causality<ul>
<li>A cut C is a consistent cut if and only if:<ul>
<li>for (each pair of events e, f in the system)</li>
<li>Such that event e is in the cut C, and if f-&gt;e (f happens-before e)</li>
<li>Then: Event f is also in the cut C</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/images/317/Cut.JPG"></p>
<h2 id="System-Model-for-Global-Snapshots"><a href="#System-Model-for-Global-Snapshots" class="headerlink" title="System Model for Global Snapshots"></a>System Model for Global Snapshots</h2><ul>
<li>The system consists of a collection of n processes p1, p2, …, pn that are  connected by channels.</li>
<li>There are no globally shared memory and physical global clock and processes  communicate by passing messages through communication channels.</li>
<li>Cij denotes the channel from process pi to process pj and its state is denoted by Si</li>
<li>The actions performed by a process are modeled as three types of events:<ul>
<li>Internal events,the message send event and the message receive event.</li>
<li>For a message mij that is sent by process pi to process pj , let send(mij ) and rec(mij ) denote  its send and receive events.</li>
</ul>
</li>
</ul>
<h2 id="Chandy-Lamport-Distributed-Snapshot-Algorithm"><a href="#Chandy-Lamport-Distributed-Snapshot-Algorithm" class="headerlink" title="Chandy-Lamport Distributed Snapshot Algorithm"></a>Chandy-Lamport Distributed Snapshot Algorithm</h2><ul>
<li>Assumes FIFO communication in channels</li>
<li>Uses a marker message to separate messages in the channels.<ul>
<li>After a process has recorded its snapshot, it sends a marker, along all of its  outgoing channels before sending out any more messages.</li>
<li>The marker separates the messages in the channel into those to be included  in the snapshot from those not to be recorded in the snapshot.</li>
</ul>
</li>
<li>A process must record its snapshot no later than when it receives a marker on  any of its incoming channels.</li>
<li>The algorithm terminates after each process has received a marker on all of its  incoming channels.</li>
<li>All the local snapshots get disseminated to all other processes and all the  processes can determine the global state</li>
</ul>
<p><img src="/images/317/Chandy_Lamport1.JPG"></p>
<p><img src="/images/317/Chandy_Lamport2.JPG"></p>
<p><img src="/images/317/Chandy_Lamport3.JPG"></p>
<ul>
<li>Global Snapshot calculated by Chandy-Lamport algorithm is  causally correct</li>
</ul>
<h2 id="Distributed-Mutual-Exclusion"><a href="#Distributed-Mutual-Exclusion" class="headerlink" title="Distributed Mutual Exclusion"></a>Distributed Mutual Exclusion</h2><ul>
<li>Mutual exclusion<ul>
<li>ensures that concurrent processes have serialized access to  shared resources - the critical section problem</li>
<li>At any point in time, only one process can be executing in its  critical section</li>
</ul>
</li>
<li>Shared variables (semaphores) cannot be used in a distributed  system<ul>
<li>Mutual exclusion must be based on message passing, in the  context of unpredictable delays and incomplete knowledge</li>
</ul>
</li>
</ul>
<h2 id="Approaches-to-Distributed-Mutual-Exclusion"><a href="#Approaches-to-Distributed-Mutual-Exclusion" class="headerlink" title="Approaches to Distributed Mutual Exclusion"></a>Approaches to Distributed Mutual Exclusion</h2><ul>
<li>Central coordinator-based approach<ul>
<li>A centralized coordinator determines who enters the CS</li>
</ul>
</li>
<li>Distributed approaches to mutual exclusion<ul>
<li>Token based approach<ul>
<li>A unique token is shared among the processes. A process is allowed to  enter its CS if it possesses the token.</li>
<li>Mutual exclusion is ensured because the token is unique.</li>
</ul>
</li>
<li>Non-token based approach<ul>
<li>Two or more successive rounds of messages are exchanged among the  processes to determine which process will enter the CS next.</li>
</ul>
</li>
<li>Quorum based approach<ul>
<li>Each process requests permission to execute the CS from a subset of  processes (called a quorum).</li>
<li>Any two quorums contain a common process. This common process makes sure that only one request executes the CS at any time.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Requirements-x2F-Conditions"><a href="#Requirements-x2F-Conditions" class="headerlink" title="Requirements&#x2F;Conditions"></a>Requirements&#x2F;Conditions</h3><ul>
<li>Safety Property<ul>
<li>At any instant, only one process can execute the critical section.</li>
</ul>
</li>
<li>Liveness Property<ul>
<li>This property states the absence of deadlock and starvation. Two or more  processess should not endlessly wait for messages which will never arrive.</li>
</ul>
</li>
<li>Ordering&#x2F;Fairness<ul>
<li>Each process gets a fair chance to execute the CS which means the CS  execution requests are executed in the order of their arrival (time is  determined by a logical clock) in the system.</li>
</ul>
</li>
</ul>
<h2 id="Mutual-Exclusion-Techniques-Covered"><a href="#Mutual-Exclusion-Techniques-Covered" class="headerlink" title="Mutual Exclusion Techniques Covered"></a>Mutual Exclusion Techniques Covered</h2><ul>
<li><p>Central Coordinator Algorithm</p>
<p><img src="/images/317/central_coordinator.JPG"></p>
</li>
<li><p>In a distributed environment it seems more natural to implement  mutual exclusion, based upon distributed agreement - not on a  central coordinator.</p>
</li>
<li><p>Distributed Non-token based</p>
<ul>
<li>Ricart-Agrawala Algorithm</li>
<li>Maekawa’s Algorithm</li>
</ul>
</li>
</ul>
<h2 id="Ricart-Agrawala-Algorithm"><a href="#Ricart-Agrawala-Algorithm" class="headerlink" title="Ricart-Agrawala Algorithm"></a>Ricart-Agrawala Algorithm</h2><ul>
<li>Uses only two types of messages – REQUEST and REPLY.</li>
<li>It is assumed that all processes keep a (Lamport’s) logical clock which is updated  according to the clock rules.<ul>
<li>Requests are ordered according to their global logical timestamps; if  timestamps are equal, process identifiers are compared to order them.</li>
</ul>
</li>
<li>The process that requires entry to a CS multicasts the request message to all  other processes competing for the same resource.<ul>
<li>Process is allowed to enter the CS when all processes have replied to this  message.</li>
<li>The request message consists of the requesting process’ timestamp (logical  clock) and its identifier.</li>
</ul>
</li>
<li>Each process keeps its state with respect to the CS: released, requested, or held.</li>
</ul>
<p><img src="/images/317/RA.JPG"></p>
<h3 id="Analysis-Ricart-Agrawala’s-Algorithm"><a href="#Analysis-Ricart-Agrawala’s-Algorithm" class="headerlink" title="Analysis: Ricart-Agrawala’s Algorithm"></a>Analysis: Ricart-Agrawala’s Algorithm</h3><ul>
<li>Safety<ul>
<li>Two processes Pi and Pj cannot both have access to CS</li>
</ul>
</li>
<li>Liveness<ul>
<li>Worst-case: wait for all other (N-1) processes to send Reply</li>
</ul>
</li>
<li>Ordering<ul>
<li>Requests with lower Lamport timestamps are granted earlier</li>
</ul>
</li>
</ul>
<h3 id="Performance-Ricart-Agrawala’s-Algorithm"><a href="#Performance-Ricart-Agrawala’s-Algorithm" class="headerlink" title="Performance: Ricart-Agrawala’s Algorithm"></a>Performance: Ricart-Agrawala’s Algorithm</h3><ul>
<li>Bandwidth: 2*(N-1) messages per enter() operation</li>
<li>Client delay: one round-trip time</li>
<li>Synchronization delay: one message transmission time</li>
</ul>
<h2 id="Quorum-Based-–-Maekawa’s-Algorithm"><a href="#Quorum-Based-–-Maekawa’s-Algorithm" class="headerlink" title="Quorum-Based – Maekawa’s Algorithm"></a>Quorum-Based – Maekawa’s Algorithm</h2><ul>
<li><p>Site obtains permission only from a subset of sites to enter CS</p>
</li>
<li><p>Multicasts messages to a voting subset of processes</p>
<ul>
<li><p>Each process pi is associated with a voting set vi (of processes)</p>
<ul>
<li>Each process belongs to its own voting set</li>
<li>The intersection of any two voting sets is non-empty</li>
<li>Each voting set is of size K</li>
<li>Each process belongs to M other voting sets</li>
</ul>
</li>
<li><p>To access a critical section, pi requests permission from all other processes in  its own voting set vi</p>
<ul>
<li><p>Voting set member gives permission to only one requestor at a time, and  queues all other requests</p>
</li>
<li><p>Guarantees safety </p>
</li>
<li><p>May not guarantee liveness (may deadlock)</p>
<p><img src="/images/317/M_liveness.JPG"></p>
</li>
<li><p>Maekawa showed that K&#x3D;M&#x3D;N^0.5 works best</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/images/317/Maekawa1.JPG"></p>
<p><img src="/images/317/Maekawa2.JPG"></p>
<h2 id="Election-Algorithms"><a href="#Election-Algorithms" class="headerlink" title="Election Algorithms"></a>Election Algorithms</h2><ul>
<li>It doesn’t matter which process is elected.<ul>
<li>What is important is that one and only one process is chosen (we call this  process the coordinator) and all processes agree on this decision</li>
</ul>
</li>
<li>Assume that each process has a unique number (identifier)<ul>
<li>In general, election algorithms attempt to locate the process with the highest  number, among those which currently are up</li>
</ul>
</li>
<li>Election is typically started after a failure occurs<ul>
<li>The detection of a failure (e.g. the crash of the current coordinator) is  normally based on time-out → a process that gets no response for a period of  time suspects a failure and initiates an election process.</li>
</ul>
</li>
<li>An election process is typically performed in two phases:<ul>
<li>Select a leader with the highest priority.</li>
<li>Inform all processes about the winner.</li>
</ul>
</li>
</ul>
<h2 id="The-Ring-based-Algorithm"><a href="#The-Ring-based-Algorithm" class="headerlink" title="The Ring-based Algorithm"></a>The Ring-based Algorithm</h2><ul>
<li>We assume that the processes are arranged in a logical ring<ul>
<li>Each process knows the address of one other process, which is its  neighbor in the clockwise direction</li>
</ul>
</li>
<li>The algorithm elects a single coordinator, which is the highest id process.</li>
<li>Election is started by a process which detects the coordinator failure<ul>
<li>The process prepares an election message which includes its id and passed it to the successor process.</li>
<li>When a process receives an election message<ul>
<li>It compares the identifier in the message with its own</li>
<li>If the arrived identifier is greater, it forwards the received election  message to its neighbor</li>
<li>If the arrived identifier is smaller, it substitutes its own identifier in the  election message before forwarding it.</li>
<li>If the received id is that of the receiver itself → this will be the  coordinator.</li>
</ul>
</li>
</ul>
</li>
<li>The new coordinator sends an elected message through the ring</li>
</ul>
<p><img src="/images/317/ring.JPG"></p>
<h2 id="The-Bully-Algorithm"><a href="#The-Bully-Algorithm" class="headerlink" title="The Bully Algorithm"></a>The Bully Algorithm</h2><ul>
<li>A process has to know the identifier of all other processes <ul>
<li>(it doesn’t know, however, which one is still up); the process with the highest identifier, among those which are  up, is selected.</li>
</ul>
</li>
<li>Any process could fail during the election procedure.</li>
<li>When a process Pi detects a failure and a coordinator has to be elected<ul>
<li>it sends an election message to all the processes with a higher identifier and then waits for an answer message:</li>
<li>If no response arrives within a time limit<ul>
<li>Pi becomes the coordinator (all processes with higher identifier are down)</li>
<li>it broadcasts a coordinator message to all processes to let them know.</li>
</ul>
</li>
<li>If an answer message arrives, <ul>
<li>Pi knows that another process has to become the coordinator → it waits in order to receive the  coordinator message.</li>
<li>If this message fails to arrive within a time limit (which means that a potential coordinator crashed after  sending the answer message) Pi resends the election message.</li>
</ul>
</li>
</ul>
</li>
<li>When receiving an election message from Pi<ul>
<li>a process Pj replies with an answer message to Pi and</li>
<li>then starts an election procedure itself( unless it has already started one) it sends an election message to all  processes with higher identifier.</li>
</ul>
</li>
<li>Finally all processes get an answer message, except the one which becomes the coordinator.</li>
</ul>
<p><img src="D:\Blog\source\images\317\bully.JPG"></p>
<h2 id="Distributed-File-System-DFS"><a href="#Distributed-File-System-DFS" class="headerlink" title="Distributed File System (DFS)"></a>Distributed File System (DFS)</h2><ul>
<li>Files are stored on a server machine<ul>
<li>client machine does RPCs to server to perform operations on file</li>
</ul>
</li>
<li>Desirable Properties from a DFS<ul>
<li>Transparency: client accesses DFS files as if it were accessing local files<ul>
<li>Same API as local files, i.e., client code doesn’t change</li>
<li>Need to make location, replication, etc. invisible to client</li>
</ul>
</li>
<li>Support concurrent clients<ul>
<li>Multiple client processes reading&#x2F;writing the file concurrently</li>
</ul>
</li>
</ul>
</li>
<li>Replication: for fault-tolerance</li>
</ul>
<h2 id="File-Sharing-Semantics"><a href="#File-Sharing-Semantics" class="headerlink" title="File Sharing Semantics"></a>File Sharing Semantics</h2><ul>
<li>One-copy Serializability<ul>
<li>Updates are written to the single copy and are available immediately</li>
</ul>
</li>
<li>Serializability<ul>
<li>Transaction semantics (file locking protocols implemented - share for  read, exclusive for write).</li>
</ul>
</li>
</ul>
<h2 id="Example-Sun-NFS"><a href="#Example-Sun-NFS" class="headerlink" title="Example: Sun-NFS"></a>Example: Sun-NFS</h2><ul>
<li><p>Network File System</p>
</li>
<li><p>Supports heterogeneous systems</p>
</li>
<li><p>Architecture</p>
<ul>
<li>Server exports one or more directory trees for access by  remote clients</li>
<li>Clients access exported directory trees by mounting them  to the client local tree</li>
</ul>
</li>
<li><p>Protocols</p>
<ul>
<li>Mounting protocol</li>
<li>Directory and file access protocol - stateless, no open-close  messages, full access path on read&#x2F;write</li>
</ul>
</li>
</ul>
<h3 id="NFS-Architecture"><a href="#NFS-Architecture" class="headerlink" title="NFS Architecture"></a>NFS Architecture</h3><p><img src="/images/317/NFS.JPG"></p>
<h2 id="Example-Andrew-File-System"><a href="#Example-Andrew-File-System" class="headerlink" title="Example: Andrew File System"></a>Example: Andrew File System</h2><ul>
<li><p>Designed at CMU</p>
<ul>
<li>Named after Andrew Carnegie and Andrew Mellon, the “C” and  “M” in CMU</li>
</ul>
</li>
<li><p>In use today in some clusters (especially University  clusters)</p>
</li>
<li><p>Supports information sharing on a large scale</p>
</li>
<li><p>Uses a session semantics</p>
<ul>
<li>Entire file is copied to the local machine (Venus) from the server  (Vice) when open. If file is changed, it is copied to server when  closed.<ul>
<li>Works because in practice, most files are changed by one  person</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Replication"><a href="#Replication" class="headerlink" title="Replication"></a>Replication</h2><ul>
<li><p>Enhances a service by replicating data</p>
<ul>
<li><p>Increased Availability</p>
<ul>
<li>Of service. When servers fail or when the network is partitioned.</li>
</ul>
</li>
<li><p>Fault Tolerance</p>
<ul>
<li>Under the fail-stop model, if up to f of f+1 servers crash, at least one is alive</li>
</ul>
</li>
<li><p>Load Balancing</p>
<ul>
<li>One approach: Multiple server IPs can be assigned to the same name in DNS,  which returns answers round-robin.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Passive-Replication"><a href="#Passive-Replication" class="headerlink" title="Passive Replication"></a>Passive Replication</h3><ul>
<li><p>uses a primary replica (master)</p>
<p>master: elected leader</p>
</li>
</ul>
<p><img src="/images/317/passive_replication.JPG"></p>
<h3 id="Active-Replication"><a href="#Active-Replication" class="headerlink" title="Active Replication"></a>Active Replication</h3><ul>
<li><p>treats all replicas identically</p>
</li>
<li><p>multicast inside replica group</p>
</li>
<li><p>can use any flavor of multicast ordering</p>
<ul>
<li>FIFO ordering</li>
<li>causal ordering</li>
<li>total ordering</li>
<li>hybrid ordering</li>
</ul>
</li>
</ul>
<p><img src="/images/317/active_replication.JPG"></p>
<h2 id="Transactions"><a href="#Transactions" class="headerlink" title="Transactions"></a>Transactions</h2><ul>
<li><p>Sequence of Read&#x2F;Write operations that act as ONE unit of execution</p>
</li>
<li><p>ACID Properties</p>
<ul>
<li>Atomicity<ul>
<li>All or nothing</li>
<li>a transaction should either <ul>
<li>i)complete successfully, so its effects are recorded in the  server objects; </li>
<li>or ii) the transaction has no effect at all.</li>
</ul>
</li>
</ul>
</li>
<li>Consistency<ul>
<li>if the server starts in a consistent state,  the transaction ends the server in a consistent state.</li>
</ul>
</li>
<li>Isolation<ul>
<li>Each transaction must be performed  without interference from other transactions</li>
<li>i.e.,  non-final effects of a transaction must not be visible  to other transactions</li>
</ul>
</li>
<li>Durability<ul>
<li>After a transaction has completed  successfully, all its effects are saved in permanent  storage.</li>
</ul>
</li>
</ul>
</li>
<li><p>Serializable Schedule </p>
<ul>
<li>Goal: increase <strong>concurrency</strong> while maintaining  <strong>correctness (ACID)</strong></li>
<li>Equivalent to some Serial execution → Correctness</li>
<li>Serial Equivalency Test</li>
</ul>
</li>
<li><p>serial</p>
<ul>
<li>An interleaving (say O) of transaction operations is  <strong>serially equivalent</strong> iff (if and only if):<ul>
<li>Cannot distinguish end-result of real  operation O from (fake) serial transaction order O’</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Distributed-Transactions"><a href="#Distributed-Transactions" class="headerlink" title="Distributed Transactions"></a>Distributed Transactions</h2><ul>
<li>Transactions distributed based on which entity hosts the  object&#x2F;replica</li>
<li>One-phase Commit: Issues<ul>
<li>Server with object has no say in whether transaction  commits or aborts<ul>
<li>If object corrupted, it just cannot commit (while other servers have  committed)</li>
</ul>
</li>
<li>Server may crash before receiving commit message,  with some updates still in memory</li>
</ul>
</li>
<li>Uses 2 Phase Commit protocol for guaranteeing atomic commit (in  contrast to 1 Phase Commit)<ul>
<li>Failures in Two-phase Commit <ul>
<li>To deal with server crashes<ul>
<li>Each server saves tentative updates into permanent storage, right  before replying Yes&#x2F;No in first phase. Retrievable after crash  recovery</li>
</ul>
</li>
<li>To deal with coordinator crashes<ul>
<li>Coordinator logs all decisions and received&#x2F;sent messages on disk</li>
<li>After recovery or new election &#x3D;&gt; new coordinator takes over</li>
</ul>
</li>
<li>To deal with Yes&#x2F;No message loss, <ul>
<li>coordinator aborts  the transaction after a timeout (pessimistic!)</li>
</ul>
</li>
<li>To deal with Commit or Abort message loss<ul>
<li>Server can poll coordinator (repeatedly)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Concurrency-Control"><a href="#Concurrency-Control" class="headerlink" title="Concurrency Control"></a>Concurrency Control</h2><ul>
<li>Optimistic Concurrency Control<ul>
<li>Used in Dropbox, Google apps, Wikipedia, key-value  stores like Cassandra, Riak, and Amazon’s Dynamo</li>
<li>Used for Read&#x2F;Read-Only transaction</li>
<li>Allow the transaction to execute</li>
<li>If Serial Equivalency passed, then commit. Otherwise, abort</li>
</ul>
</li>
<li>Pessimistic Concurrency Control<ul>
<li>Use Locking (Mutual Exclusion)</li>
</ul>
</li>
<li>2 Phase Locking protocol (2PL)<ul>
<li>Growing&#x2F;expanding phase – Acquire locks</li>
<li>Shrinking phase – release locks and no new locks can be acquired</li>
</ul>
</li>
<li>Strict 2PL – hold on to locks until transactions commits&#x2F;aborts</li>
</ul>
<h2 id="Deadlocks"><a href="#Deadlocks" class="headerlink" title="Deadlocks"></a>Deadlocks</h2><ul>
<li><p>3 necessary conditions for a deadlock to occur</p>
<ol>
<li>Some objects are accessed in exclusive lock modes</li>
<li>Transactions holding locks cannot be preempted</li>
<li>There is a circular wait (cycle) in the Wait-for graph</li>
</ol>
</li>
</ul>
<h2 id="Handling-Deadlocks"><a href="#Handling-Deadlocks" class="headerlink" title="Handling Deadlocks"></a>Handling Deadlocks</h2><ol>
<li><p>Lock timeout: </p>
<ul>
<li>abort transaction if lock cannot be  acquired within timeout</li>
<li>Expensive; leads to wasted work</li>
</ul>
</li>
<li><p>Deadlock Detection:</p>
<ul>
<li>keep track of Wait-for graph (e.g., via Global  Snapshot algorithm), and</li>
<li>find cycles in it (e.g., periodically)</li>
<li>If find cycle, there’s a deadlock &#x3D;&gt; Abort one or  more transactions to break cycle</li>
<li>Still allows deadlocks to occur</li>
</ul>
</li>
<li><p>Deadlock Prevention</p>
</li>
</ol>
<ul>
<li><p>Set up the system so one of the necessary conditions is violated</p>
<ol>
<li><p>Some objects are accessed in exclusive lock modes</p>
<p>Fix: Allow read-only access to objects</p>
</li>
<li><p>Transactions holding locks cannot be preempted</p>
<p>Fix: Allow preemption of some transactions</p>
</li>
<li><p>There is a circular wait (cycle) in the Wait-for graph</p>
<p>Fix: Lock all objects in the beginning; if fail any, abort  transaction &#x3D;&gt; No cycles in Wait-for graph</p>
</li>
</ol>
</li>
</ul>
<h2 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h2><ul>
<li>Threats<ul>
<li>Leakage<ul>
<li>Unauthorized access to service or data</li>
<li>E.g., Someone knows your bank balance</li>
</ul>
</li>
<li>Tampering<ul>
<li>Unauthorized modification of service or data</li>
<li>E.g., Someone modifies your bank balance</li>
</ul>
</li>
<li>Vandalism<ul>
<li>Interference with normal service, without  direct gain to attacker</li>
<li>E.g., Denial of Service attacks</li>
</ul>
</li>
</ul>
</li>
<li>Common Attacks<ul>
<li>Eavesdropping<ul>
<li>Attacker taps into network</li>
</ul>
</li>
<li>Masquerading<ul>
<li>Attacker pretends to be someone else, i.e.,  identity theft</li>
</ul>
</li>
<li>Message tampering<ul>
<li>Attacker modifies messages</li>
</ul>
</li>
<li>Replay attack<ul>
<li>Attacker replays old messages</li>
</ul>
</li>
<li>Denial of service<ul>
<li>bombard a port</li>
</ul>
</li>
</ul>
</li>
<li>CIA properties<ul>
<li>Confidentiality<ul>
<li>Protection against disclosure to unauthorized  individuals</li>
<li>Addresses Leakage threat</li>
</ul>
</li>
<li>Integrity<ul>
<li>Protection against unauthorized alteration or  corruption</li>
<li>Addresses Tampering threat</li>
</ul>
</li>
<li>Availability<ul>
<li>Service&#x2F;data is always readable&#x2F;writable</li>
<li>Addresses Vandalism threat</li>
</ul>
</li>
</ul>
</li>
<li>Policy vs Mechanism<ul>
<li>Many scientists (e.g., Hansen) have argued for a  separation of policy vs. mechanism</li>
<li>A security policy indicates what a secure system  accomplishes</li>
<li>A security mechanism indicates how these goals  are accomplished</li>
<li>E.g.,<ul>
<li>Policy: in a file system, only authorized individuals  allowed to access files (i.e., CIA properties)</li>
<li>Mechanism: Encryption, capabilities, etc.</li>
</ul>
</li>
</ul>
</li>
<li>Mechanisms: Golden A’s<ul>
<li>Authentication<ul>
<li>Is a user (communicating over the network)  claiming to be Alice, really Alice?</li>
</ul>
</li>
<li>Authorization<ul>
<li>Yes, the user is Alice, but is she allowed to  perform her requested operation on this  object?</li>
</ul>
</li>
<li>Auditing<ul>
<li>How did Eve manage to attack the system and  breach defenses? Usually done by  continuously logging all operations.</li>
</ul>
</li>
</ul>
</li>
<li>Encryption<ul>
<li>Symmetric Keys<ul>
<li>Same key (KAB) used to both encrypt and decrypt a  message</li>
<li>E.g., DES (Data Encryption Standard): 56 b key  operates on 64 b blocks from the message</li>
</ul>
</li>
<li>Public-Private keys<ul>
<li>Anything encrypted with KApriv can be decrypted only with  KApub</li>
<li>Anything encrypted with KApub can be decrypted only with  KApri</li>
<li>If Alice wants to send a secret message M that can  be read only by Bob<ol>
<li>Alice encrypts it with Bob’s public key</li>
<li>KBpub(M)</li>
<li>Bob only one able to decrypt it</li>
<li>KBpriv(KBpub(M)) &#x3D; M</li>
</ol>
</li>
</ul>
</li>
<li>Shared&#x2F;Symmetric vs. Public&#x2F;Private<ul>
<li>Shared keys reveal too much information<ul>
<li>Hard to revoke permissions from principals</li>
<li>E.g., group of principals shares one key <ul>
<li>want to remove one principal from group</li>
<li>need everyone in group to change key</li>
</ul>
</li>
</ul>
</li>
<li>Public&#x2F;private keys involve costly encryption or  decryption<ul>
<li>At least one of these 2 operations is costly</li>
</ul>
</li>
<li>Many systems use public&#x2F;private key system to  generate shared key, and use latter on messages</li>
</ul>
</li>
</ul>
</li>
<li>Digital Signature&#x2F;Certificate<ul>
<li>To sign a message M, Alice encrypts message with her  own private key<ul>
<li>Signed message: [M, KApriv(M)]</li>
<li>Anyone can verify, using Alice’s public key, that Alice signed it</li>
</ul>
</li>
<li>Digital Certificates implemented using digital signatures</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/unusable-index/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/unusable-index/">1</a><a class="page-number" href="/unusable-index/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/unusable-index/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/unusable-index/page/9/">9</a><a class="extend next" rel="next" href="/unusable-index/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">invincible-nerd</p>
  <div class="site-description" itemprop="description">For explorer everywhere</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">86</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2022-04 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">invincible-nerd</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">1.1m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">17:08</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
