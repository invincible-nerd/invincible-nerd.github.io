<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"invincible-nerd.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Web Developer Bootcamp1. 快捷键ctrl shift p : format document a tab lorem ctrl &#x2F; inp tab ! 标准html初始化 2. HTML5HTML is not a version, but a standard. You can’t turn off HTML5!  inline elements  a    a">
<meta property="og:type" content="article">
<meta property="og:title" content="Web Developer Bootcamp">
<meta property="og:url" content="http://invincible-nerd.github.io/2022/11/28/Web-Developer-Bootcamp/index.html">
<meta property="og:site_name" content="IVN">
<meta property="og:description" content="Web Developer Bootcamp1. 快捷键ctrl shift p : format document a tab lorem ctrl &#x2F; inp tab ! 标准html初始化 2. HTML5HTML is not a version, but a standard. You can’t turn off HTML5!  inline elements  a    a">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-11-28T15:21:41.000Z">
<meta property="article:modified_time" content="2022-11-29T07:34:21.998Z">
<meta property="article:author" content="invincible-nerd">
<meta property="article:tag" content="Nodejs">
<meta property="article:tag" content="MongoDB">
<meta property="article:tag" content="Heroku">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://invincible-nerd.github.io/2022/11/28/Web-Developer-Bootcamp/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Web Developer Bootcamp | IVN</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">IVN</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://invincible-nerd.github.io/2022/11/28/Web-Developer-Bootcamp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="invincible-nerd">
      <meta itemprop="description" content="For explorer everywhere">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IVN">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Web Developer Bootcamp
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-11-28 23:21:41" itemprop="dateCreated datePublished" datetime="2022-11-28T23:21:41+08:00">2022-11-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-29 15:34:21" itemprop="dateModified" datetime="2022-11-29T15:34:21+08:00">2022-11-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>44k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>40 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Web-Developer-Bootcamp"><a href="#Web-Developer-Bootcamp" class="headerlink" title="Web Developer Bootcamp"></a>Web Developer Bootcamp</h1><h2 id="1-快捷键"><a href="#1-快捷键" class="headerlink" title="1. 快捷键"></a>1. 快捷键</h2><p>ctrl shift p : format document</p>
<p>a tab</p>
<p>lorem</p>
<p>ctrl &#x2F;</p>
<p>inp tab</p>
<p>! 标准html初始化</p>
<h2 id="2-HTML5"><a href="#2-HTML5" class="headerlink" title="2. HTML5"></a>2. HTML5</h2><p>HTML is not a version, but a standard.</p>
<p>You can’t turn off HTML5!</p>
<ul>
<li><p>inline elements</p>
<ul>
<li><p>a    anchor</p>
</li>
<li><p>span </p>
<p>generic element</p>
</li>
</ul>
</li>
<li><p>block elements</p>
<ul>
<li><p>p    paragraph</p>
</li>
<li><p>div  division</p>
<p>generic element</p>
</li>
</ul>
</li>
</ul>
<p>hr: a segment line</p>
<p>br: a line break</p>
<p>sup: superscript</p>
<p>sub: subscript</p>
<h3 id="HTML-Entities：start-with-ampersand-amp-end-with-semicolon"><a href="#HTML-Entities：start-with-ampersand-amp-end-with-semicolon" class="headerlink" title="HTML Entities：start with ampersand&amp;, end with semicolon;"></a>HTML Entities：start with ampersand&amp;, end with semicolon;</h3><ul>
<li>greater than： </li>
<li>less than：</li>
</ul>
<h3 id="Semantic-Markup-meaningful-markup-accessibility"><a href="#Semantic-Markup-meaningful-markup-accessibility" class="headerlink" title="Semantic Markup: meaningful markup       accessibility"></a>Semantic Markup: meaningful markup       accessibility</h3><p>not div, but</p>
<ul>
<li>main</li>
<li>nav</li>
<li>section</li>
<li>article</li>
<li>aside</li>
<li>header</li>
<li>footer</li>
<li>time</li>
<li>figure<ul>
<li>figcaption</li>
</ul>
</li>
</ul>
<h3 id="Emmet"><a href="#Emmet" class="headerlink" title="Emmet:"></a>Emmet:</h3><ul>
<li>child: &gt;</li>
<li>sibling: +</li>
<li>multiplication:  *</li>
<li>item numbering: $</li>
</ul>
<h3 id="table"><a href="#table" class="headerlink" title="table:"></a>table:</h3><ul>
<li>tr : table row</li>
<li>td : single data cell</li>
<li>th : single header:<ul>
<li>rowspan&#x3D;”2”</li>
<li>colspan&#x3D;”2”</li>
</ul>
</li>
<li>thead</li>
<li>tbody</li>
<li>tfoot</li>
</ul>
<h3 id="form"><a href="#form" class="headerlink" title="form:"></a>form:</h3><ul>
<li><p>empty container for data inputs</p>
</li>
<li><p>specify how and where the data should be sent</p>
</li>
<li><p>action: where the http request should be sent</p>
</li>
<li><p>method: “get” “post”</p>
</li>
<li><p>input: </p>
<ul>
<li>type:<ul>
<li>text</li>
<li>password</li>
<li>email: pattern</li>
<li>url: pattern</li>
<li>color: color picker</li>
<li>file</li>
<li>number:<ul>
<li>min</li>
<li>max</li>
<li>step</li>
</ul>
</li>
<li>time</li>
<li>range:<ul>
<li>id + label for</li>
<li>name</li>
<li>min</li>
<li>max</li>
<li>value: initial value</li>
<li>step</li>
</ul>
</li>
<li>radio:<ul>
<li>one name for a group of radio</li>
<li>id</li>
<li>label for</li>
<li>value 绑定 name</li>
</ul>
</li>
<li>checkbox:<ul>
<li>name 选中后属性为on，不选中则没有该属性</li>
<li>id</li>
<li>label for 绑定 id</li>
<li>checked</li>
</ul>
</li>
<li>submit:<ul>
<li>value</li>
</ul>
</li>
</ul>
</li>
<li>placeholder </li>
<li>label + input<ul>
<li>input id name</li>
<li>label for</li>
</ul>
</li>
</ul>
</li>
<li><p>button:</p>
<ul>
<li>type:<ul>
<li>submit (default)</li>
<li>button</li>
</ul>
</li>
</ul>
</li>
<li><p>select:</p>
<ul>
<li>name</li>
<li>id</li>
<li>option:<ul>
<li>value</li>
<li>selected</li>
</ul>
</li>
</ul>
</li>
<li><p>textarea:</p>
<ul>
<li>id + label for</li>
<li>name</li>
<li>placeholder</li>
<li>rows </li>
<li>cols</li>
</ul>
</li>
</ul>
<h3 id="validation"><a href="#validation" class="headerlink" title="validation:"></a>validation:</h3><ul>
<li>browser side validation:<ul>
<li>html built-in :<ul>
<li>required</li>
<li>minlength</li>
<li>maxlength</li>
<li>min</li>
<li>max</li>
<li>pattern : regular expression: a pattern</li>
<li>type: <ul>
<li>url</li>
<li>email</li>
<li>tel</li>
</ul>
</li>
</ul>
</li>
<li>javascript</li>
</ul>
</li>
<li>server side validation</li>
</ul>
<h2 id="3-CSS"><a href="#3-CSS" class="headerlink" title="3. CSS"></a>3. CSS</h2><p>cascading style sheets</p>
<p>selector {</p>
<p>​        property: value;</p>
<p>}</p>
<p>where:</p>
<ol>
<li>inline style&#x3D;”color: green”   bad!</li>
<li>head style</li>
<li>css file + link :<ul>
<li>href</li>
<li>rel&#x3D;”stylesheet”</li>
</ul>
</li>
</ol>
<p>color: text color</p>
<p>background-color</p>
<p>font-size:</p>
<ul>
<li>px : not recommended for responsive websites</li>
</ul>
<h3 id="CSS-selector"><a href="#CSS-selector" class="headerlink" title="CSS selector:"></a>CSS selector:</h3><ul>
<li><p>universal selector:</p>
<ul>
<li><ul>
<li></li>
</ul>
</li>
</ul>
</li>
<li><p>h1 ,h2</p>
</li>
<li><p>id selector:</p>
<ul>
<li>#signup</li>
</ul>
</li>
<li><p>class selector:</p>
<ul>
<li>.tag</li>
</ul>
</li>
<li><p>descendant selector: (generic descendant)</p>
<ul>
<li>li a</li>
<li>span a </li>
<li>.tag a</li>
</ul>
</li>
<li><p>adjacent selector: (immediately after)</p>
<ul>
<li>h1 + p</li>
</ul>
</li>
<li><p>direct child: (direct descendant)</p>
<ul>
<li>div &gt; li</li>
</ul>
</li>
<li><p>attribute selector:</p>
<ul>
<li>input[type&#x3D;”password”]</li>
<li>section[class&#x3D;”post”]</li>
<li>a[href*&#x3D;”google”]  <ul>
<li>contains</li>
</ul>
</li>
</ul>
</li>
<li><p>pseudo class:</p>
<ul>
<li>button:hover</li>
<li>.post a:hover</li>
<li>button:active</li>
<li>.post:nth-of-type(2n)</li>
<li>.post:nth-of-type(2n-1)</li>
</ul>
</li>
<li><p>pseudo element:</p>
<ul>
<li>h2::first-letter</li>
<li>p::first-line</li>
<li>p::selection</li>
<li>::selection</li>
</ul>
</li>
</ul>
<p>“cascade”: order matters!</p>
<h3 id="specificity"><a href="#specificity" class="headerlink" title="specificity:"></a>specificity:</h3><ul>
<li><p>The more specific selector wins!</p>
</li>
<li><p>id &gt; class, attribute, pseudo class &gt; element, pseudo element</p>
</li>
<li><p>!important</p>
</li>
<li><p>inherit</p>
</li>
</ul>
<h3 id="CSS-box-model"><a href="#CSS-box-model" class="headerlink" title="CSS box model"></a>CSS box model</h3><ul>
<li>content box:<ul>
<li>width</li>
<li>height</li>
</ul>
</li>
<li>padding</li>
<li>margin</li>
<li>border</li>
</ul>
<h2 id="4-JS"><a href="#4-JS" class="headerlink" title="4.JS"></a>4.JS</h2><h3 id="loop"><a href="#loop" class="headerlink" title="loop:"></a>loop:</h3><ul>
<li><p>for of: 遍历iterable</p>
</li>
<li><p>for in: object</p>
</li>
</ul>
<h3 id="scope"><a href="#scope" class="headerlink" title="scope:"></a>scope:</h3><ul>
<li>var 只限定function scope, 不限定block scope( loop, conditional)</li>
<li>let 限定block scope</li>
<li>const 限定block scope</li>
</ul>
<h3 id="callback；"><a href="#callback；" class="headerlink" title="callback；"></a>callback；</h3><p>A callback function is a function passed into another function as an argument, which is then invoked inside the outer function to complete some kind of routine or action.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> nums=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//array.forEach(function)</span></span><br><span class="line">nums.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">num</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(num%<span class="number">2</span>==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//array.map(function)</span></span><br><span class="line"><span class="keyword">const</span> doubles=nums.<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params">num</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> num*<span class="number">2</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//arrow function</span></span><br><span class="line"><span class="keyword">const</span> double=nums.<span class="title function_">map</span>(<span class="function">(<span class="params">num</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num*<span class="number">2</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//arrow function implicit return</span></span><br><span class="line"><span class="keyword">const</span> double1=nums.<span class="title function_">map</span>(<span class="function">(<span class="params">num</span>)=&gt;</span>&#123;</span><br><span class="line">    num*<span class="number">2</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> double2=nums.<span class="title function_">map</span>(<span class="function"><span class="params">num</span>=&gt;</span>num*<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//setTimeOut(function,t)</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line"><span class="title function_">setTimeOut</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;...Are you still there?&quot;</span>)</span><br><span class="line">&#125;,<span class="number">3000</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;I SHOULD BE THE SECOND LINE&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//setInterval(function,t)</span></span><br><span class="line"><span class="keyword">const</span> id=<span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>());</span><br><span class="line">&#125;,<span class="number">2000</span>);</span><br><span class="line"><span class="built_in">clearInterval</span>(id);</span><br><span class="line"></span><br><span class="line"><span class="comment">//array.filter(function)</span></span><br><span class="line"><span class="keyword">const</span> filters=nums.<span class="title function_">filter</span>(<span class="function"><span class="params">num</span>=&gt;</span>num%<span class="number">2</span>==<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//&quot;sum of all&quot;</span></span><br><span class="line"><span class="keyword">const</span> total=nums.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total,price</span>)=&gt;</span>total+price)</span><br><span class="line"></span><br><span class="line"><span class="comment">//&quot;product of all&quot;</span></span><br><span class="line"><span class="keyword">const</span> total=nums.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total,price</span>)=&gt;</span>total*price)</span><br><span class="line"></span><br><span class="line"><span class="comment">//&quot;minimum of all&quot;</span></span><br><span class="line"><span class="keyword">const</span> min=nums.<span class="title function_">reduce</span>(<span class="function">(<span class="params">min,num</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//the return value becomes the next min</span></span><br><span class="line">    <span class="comment">//num start from nums[1] to nums[n-1]</span></span><br><span class="line">    <span class="keyword">if</span>(min&lt;num)&#123;</span><br><span class="line">        <span class="keyword">return</span> num;	</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> min;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//reduce with initial value 100</span></span><br><span class="line"><span class="keyword">const</span> total=nums.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total,num</span>)=&gt;</span>total+num,<span class="number">100</span>)</span><br></pre></td></tr></table></figure>



<h4 id="synchronous-callback"><a href="#synchronous-callback" class="headerlink" title="synchronous callback:"></a>synchronous callback:</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function greeting(name) &#123;</span><br><span class="line">  alert(`Hello, $&#123;name&#125;`);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function processUserInput(callback) &#123;</span><br><span class="line">  const name = prompt(&#x27;Please enter your name.&#x27;);</span><br><span class="line">  callback(name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">processUserInput(greeting);</span><br></pre></td></tr></table></figure>



<h4 id="asynchronous-callback"><a href="#asynchronous-callback" class="headerlink" title="asynchronous callback:"></a>asynchronous callback:</h4><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Glossary/Callback_function">https://developer.mozilla.org/en-US/docs/Glossary/Callback_function</a></p>
<h3 id="this"><a href="#this" class="headerlink" title="this:"></a>this:</h3><ul>
<li><p>“this” in regular function:  </p>
<ul>
<li><strong>whoever calling it; object before “.”</strong></li>
<li>how it is executed!</li>
</ul>
</li>
<li><p>“this” in arrow function: </p>
<ul>
<li><strong>the scope that it was created in</strong> </li>
<li>where it is created!</li>
</ul>
</li>
</ul>
<h3 id="spread"><a href="#spread" class="headerlink" title="spread:"></a>spread:</h3><ol>
<li>iterables:</li>
</ol>
<ul>
<li>array</li>
<li>string</li>
</ul>
<ol start="2">
<li>objects</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="title function_">max</span>(...[<span class="number">10</span>,<span class="number">5</span>,<span class="number">7</span>])</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(...<span class="string">&quot;Happy&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr1=[<span class="number">5</span>,<span class="number">8</span>]</span><br><span class="line"><span class="keyword">const</span> arr2=[<span class="number">1</span>,<span class="number">6</span>]</span><br><span class="line"><span class="keyword">const</span> arr=[...arr1,...arr2]</span><br></pre></td></tr></table></figure>



<h3 id="arguments"><a href="#arguments" class="headerlink" title="arguments:"></a>arguments:</h3><p>like an array but not an array</p>
<h3 id="rest"><a href="#rest" class="headerlink" title="rest:"></a>rest:</h3><p>an actual array</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params">...nums</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> nums.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total,el</span>)=&gt;</span>total+el);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="destructuring："><a href="#destructuring：" class="headerlink" title="destructuring："></a>destructuring：</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> scores=[<span class="number">100</span>,<span class="number">99</span>,<span class="number">98</span>,<span class="number">67</span>,<span class="number">59</span>]</span><br><span class="line"><span class="keyword">const</span> [first,second,...everyoneElse]=scores</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;<span class="attr">born</span>:birthYear, <span class="attr">deathYear</span>:dead =<span class="string">&#x27;N/A&#x27;</span>&#125;=user	<span class="comment">//destructuring object; rename variable; with default value</span></span><br></pre></td></tr></table></figure>





<h2 id="5-DOM"><a href="#5-DOM" class="headerlink" title="5.DOM"></a>5.DOM</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">dir</span>(<span class="variable language_">document</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">all</span>[<span class="number">10</span>].<span class="property">innerText</span>=<span class="string">&quot;New&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//select the JavaScript object</span></span><br><span class="line"><span class="keyword">const</span> toc=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;toc&quot;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">dir</span>(toc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> allImages=<span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;img&quot;</span>)	<span class="comment">//a HTML Collection, consisting of HTML Elements, not an array</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">dir</span>(allImages[<span class="number">0</span>])	</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> image <span class="keyword">of</span> allImages)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(image.<span class="property">src</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> squareImages=<span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;square&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//querySelector</span></span><br><span class="line"><span class="keyword">const</span> firstPTag=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> firstPId=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#p&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> firstPClass=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.p&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;a[title=&#x27;Java&#x27;]&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;a&quot;</span>)</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;p a&quot;</span>)</span><br></pre></td></tr></table></figure>



<ul>
<li><p>innerText</p>
</li>
<li><p>textContent</p>
</li>
<li><p>innerHTML</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;h1&quot;</span>).<span class="property">innerHTML</span> += <span class="string">&quot;&lt;sup&gt;superscript&lt;/sup&gt;&quot;</span></span><br></pre></td></tr></table></figure>




</li>
<li><p>attribute</p>
</li>
<li><p>style</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> allLinks=<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;a&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> link <span class="keyword">of</span> allLinks)&#123;</span><br><span class="line">    link.<span class="property">style</span>.<span class="property">color</span>=<span class="string">&quot;magenta&quot;</span></span><br><span class="line">    link.<span class="property">style</span>.<span class="property">textDecorationColor</span>=<span class="string">&quot;olive&quot;</span></span><br><span class="line">    link.<span class="property">style</span>.<span class="property">textDecorationStyle</span>=<span class="string">&quot;wavy&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">const</span> h1=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;h1&quot;</span>)</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">getComputedStyle</span>(h1).<span class="property">fontSize</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ul>
<li>classList</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const h2=document.querySelector(&quot;h2&quot;)</span><br><span class="line">h2.classList.add(&quot;border&quot;)</span><br><span class="line">h2.classList.remove(&quot;purple&quot;)</span><br><span class="line">h2.classList.contains(&quot;green&quot;)	//false</span><br><span class="line"></span><br><span class="line">//on and off</span><br><span class="line">h2.classList.toggle(&quot;purple&quot;)</span><br><span class="line">h2.classList.toggle(&quot;purple&quot;)</span><br><span class="line">h2.classList.toggle(&quot;purple&quot;)</span><br></pre></td></tr></table></figure>



<ul>
<li>parentElement</li>
<li>children      &#x2F;&#x2F;HTMLCollection</li>
<li>nextElementSibling</li>
<li>previousElementSibling</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//appendChild</span></span><br><span class="line"><span class="keyword">const</span> newH3=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;h3&quot;</span>)</span><br><span class="line">newH3.<span class="property">innerText</span>=<span class="string">&quot;I AM NEW&quot;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendCHild</span>(newH3)</span><br><span class="line"></span><br><span class="line"><span class="comment">//append </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//prepend</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//insertAjacentElement</span></span><br><span class="line"><span class="keyword">const</span> h4=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;h4&quot;</span>)</span><br><span class="line">h4.<span class="title function_">append</span>(<span class="string">&quot;hhhh&quot;</span>)</span><br><span class="line">newH3.<span class="title function_">insertAjacentElement</span>(<span class="string">&quot;afterend&quot;</span>,h4)	<span class="comment">//newH3.nextElementSibling</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//removeChild()</span></span><br><span class="line">img.<span class="property">parentElement</span>.<span class="title function_">removeChild</span>(img)</span><br><span class="line"><span class="comment">//remove()</span></span><br><span class="line">img.<span class="title function_">remove</span>()</span><br></pre></td></tr></table></figure>





<h2 id="6-DOM-events"><a href="#6-DOM-events" class="headerlink" title="6.DOM events"></a>6.DOM events</h2><h3 id="button"><a href="#button" class="headerlink" title="button"></a>button</h3><ul>
<li>onclick</li>
<li>ondblclick</li>
<li>onmouseenter</li>
<li>onmouseleave</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> btn=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;button&quot;</span>)</span><br><span class="line"></span><br><span class="line">btn.<span class="property">onclick</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;HAHAHA!!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//recommended, generic way</span></span><br><span class="line">btn.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;You clicked me!!!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">btn.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>,shout)</span><br><span class="line">btn.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>,twist)	<span class="comment">//can coexist!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//not recommended</span></span><br><span class="line">btn.<span class="property">onclick</span>=shout</span><br><span class="line">btn.<span class="property">onclick</span>=twist	<span class="comment">//shout is lost, can not coexit</span></span><br></pre></td></tr></table></figure>



<h3 id="keyboard-event-objects"><a href="#keyboard-event-objects" class="headerlink" title="(keyboard) event objects"></a>(keyboard) event objects</h3><ul>
<li>keydown</li>
<li>keyup</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> input=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;input&quot;</span>)</span><br><span class="line">input.<span class="title function_">addEventListener</span>(<span class="string">&quot;keydown&quot;</span>,<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">key</span>)	<span class="comment">//q	</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">code</span>)	<span class="comment">//KeyQ</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;keydown&quot;</span>,<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">code</span>)	<span class="comment">//ArrowUp, ArrowLeft, ArrowRight, ArrowDown</span></span><br><span class="line">    <span class="keyword">switch</span>(e.<span class="property">code</span>)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;ArrowUp&quot;</span>:</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;UP&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;ArrowDown&quot;</span>:</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;DOWN&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;IGNORED!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="form-event"><a href="#form-event" class="headerlink" title="form event"></a>form event</h3><p>form action: send form data to the url, and switch to that url</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/url&quot;</span>&gt;</span>	</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;catName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span>&gt;</span></span><br><span class="line">        Submit</span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br><span class="line">    Available Cats</span><br><span class="line"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;cats&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>to stay in the same page after submitting form: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> form=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;form&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> input=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#catName&quot;</span>)	<span class="comment">//input.value</span></span><br><span class="line"><span class="keyword">const</span> list=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#cats&quot;</span>)</span><br><span class="line"></span><br><span class="line">form.<span class="title function_">addEventListener</span>(<span class="string">&quot;submit&quot;</span>,<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Submitted the form!&quot;</span>)</span><br><span class="line">    <span class="keyword">const</span> name=input.<span class="property">value</span>;</span><br><span class="line">    <span class="keyword">const</span> newLi=<span class="variable language_">document</span>.<span class="title class_">CreateElement</span>(<span class="string">&quot;li&quot;</span>)</span><br><span class="line">    newLi.<span class="property">innerText</span>=name</span><br><span class="line">    list.<span class="title function_">append</span>(newLi)	<span class="comment">//list.appendChild(newLi)</span></span><br><span class="line">    input.<span class="property">value</span>=<span class="string">&quot;&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="input-event"><a href="#input-event" class="headerlink" title="input event"></a>input event</h3><ul>
<li>change event</li>
<li>input event</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> h1=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;h1&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> input=docuemnt.<span class="title function_">querySelector</span>(<span class="string">&quot;input&quot;</span>)</span><br><span class="line">input.<span class="title function_">addEventListener</span>(<span class="string">&quot;input&quot;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    h1.<span class="property">innerText</span>=input.<span class="property">value</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="event-bubbling"><a href="#event-bubbling" class="headerlink" title="event bubbling"></a>event bubbling</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.hide</span>&#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;changeColor&quot;</span>&gt;</span></span><br><span class="line">        change color</span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> container=docuemnt.<span class="title function_">querySelector</span>(<span class="string">&quot;#container&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> button=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#changeColor&quot;</span>)</span><br><span class="line">container.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    container.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">&quot;hide&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">changeColor</span>=(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> r=<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">255</span>)</span><br><span class="line">    <span class="keyword">const</span> g=<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">255</span>)</span><br><span class="line">    <span class="keyword">const</span> b=<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">255</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`rgb(<span class="subst">$&#123;r&#125;</span>,<span class="subst">$&#123;g&#125;</span>,<span class="subst">$&#123;b&#125;</span>)`</span></span><br><span class="line">&#125;</span><br><span class="line">button.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>,<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">    container.<span class="property">style</span>.<span class="property">backgroundColor</span>=<span class="title function_">makeRandColor</span>()</span><br><span class="line">    e.<span class="title function_">stopPropagation</span>();	<span class="comment">//stop bubbling!</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="event-delegation"><a href="#event-delegation" class="headerlink" title="event delegation"></a>event delegation</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> container=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#list&quot;</span>)</span><br><span class="line">container.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>,<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    <span class="comment">//console.log(&quot;Click on ul&quot;)</span></span><br><span class="line">    <span class="comment">//e.target.remove()</span></span><br><span class="line">    e.<span class="property">target</span>.<span class="property">nodeName</span>===<span class="string">&quot;LI&quot;</span> &amp;&amp; e.<span class="property">target</span>.<span class="title function_">remove</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id=""><a href="#" class="headerlink" title=""></a></h3><h2 id="7-Asynchronous-JavaScript"><a href="#7-Asynchronous-JavaScript" class="headerlink" title="7. Asynchronous JavaScript"></a>7. Asynchronous JavaScript</h2><h3 id="call-stack"><a href="#call-stack" class="headerlink" title="call stack"></a>call stack</h3><h3 id="js-is-single-threaded"><a href="#js-is-single-threaded" class="headerlink" title="js is single-threaded!"></a>js is single-threaded!</h3><h3 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h3><ul>
<li>pending</li>
<li>resolved</li>
<li>rejected</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> request=<span class="title function_">fakeRequestPromise</span>(<span class="string">&quot;yelp.com/api/coffee&quot;</span>)</span><br><span class="line">request.<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;IT WORKED!!!!&quot;</span>)</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;OH NO, ERROR!!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="title function_">fakeRequestPromise</span>(<span class="string">&quot;yelp.com/api/coffee/page1&quot;</span>).<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;IT WORKED!!!!(page1)&quot;</span>)</span><br><span class="line">    <span class="title function_">fakeRequestPromise</span>(<span class="string">&quot;yelp.com/api/coffee/page2&quot;</span>).<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;IT WORKED!!!!(page2)&quot;</span>)</span><br><span class="line">    	&#125;).<span class="title function_">catch</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;OH NO, ERROR!!&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;OH NO, ERROR!!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//promise chain: dependent asynchronous functions</span></span><br><span class="line"><span class="title function_">fakeRequestPromise</span>(<span class="string">&quot;yelp.com/api/coffee/page1&quot;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;IT WORKED!!!!(page1)&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fakeRequestPromise</span>(<span class="string">&quot;yelp.com/api/coffee/page2&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;IT WORKED!!!!(page2)&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fakeRequestPromise</span>(<span class="string">&quot;yelp.com/api/coffee/page3&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;IT WORKED!!!!(page3)&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">&#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;OH NO, A REQUEST FAILED!!&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//create a promise</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">fakeRequest</span>=(<span class="params">url</span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> rand=<span class="title class_">Math</span>.<span class="title function_">random</span>()</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(rand&gt;<span class="number">0.7</span>)&#123;</span><br><span class="line">                <span class="title function_">resolve</span>(<span class="string">&quot;Your fake data here&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_">reject</span>(<span class="string">&quot;Request error&quot;</span>)</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fakeRequest</span>(<span class="string">&#x27;/dogs/1&#x27;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;DONE WITH REQUEST&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Your data is: &quot;</span>,data)</span><br><span class="line">&#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;OH NO, ERROR&quot;</span>+err)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//example: rainbow</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">delayedColorChange</span>=(<span class="params">color, delay</span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">backgroundColor</span>=color</span><br><span class="line">            <span class="title function_">resolve</span>()</span><br><span class="line">        &#125;, delay)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">delayedColorChange</span>(<span class="string">&quot;red&quot;</span>,<span class="number">1000</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">()=&gt;</span><span class="title function_">delayedColorChange</span>(<span class="string">&quot;orange&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">()=&gt;</span><span class="title function_">delayedColorChange</span>(<span class="string">&quot;yellow&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">()=&gt;</span><span class="title function_">delayedColorChange</span>(<span class="string">&quot;green&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">()=&gt;</span><span class="title function_">delayedColorChange</span>(<span class="string">&quot;blue&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">()=&gt;</span><span class="title function_">delayedColorChange</span>(<span class="string">&quot;indigo&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">()=&gt;</span><span class="title function_">delayedColorChange</span>(<span class="string">&quot;violet&quot;</span>,<span class="number">1000</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="async"><a href="#async" class="headerlink" title="async"></a>async</h3><ul>
<li>syntax sugar</li>
<li><strong>async function always returns Promise()</strong></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">sing</span>= <span class="keyword">async</span>(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="string">&quot;OH NO&quot;</span>	<span class="comment">//a rejected Promise</span></span><br><span class="line">    <span class="comment">//after throw, becomes a rejected Promise</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;LA LA LA&quot;</span>	<span class="comment">//a resolved Promise</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">sing</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">login</span> = <span class="keyword">async</span>(<span class="params">username, password</span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">if</span>(!username || !password) <span class="keyword">throw</span> <span class="string">&quot;Missing Credentials&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(password === <span class="string">&quot;ivnwth&quot;</span>) <span class="keyword">return</span> <span class="string">&quot;Welcome&quot;</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="string">&quot;Invalid Password&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">login</span>(<span class="string">&quot;wrong input&quot;</span>)</span><br><span class="line">	.<span class="title function_">then</span>(<span class="function"><span class="params">msg</span>=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line">	.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="await"><a href="#await" class="headerlink" title="await"></a>await</h3><p>only valid when inside async functions</p>
<p><strong>wait for a Promise to be resolved</strong> </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">rainbow</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">delayedColorChange</span>(<span class="string">&quot;red&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    <span class="comment">//without await, won&#x27;t see red color because codes happen at the same time!!</span></span><br><span class="line">    <span class="comment">//with await, first see red, then see orange, ...</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">delayedColorChange</span>(<span class="string">&quot;orange&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">delayedColorChange</span>(<span class="string">&quot;yellow&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">delayedColorChange</span>(<span class="string">&quot;green&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">delayedColorChange</span>(<span class="string">&quot;blue&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">delayedColorChange</span>(<span class="string">&quot;indigo&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">delayedColorChange</span>(<span class="string">&quot;violet&quot;</span>,<span class="number">1000</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ALL DONE&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">rainbow</span>().<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;End of rainbow&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fakeRequest = (<span class="function"><span class="params">url0</span> =&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> delay = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*(<span class="number">4500</span>))+<span class="number">500</span>;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(delay&gt;<span class="number">4000</span>)&#123;</span><br><span class="line">                <span class="title function_">reject</span>(<span class="string">&quot;Connection Timeout:(&quot;</span>)</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="title function_">resolve</span>(<span class="string">`Here is your fake data from <span class="subst">$&#123;url&#125;</span>`</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, delay)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">                     </span><br><span class="line"><span class="keyword">async</span> <span class="title function_">makeTwoRequests</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> data1=<span class="keyword">await</span> <span class="title function_">fakeRequest</span>(<span class="string">&quot;/page1&quot;</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data1)</span><br><span class="line">        <span class="keyword">let</span> data2=<span class="keyword">await</span> <span class="title function_">fakeRequest</span>(<span class="string">&quot;/page2&quot;</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data2)</span><br><span class="line">&#125;                     </span><br></pre></td></tr></table></figure>





<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">makeTwoRequest</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> data1=<span class="keyword">await</span> <span class="title function_">fakeRequest</span>(<span class="string">&quot;/page1&quot;</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data1)</span><br><span class="line">        <span class="keyword">let</span> data2=<span class="keyword">await</span> <span class="title function_">fakeRequest</span>(<span class="string">&quot;/page2&quot;</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data2)</span><br><span class="line">    &#125;<span class="keyword">catch</span>(err)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="8-AJAX"><a href="#8-AJAX" class="headerlink" title="8.AJAX"></a>8.AJAX</h2><ul>
<li>request a <strong>web API</strong>, and get a JSON string in return, instead of HTML, CSS and JavaScript<ul>
<li>JSON.parse(string)</li>
<li>JSON.stringify(object)</li>
</ul>
</li>
<li>AJAX? AJAJ!</li>
<li>JSON: JavaScript Object Notation</li>
</ul>
<h3 id="HTTP-Verbs"><a href="#HTTP-Verbs" class="headerlink" title="HTTP Verbs"></a>HTTP Verbs</h3><ul>
<li>get        &#x2F;&#x2F;get data through APIs<ul>
<li>a GET request <strong>cannot</strong> have <strong>req.body</strong>, only <strong>req.query</strong></li>
</ul>
</li>
<li>post      &#x2F;&#x2F;send data and store somewhere</li>
<li>put        &#x2F;&#x2F;completely update</li>
<li>patch    &#x2F;&#x2F;partly update data</li>
<li>delete</li>
</ul>
<h3 id="HTTP-Status-Codes"><a href="#HTTP-Status-Codes" class="headerlink" title="HTTP Status Codes"></a>HTTP Status Codes</h3><p>1:</p>
<p>2: success</p>
<p>3: redirection</p>
<p>4: client error</p>
<p>5: server error</p>
<h3 id="Query-string"><a href="#Query-string" class="headerlink" title="Query string"></a>Query string</h3><h3 id="Headers"><a href="#Headers" class="headerlink" title="Headers"></a>Headers</h3><ul>
<li>request header<ul>
<li>Accept: <ol>
<li>text&#x2F;html</li>
<li>application&#x2F;json</li>
<li>text&#x2F;plain</li>
</ol>
</li>
</ul>
</li>
<li>response header</li>
</ul>
<h3 id="XHRs"><a href="#XHRs" class="headerlink" title="XHRs"></a>XHRs</h3><p>old, unrecommended way</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> req=<span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"></span><br><span class="line">req.<span class="property">onload</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;IT LOADED!!&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">this</span>.<span class="property">responseText</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">req.<span class="property">onerror</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ERROR!!&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">req.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;https://swapi.dev/api/people/1&quot;</span>);</span><br><span class="line">req.<span class="title function_">send</span>();</span><br></pre></td></tr></table></figure>







<h3 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h3><p>return a Promise</p>
<p>res.json() also returns a Promise</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;https://swapi.dev/api/people/1&quot;</span>)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;RESOLVED!&quot;</span>,res);</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">json</span>();</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;JSON DONE&quot;</span>,data);</span><br><span class="line">      &#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ERROR!&quot;</span>,e);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//a series of request</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">loadPeople</span>= <span class="keyword">async</span>(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> res1=<span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;https://swapi.dev/api/people/1&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> data1=<span class="keyword">await</span> res1.<span class="title function_">json</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data1);</span><br><span class="line">        <span class="keyword">const</span> res2=<span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;https://swapi.dev/api/people/2&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> data2=<span class="keyword">await</span> res2.<span class="title function_">json</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data2);</span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ERROR!&quot;</span>,e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">loadPeople</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h3><p>axios.get() returns a data object</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="title function_">get</span>(<span class="string">&quot;https://swapi.dev/api/people/1&quot;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;RESPONSE:&quot;</span>,res);</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ERROR!&quot;</span>,e);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<p>axios.get(api, config_object)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">getDadJoke</span>= <span class="keyword">async</span>(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> config=&#123;<span class="attr">header</span>:&#123;<span class="title class_">Accept</span>: <span class="string">&quot;application/json&quot;</span>&#125;&#125;;</span><br><span class="line">    	<span class="keyword">const</span> res=<span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&quot;https://icanhazdadjoke.com/&quot;</span>,config);</span><br><span class="line">    	<span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>.<span class="property">joke</span>);</span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="9-OOP"><a href="#9-OOP" class="headerlink" title="9.OOP"></a>9.OOP</h2><p>Array.prototype 和 String.prototype 可定义自定义方法，可override默认方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">String</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">grumpus</span>=<span class="function">()=&gt;</span><span class="title function_">alert</span>(<span class="string">&quot;GO AWAY!!&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cat=<span class="string">&quot;cat&quot;</span>;</span><br><span class="line">cat.<span class="title function_">grumpus</span>();</span><br><span class="line"></span><br><span class="line"><span class="title class_">String</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">yell</span>=<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`OMG!!!<span class="subst">$&#123;<span class="variable language_">this</span>.toUpperCase()&#125;</span>!!!!!!`</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="string">&quot;i love you&quot;</span>.<span class="title function_">yell</span>();</span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>	<span class="comment">//actual template object</span></span><br><span class="line">[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>].<span class="property">__proto__</span>	<span class="comment">//reference to Array.prototype, no need to use it </span></span><br></pre></td></tr></table></figure>



<p>syntactic sugar</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Color</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">r,g,b,name</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">r</span>=r;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">g</span>=g;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">b</span>=b;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span>=name;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">calcHSL</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="title function_">greet</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`HELLO FROM COLOR <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">rgb</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;r,g,b&#125;=<span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`rgb(<span class="subst">$&#123;r&#125;</span>,<span class="subst">$&#123;g&#125;</span>,<span class="subst">$&#123;b&#125;</span>)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">hex</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;r,g,b&#125;=<span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;#&#x27;</span>+((<span class="number">1</span>&lt;&lt;<span class="number">24</span>)+(r&lt;&lt;<span class="number">16</span>)+(g&lt;&lt;<span class="number">8</span>)+b).<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">slice</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">calcHSL</span>(<span class="params"></span>)&#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="comment">//adding new values to this object</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">h</span>=h;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">s</span>=s;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">l</span>=l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">const</span> c1=<span class="keyword">new</span> <span class="title class_">Color</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>,<span class="string">&quot;blue&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> c2=<span class="keyword">new</span> <span class="title class_">Color</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="string">&quot;white&quot;</span>);</span><br><span class="line">c1.<span class="property">hex</span>===c2.<span class="property">hex</span>		<span class="comment">//true</span></span><br></pre></td></tr></table></figure>





<p>hsl:    hew([1,360]), saturation, lightness</p>
<h3 id="extends"><a href="#extends" class="headerlink" title="extends"></a>extends</h3><h3 id="super"><a href="#super" class="headerlink" title="super"></a>super</h3><p>调用父类的constructor</p>
<h2 id="10-Terminal"><a href="#10-Terminal" class="headerlink" title="10.Terminal"></a>10.Terminal</h2><ul>
<li>faster than GUI</li>
<li>all-access pass</li>
</ul>
<p>terminal:    </p>
<ul>
<li>a text-based interface to your computer</li>
<li>originally a physical object, but now we use software terminals</li>
</ul>
<p>shell:</p>
<ul>
<li>the program running on the terminal</li>
</ul>
<p>bash:</p>
<ul>
<li><p>one of the most popular shells</p>
</li>
<li><p>ls</p>
</li>
<li><p>pwd</p>
</li>
<li><p>cd</p>
</li>
<li><p>~ means home directory</p>
</li>
<li><p>&#x2F; means root directory</p>
</li>
<li><p>cd .. 后退一级 </p>
</li>
<li><p>cd &#x2F;</p>
</li>
<li><p>cd ~</p>
</li>
<li><p>mkdir Frogs&#x2F;TreeFrogs SugarGliders</p>
</li>
<li><p>touch index.html app.css app.js</p>
</li>
<li><p>rm index.html</p>
</li>
<li><p>rmdir 只能删空directory</p>
</li>
<li><p>rm -rf</p>
<ul>
<li>can delete (non-empty) directory</li>
<li>recursive </li>
<li>force</li>
</ul>
</li>
</ul>
<h3 id="man"><a href="#man" class="headerlink" title="man"></a>man</h3><ul>
<li>zsh 支持 man ls</li>
<li>bash 不支持</li>
</ul>
<h2 id="11-NodeJS"><a href="#11-NodeJS" class="headerlink" title="11.NodeJS"></a>11.NodeJS</h2><h3 id="Node-REPL"><a href="#Node-REPL" class="headerlink" title="Node REPL"></a>Node REPL</h3><p>Read Evaluate Print Loop</p>
<ul>
<li>.exit    &#x2F;&#x2F;ctrl+d</li>
<li>no <strong>window</strong>, but <strong>global</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node firstScript.js</span><br></pre></td></tr></table></figure>



<h3 id="process"><a href="#process" class="headerlink" title="process"></a>process</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">process.argv</span><br></pre></td></tr></table></figure>





<h3 id="fs"><a href="#fs" class="headerlink" title="fs"></a>fs</h3><ul>
<li>sync: try, catch</li>
<li>async: callback function</li>
</ul>
<h3 id="module-exports"><a href="#module-exports" class="headerlink" title="module.exports"></a>module.exports</h3><ol>
<li><p>export a single file</p>
<ul>
<li><p>export an object that other files can require</p>
</li>
<li><p>in the same directory: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> math=<span class="built_in">require</span>(<span class="string">&quot;./math&quot;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>export a directory</p>
<ul>
<li>该directory的<strong>index.js</strong> module.exports什么，其他文件就require到什么</li>
</ul>
</li>
</ol>
<h3 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h3><p>Node Package Manager</p>
<ol>
<li>a free library</li>
<li>a command line tool</li>
<li>normally and by default install <strong>locally</strong></li>
<li>or, installed globly, and <strong>npm link</strong></li>
</ol>
<h3 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h3><ul>
<li><p>npm init</p>
<p>npm init -y</p>
<p>创建package.json</p>
</li>
<li><p>npm install</p>
<p>根据package.json中的dependencies安装所有依赖包</p>
</li>
</ul>
<h2 id="12-Express"><a href="#12-Express" class="headerlink" title="12.Express"></a>12.Express</h2><h3 id="listen-amp-use"><a href="#listen-amp-use" class="headerlink" title="listen&amp;use"></a>listen&amp;use</h3><ul>
<li>libraries: You are in charge</li>
<li>framework: The framework is in charge!</li>
</ul>
<p>​        <strong>inversion of control</strong></p>
<ul>
<li><p>app.use(callback)</p>
<ul>
<li><p>express将html request&#x2F;response变成两个JS对象，传入callback</p>
</li>
<li><p>req: based on the incoming HTTP request</p>
</li>
<li><p>res: going to generate a HTTP response to the client</p>
<p><strong>can only have one request for one response</strong></p>
</li>
<li><p>res.send()</p>
<ul>
<li>可以传回html</li>
<li>也可以传回json</li>
</ul>
</li>
</ul>
</li>
<li><p>app.listen(8080,callback)</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app=<span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//anytime we have an incoming request</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;WE GOT A NEW REQUEST!!&quot;</span>);</span><br><span class="line">    <span class="comment">//console.dir(req);</span></span><br><span class="line">    <span class="comment">//res.send(&quot;HELLO, WE GOT YOUR REQUEST! THIS IS A RESPONSE!!&quot;);</span></span><br><span class="line">    res.<span class="title function_">send</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;ivn&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;HELLO WORLD!&quot;</span> &#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//start listening!</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8080</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;LISTENING ON PORT 8080&quot;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h3 id="routing"><a href="#routing" class="headerlink" title="routing"></a>routing</h3><p>app.get() only match get request</p>
<p>browser地址栏输入都是get request</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;&lt;h1&gt;IVN&lt;h1&gt;&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/r/:sub&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//console.log(req.params);</span></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">`Welcome to subpage: <span class="subst">$&#123;req.params.sub&#125;</span>`</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/r/:sub/:postId&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; sub, postId &#125; = req.<span class="property">params</span>;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">`&lt;h1&gt;Viewing PostID: <span class="subst">$&#123;postId&#125;</span> on <span class="subst">$&#123;sub&#125;</span>`</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//必须放最后</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;*&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;I don&#x27;t know that path!!&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="query-string"><a href="#query-string" class="headerlink" title="query string"></a>query string</h3><p>&#x2F;search?q&#x3D;cat</p>
<p>request.query</p>
<h3 id="nodemon"><a href="#nodemon" class="headerlink" title="nodemon"></a>nodemon</h3><p>automatic restart after change</p>
<h2 id="13-Templating"><a href="#13-Templating" class="headerlink" title="13.Templating"></a>13.Templating</h2><p>fill in the blank to create HTML</p>
<p>similar to <em>string template literal</em></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&quot;view engine&quot;</span>, <span class="string">&quot;ejs&quot;</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&quot;views&quot;</span>, path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;/views&quot;</span>));</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&quot;home.ejs&quot;</span>);	<span class="comment">//.ejs可以省略</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h3 id="EJS-syntax"><a href="#EJS-syntax" class="headerlink" title="EJS syntax"></a>EJS syntax</h3><ul>
<li>Embedded JS</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1&gt;</span><br><span class="line">    Page &lt;%=5+6-1 %&gt;</span><br><span class="line">&lt;/h1&gt;</span><br></pre></td></tr></table></figure>



<p>res.render还可以传对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> num = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">10</span>) + <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//res.render(&quot;home&quot;,&#123;allNum:num&#125;); </span></span><br><span class="line">    <span class="comment">//in ejs template: allNum</span></span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&quot;home&quot;</span>, &#123; num &#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<ul>
<li>show data</li>
<li>conditions</li>
<li>loops</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2&gt;Random number: &lt;%= num %&gt;</span><br><span class="line">    </span><br><span class="line">  </span><br><span class="line">&lt;%if (num%2==0)&#123;	%&gt;</span><br><span class="line">    &lt;h2&gt;</span><br><span class="line">        This is an even number!</span><br><span class="line">    &lt;/h2&gt;</span><br><span class="line">&lt;%&#125;	%&gt;</span><br></pre></td></tr></table></figure>



<h3 id="express-static"><a href="#express-static" class="headerlink" title="express.static()"></a>express.static()</h3><p>middleware</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//规定路径</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;public&#x27;</span>)));</span><br></pre></td></tr></table></figure>



<h3 id="ejs-partials"><a href="#ejs-partials" class="headerlink" title="ejs partials"></a>ejs partials</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include(&quot;partials/head&quot;)%&gt;</span><br></pre></td></tr></table></figure>





<h2 id="14-Bootstrap"><a href="#14-Bootstrap" class="headerlink" title="14.Bootstrap"></a>14.Bootstrap</h2><p>svg    fontawesome</p>
<h2 id="15-RESTful"><a href="#15-RESTful" class="headerlink" title="15.RESTful"></a>15.RESTful</h2><ul>
<li>get: <ul>
<li>query string</li>
<li>retrieve data, not creating anything</li>
</ul>
</li>
<li>post:<ul>
<li>request body</li>
<li>create data</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//built-in parsing middlewares	</span></span><br><span class="line"><span class="comment">//form data</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">true</span>&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">//json data</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/tacos&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;meat, qty&#125;=req.<span class="property">body</span>;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">`OK, here are your <span class="subst">$&#123;qty&#125;</span> <span class="subst">$&#123;meat&#125;</span> tacos!`</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<p>REpresentational State Transfer</p>
<ul>
<li>client-server architecture</li>
</ul>
<p>​        Can make requests from browser or Postman. Doesn’t matter where the request is coming from.</p>
<ul>
<li>statelessness</li>
</ul>
<p>​        Every request is on its own.</p>
<ul>
<li><p>uniform interface</p>
<p>combine <strong>URLs</strong> with <strong>HTTP methods</strong> to expose full <strong>CRUD operations</strong> over HTTP</p>
</li>
</ul>
<h3 id="Create"><a href="#Create" class="headerlink" title="Create"></a>Create</h3><ol>
<li><p>app.get(“&#x2F;comments&#x2F;new”)    一个包含form的页面，submit调用app.post()完成新建</p>
</li>
<li><p>app.post(“&#x2F;comments”)   </p>
</li>
<li><p>post完毕后，app.redirect(“&#x2F;comments”)</p>
<p>redirect默认为get</p>
</li>
</ol>
<h3 id="show-x2F-detail-route"><a href="#show-x2F-detail-route" class="headerlink" title="show&#x2F;detail route"></a>show&#x2F;detail route</h3><p>nested route</p>
<h3 id="uuid"><a href="#uuid" class="headerlink" title="uuid"></a>uuid</h3><p>v4</p>
<p>uuidv4()</p>
<h3 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h3><p>html form only supports GET and POST</p>
<p>however, <strong>method-override</strong></p>
<h2 id="16-MongoDB"><a href="#16-MongoDB" class="headerlink" title="16.MongoDB"></a>16.MongoDB</h2><p>database</p>
<p>database management system</p>
<ul>
<li>effiecency</li>
<li>security</li>
<li>scalability</li>
</ul>
<h3 id="Structured-Query-Language"><a href="#Structured-Query-Language" class="headerlink" title="Structured Query Language"></a>Structured Query Language</h3><ul>
<li><p>predefined schema&#x2F;tables</p>
</li>
<li><p>relational&#x2F;referencing</p>
</li>
</ul>
<h3 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a>NoSQL</h3><ul>
<li>document</li>
<li>key-value</li>
<li>graph</li>
</ul>
<h3 id="mongod-exe"><a href="#mongod-exe" class="headerlink" title="mongod.exe"></a>mongod.exe</h3><p>get the server running</p>
<p>cmd打开后不要关！！</p>
<h3 id="mongo-exe"><a href="#mongo-exe" class="headerlink" title="mongo.exe"></a>mongo.exe</h3><p>enter the shell</p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1:27017/">http://127.0.0.1:27017/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show dbs</span><br><span class="line">use loginDemo</span><br><span class="line">show collections</span><br><span class="line">db.users.find()</span><br></pre></td></tr></table></figure>



<h3 id="BSON"><a href="#BSON" class="headerlink" title="BSON"></a>BSON</h3><p>db</p>
<p>show collections</p>
<p>db.dogs.insertOne({name:”hhh”, age:3})</p>
<p>db.dogs.insert([{name:”iii”, age:5},{age:9}])    &#x2F;&#x2F;single or multiple </p>
<p>db.dogs.find()</p>
<p>db.dogs.find({age:9})    &#x2F;&#x2F;return the cursors</p>
<p>db.dogs.findOne({age:9})    &#x2F;&#x2F;return the actual object</p>
<p>db.cats.updateOne({} ,{})</p>
<p>db.cats.updateMany({}, {})</p>
<p>db.replaceOne()</p>
<p>db.deleteOne({})</p>
<p>db.deleteMany({})</p>
<h2 id="17-Mongoose"><a href="#17-Mongoose" class="headerlink" title="17.Mongoose"></a>17.Mongoose</h2><p>npm package </p>
<h3 id="Object-Data-x2F-Document-Mapper"><a href="#Object-Data-x2F-Document-Mapper" class="headerlink" title="Object Data&#x2F;Document Mapper"></a>Object Data&#x2F;Document Mapper</h3><p>nosql</p>
<h3 id="Object-Relation-Mapper"><a href="#Object-Relation-Mapper" class="headerlink" title="Object Relation Mapper"></a>Object Relation Mapper</h3><p>sql</p>
<h3 id="schema"><a href="#schema" class="headerlink" title="schema"></a>schema</h3><p>类比mybatis    .xml</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mongoose=<span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line">mongoose.<span class="title function_">connect</span>(<span class="string">&quot;mongodb://localhost:27017/moviewApp&quot;</span>,&#123;<span class="attr">useNewUrlParser</span>: <span class="literal">true</span>, <span class="attr">useUnifiedTopology</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;CONNECTION OPEN!!!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;OH NO ERROR!!!&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//schema</span></span><br><span class="line"><span class="keyword">const</span> movieSchema=<span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">year</span>:<span class="title class_">Number</span>,</span><br><span class="line">    <span class="attr">score</span>:<span class="title class_">Number</span></span><br><span class="line">    <span class="attr">rating</span>:<span class="title class_">String</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//name of model, schema</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Movie</span>=mongoose.<span class="title function_">model</span>(<span class="string">&quot;Movie&quot;</span>, movieSchema);</span><br><span class="line"><span class="comment">//create a db collection called movies</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//make a new JS object</span></span><br><span class="line"><span class="keyword">const</span> amadeus = <span class="keyword">new</span> <span class="title class_">Movie</span>(&#123;<span class="attr">title</span>:<span class="string">&quot;Amadeus&quot;</span>, <span class="attr">year</span>: <span class="number">1986</span>, <span class="attr">score</span>: <span class="number">9.2</span>, <span class="attr">rating</span>: <span class="string">&quot;G&quot;</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//save to database collection!</span></span><br><span class="line">amadeus.<span class="title function_">save</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//insert many</span></span><br><span class="line"><span class="title class_">Movie</span>.<span class="title function_">insertMany</span>([</span><br><span class="line">    &#123;&#125;,</span><br><span class="line">    &#123;&#125;,</span><br><span class="line">    &#123;&#125;,</span><br><span class="line">])</span><br></pre></td></tr></table></figure>



<h3 id="load"><a href="#load" class="headerlink" title=".load"></a>.load</h3><p>node</p>
<p>.load index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//return an array; zero, one or many</span></span><br><span class="line"><span class="title class_">Movie</span>.<span class="title function_">find</span>(&#123;<span class="attr">year</span>: &#123;<span class="attr">$lt</span>: <span class="number">1990</span>&#125;&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//findById</span></span><br><span class="line"><span class="title class_">Movie</span>.<span class="title function_">findById</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//updateOne</span></span><br><span class="line"><span class="comment">//updateMany</span></span><br><span class="line"><span class="title class_">Movie</span>.<span class="title function_">updateMany</span>(&#123;<span class="attr">title</span>: &#123;<span class="attr">$in</span>:[<span class="string">&quot;Amadeus&quot;</span>,<span class="string">&quot;Stand By Me&quot;</span>]&#125;&#125;, &#123;<span class="attr">score</span>: <span class="number">10</span>&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(res))</span><br><span class="line"></span><br><span class="line"><span class="comment">//findOneAndUpdate</span></span><br><span class="line"><span class="title class_">Movie</span>.<span class="title function_">findOneAndUpdate</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//remove is deprecated</span></span><br><span class="line"><span class="title class_">Movie</span>.<span class="title function_">remove</span>(&#123;&#125;)</span><br><span class="line"><span class="title class_">Movie</span>.<span class="title function_">deleteMany</span>(&#123;&#125;)</span><br><span class="line"><span class="title class_">Movie</span>.<span class="title function_">findOneAndDelete</span>(&#123;&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="Operation-Buffering"><a href="#Operation-Buffering" class="headerlink" title="Operation Buffering"></a>Operation Buffering</h3><h3 id="schema-constraints"><a href="#schema-constraints" class="headerlink" title="schema constraints"></a>schema constraints</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> productSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>:&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">        <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">maxlength</span>: <span class="number">20</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">price</span>:&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">        <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">//min: 0</span></span><br><span class="line">        <span class="comment">//constraint and error message</span></span><br><span class="line">        <span class="attr">min</span>:[<span class="number">0</span>,<span class="string">&quot;Price must be positive!&quot;</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onSale</span>:&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">categories</span>: [<span class="title class_">String</span>],	<span class="comment">//attempt to cast input into String</span></span><br><span class="line">    <span class="attr">qty</span>: &#123;</span><br><span class="line">        <span class="attr">online</span>:&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">            <span class="attr">default</span>: <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">inStore</span>:&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">            <span class="attr">default</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">size</span>:&#123;</span><br><span class="line">        <span class="attr">type</span>:<span class="title class_">String</span>,</span><br><span class="line">        <span class="comment">//all valid values</span></span><br><span class="line">        <span class="attr">enum</span>: [<span class="string">&quot;S&quot;</span>, <span class="string">&quot;M&quot;</span>, <span class="string">&#x27;L&#x27;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Product</span> = mongoose.<span class="title function_">model</span>(<span class="string">&quot;Product&quot;</span>, productSchema);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bike = <span class="keyword">new</span> <span class="title class_">Product</span>(&#123;<span class="attr">name</span>: <span class="string">&quot;Bike Helmet&quot;</span>, <span class="attr">price</span>: <span class="number">9.5</span>&#125;, <span class="attr">categories</span>: [<span class="string">&quot;Cycling&quot;</span>, <span class="string">&quot;Safety&quot;</span>, <span class="number">123</span>]);</span><br><span class="line"></span><br><span class="line">bike.<span class="title function_">save</span>()</span><br><span class="line">	.<span class="title function_">then</span>(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;IT WORKED!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">	.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ERROR!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//When updating, schema constraint by default Not working</span></span><br><span class="line"><span class="title class_">Product</span>.<span class="title function_">findOneAndUpdate</span>(&#123;<span class="attr">name</span>: <span class="string">&quot;Bike Helmet&quot;</span>&#125;, &#123;<span class="attr">price</span>: <span class="number">99</span>&#125;, &#123;<span class="attr">new</span>:<span class="literal">true</span>, <span class="attr">runValidators</span>: <span class="literal">true</span>&#125; )</span><br><span class="line">	.<span class="title function_">then</span>(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;IT WORKED!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">	.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ERROR!&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="model-instance-method"><a href="#model-instance-method" class="headerlink" title="model instance method"></a>model instance method</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">productSchema.<span class="property">methods</span>.<span class="property">toggleOnSale</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">onSale</span> = !<span class="variable language_">this</span>.<span class="property">onSale</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">save</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">findProduct</span> = <span class="keyword">async</span>(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> foundProduct = <span class="keyword">await</span> <span class="title class_">Product</span>.<span class="title function_">findOne</span>(&#123;<span class="attr">name</span>:<span class="string">&quot;hhh&quot;</span>&#125;);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(foundProduct);</span><br><span class="line">    <span class="keyword">await</span> foundProduct.<span class="title function_">toggleOnSale</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(foundProduct);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="model-static-method"><a href="#model-static-method" class="headerlink" title="model static method"></a>model static method</h3><p><strong>fancy ways of CRUD</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">productSchema.<span class="property">statics</span>.<span class="property">fireSale</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="virtuals"><a href="#virtuals" class="headerlink" title="virtuals"></a>virtuals</h3><ul>
<li><p>behave as if it is a virtual property</p>
</li>
<li><p>not in Mongo database, but only in JS</p>
</li>
<li><p>get</p>
</li>
<li><p>set</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> personSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">    <span class="attr">first</span>:<span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">last</span>:<span class="title class_">String</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">personSchema.<span class="title function_">virtual</span>(<span class="string">&quot;fullName&quot;</span>).<span class="title function_">get</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.first&#125;</span> <span class="subst">$&#123;<span class="variable language_">this</span>.last&#125;</span>`</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Person</span> = mongoose.<span class="title function_">model</span>(<span class="string">&quot;Person&quot;</span>, personSchema);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tammy = <span class="keyword">new</span> <span class="title class_">Person</span>(&#123;<span class="attr">first</span>:<span class="string">&quot;Tammy&quot;</span>, <span class="attr">last</span>:<span class="string">&quot;Chow&quot;</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(tammy.<span class="property">fullName</span>)</span><br><span class="line">                                            </span><br></pre></td></tr></table></figure>





<h3 id="middleware"><a href="#middleware" class="headerlink" title="middleware"></a>middleware</h3><p>do things before and after something(CRUD)</p>
<ul>
<li>pre hook</li>
<li>post hook</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">personSchema.<span class="title function_">pre</span>(<span class="string">&quot;save&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">first</span>=<span class="string">&quot;first&quot;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">last</span>=<span class="string">&quot;last&quot;</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ABOUT TO SAVE!!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">personSchema.<span class="title function_">post</span>(<span class="string">&quot;save&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;JUST SAVED!!&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h2 id="18-Express-Middleware"><a href="#18-Express-Middleware" class="headerlink" title="18.Express Middleware"></a>18.Express Middleware</h2><ul>
<li>Express middleware are functions that run during the req&#x2F;res lifecycle.</li>
<li>Middleware can end the HTTP request by sending back a response with methods like res.send()</li>
<li>OR middleware can be chained together, one afte another by calling next()</li>
</ul>
<h3 id="morgan"><a href="#morgan" class="headerlink" title="morgan"></a>morgan</h3><p>logger</p>
<p>npm i morgan</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> morgan=<span class="built_in">require</span>(<span class="string">&quot;morgan&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//app.use 		whenever a request comes in</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;HIJACKED BY MY APP.USE()&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">morgan</span>(<span class="string">&quot;tiny&quot;</span>))	<span class="comment">//inject in the middle</span></span><br><span class="line"><span class="comment">//app.use(morgan(&quot;common&quot;))</span></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;THIS IS MY FIRST MIDDLEWARE&quot;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;THIS IS MY FIRST MIDDLEWARE - AFTER CALLING NEXT()&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;THIS IS MY SECOND MIDDLEWARE&quot;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//to make sure nothing happens after next, return next</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;THIS IS MY FIRST MIDDLEWARE&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">next</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;THIS IS MY FIRST MIDDLEWARE - AFTER CALLING NEXT()&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    req.<span class="property">method</span>=<span class="string">&quot;GET&quot;</span></span><br><span class="line">    req.<span class="property">requestTime</span>=<span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">path</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;password&#125;=req.<span class="property">query</span></span><br><span class="line">    <span class="keyword">if</span>(password===<span class="string">&quot;chickennugget&quot;</span>)&#123;</span><br><span class="line">        <span class="title function_">next</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;SORRY YOU NEED A PASSWORD!!!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&quot;/secret&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">send</span>(<span class="string">&quot;NOT FOUND!&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">verifyPassword</span>=(<span class="params">req,res,next</span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;password&#125;=req.<span class="property">query</span></span><br><span class="line">    <span class="keyword">if</span>(password===<span class="string">&quot;chickennugget&quot;</span>)&#123;</span><br><span class="line">        <span class="title function_">next</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;SORRY YOU NEED A PASSWORD!!!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//can have multiple callbacks</span></span><br><span class="line"><span class="comment">//not all callbacks will necessarily be executed</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/secret&quot;</span>,verifyPassword,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;My secret:   &quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h3 id="ejs-mate"><a href="#ejs-mate" class="headerlink" title="ejs -mate"></a>ejs -mate</h3><h4 id="basic-index"><a href="#basic-index" class="headerlink" title="basic index"></a>basic index</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;% layout(&quot;layouts/boilerplate&quot;) %&gt;</span><br><span class="line">&lt;h1&gt;All Campgrounds&lt;/h1&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;a href=&quot;/campgrounds/new&quot;&gt;Add Campground&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;% for( let campground of campgrounds ) &#123; %&gt;</span><br><span class="line">  &lt;li&gt;</span><br><span class="line">    &lt;a href=&quot;/campgrounds/&lt;%= campground._id %&gt; &quot;&gt;</span><br><span class="line">      &lt;%=campground.title %&gt;</span><br><span class="line">    &lt;/a&gt;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">  &lt;% &#125; %&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>





<h4 id="basic-new"><a href="#basic-new" class="headerlink" title="basic new"></a>basic new</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;% layout(&quot;layouts/boilerplate&quot;) %&gt;</span><br><span class="line">&lt;form action=&quot;/campgrounds&quot; method=&quot;post&quot;&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;label for=&quot;title&quot;&gt;Title&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; id=&quot;title&quot; name=&quot;campground[title]&quot;&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;label for=&quot;location&quot;&gt;Location&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; id=&quot;location&quot; name=&quot;campground[location]&quot;&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;button&gt;Add Campground&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;a href=&quot;/campgrounds&quot;&gt;Back&lt;/a&gt;</span><br></pre></td></tr></table></figure>



<h4 id="basic-show"><a href="#basic-show" class="headerlink" title="basic show"></a>basic show</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1&gt;</span><br><span class="line">  &lt;%= campground.title %&gt;</span><br><span class="line">&lt;/h1&gt;</span><br><span class="line">&lt;h2&gt;</span><br><span class="line">  &lt;%= campground.location %&gt;</span><br><span class="line">&lt;/h2&gt;</span><br><span class="line">&lt;img src=&quot;&lt;%= campground.image %&gt; &quot; alt=&quot;&quot;&gt;</span><br><span class="line">&lt;p&gt;&lt;%= campground.description  %&gt; &lt;/p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href=&quot;/campgrounds/&lt;%= campground._id %&gt;/edit &quot;&gt;Edit&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">&lt;form action=&quot;/campgrounds/&lt;%= campground._id %&gt;?_method=DELETE&quot; method=&quot;post&quot;&gt;</span><br><span class="line">  &lt;button&gt;Delete Campground&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;footer&gt;</span><br><span class="line">  &lt;p&gt;&lt;a href=&quot;/campgrounds&quot;&gt;All Campgrounds&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">&lt;/footer&gt;</span><br></pre></td></tr></table></figure>





<h3 id="error-handling"><a href="#error-handling" class="headerlink" title="error-handling"></a>error-handling</h3><ul>
<li>next()        calling next non-error-handling middleware</li>
<li>next(err)   calling next(default) error-handling middleware</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//custom error handling middleware</span></span><br><span class="line"><span class="comment">//if custom error handler is defined, the default one will no longer work, except we add next(err)</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err,req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;====================&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=======ERROR========&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;====================&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&quot;OH BOY, WE GOT AN ERROR!!&quot;</span>)</span><br><span class="line">    <span class="title function_">next</span>(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h2 id="19-Mongo-Relationships"><a href="#19-Mongo-Relationships" class="headerlink" title="19. Mongo Relationships"></a>19. Mongo Relationships</h2><h3 id="SQL-relationships-tables"><a href="#SQL-relationships-tables" class="headerlink" title="SQL relationships        tables!"></a>SQL relationships        tables!</h3><ul>
<li>one-to-many<ul>
<li>primary key     User[id]</li>
<li>foreign key      Post[user_id]</li>
</ul>
</li>
<li>many-to-many<ul>
<li>a third table</li>
<li>Movie[id], Actor[id]</li>
<li>Role[movie_id,actor_id]</li>
</ul>
</li>
</ul>
<h3 id="One-to-Few"><a href="#One-to-Few" class="headerlink" title="One to Few"></a>One to Few</h3><ul>
<li><p>example: users&#x2F;accounts &#x3D;&gt; addresses</p>
</li>
<li><p>embed the data directly in the document</p>
</li>
<li><p>mongo add a new _id for each document&#x2F;schema</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> userSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">    <span class="attr">first</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">last</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">addresses</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//by default, each address will also have a _id</span></span><br><span class="line">            <span class="comment">//can be turned off</span></span><br><span class="line">            <span class="attr">_id</span>: &#123;<span class="attr">id</span>: <span class="literal">false</span>&#125;,</span><br><span class="line">            <span class="attr">street</span>: <span class="title class_">String</span>,</span><br><span class="line">            <span class="attr">city</span>: <span class="title class_">String</span>,</span><br><span class="line">            <span class="attr">state</span>: <span class="title class_">String</span>,</span><br><span class="line">            <span class="attr">country</span>: <span class="title class_">String</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="One-to-Many"><a href="#One-to-Many" class="headerlink" title="One to Many"></a>One to Many</h3><ul>
<li>store refenrences(object id) to document inside the parent</li>
<li>similar to SQL one-to-many</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> productSchema=<span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">price</span>: <span class="title class_">Number</span>,</span><br><span class="line">    <span class="attr">season</span>:&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">        <span class="attr">enum</span>: [<span class="string">&quot;Spring&quot;</span>,<span class="string">&quot;Summer&quot;</span>,<span class="string">&quot;Fall&quot;</span>,<span class="string">&quot;Autumn&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Product</span>=mongoose.<span class="title function_">model</span>(<span class="string">&quot;Product&quot;</span>,productSchema);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Product</span>.<span class="title function_">insertMany</span>([</span><br><span class="line">    &#123;<span class="attr">name</span>:<span class="string">&quot;Goddess Melon&quot;</span>,<span class="attr">price</span>: <span class="number">4.99</span>,<span class="attr">season</span>:<span class="string">&quot;Summer&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>:<span class="string">&quot;Sugar Baby Melon&quot;</span>,<span class="attr">price</span>: <span class="number">4.99</span>,<span class="attr">season</span>:<span class="string">&quot;Summer&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">name</span>:<span class="string">&quot;Asparagus&quot;</span>,<span class="attr">price</span>: <span class="number">3.99</span>,<span class="attr">season</span>:<span class="string">&quot;Spring&quot;</span>&#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment">//const Schema=mongoose.Schema;</span></span><br><span class="line"><span class="keyword">const</span> &#123;<span class="title class_">Schema</span>&#125;=mongoose;</span><br><span class="line"><span class="comment">//the ref option tells Mongoose which model to use during population, or the name of the model we are referencing</span></span><br><span class="line"><span class="keyword">const</span> farmSchema=<span class="keyword">new</span> <span class="title class_">Schema</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">city</span>:<span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">products</span>:[&#123;<span class="attr">type</span>: <span class="title class_">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>, <span class="attr">ref</span>: <span class="string">&quot;Product&quot;</span>&#125;]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Farm</span>=mongoose.<span class="title function_">model</span>(<span class="string">&quot;Farm&quot;</span>,farmSchema);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> farm=<span class="keyword">new</span> <span class="title class_">Farm</span>(&#123;<span class="attr">name</span>: <span class="string">&quot;Fully Belly Farms&quot;</span>, <span class="attr">city</span>: <span class="string">&quot;Guinda, CA&quot;</span>&#125;);</span><br><span class="line"><span class="keyword">const</span> melon1=<span class="title class_">Product</span>.<span class="title function_">findOne</span>(&#123;<span class="attr">name</span>: <span class="string">&quot;Goddess Melon&quot;</span>&#125;);</span><br><span class="line"><span class="keyword">const</span> melon2=<span class="title class_">Product</span>.<span class="title function_">findOne</span>(&#123;<span class="attr">name</span>: <span class="string">&quot;Asparagus&quot;</span>&#125;);</span><br><span class="line"><span class="comment">//not pushing the entire object, but just the id</span></span><br><span class="line">farm.<span class="property">products</span>.<span class="title function_">push</span>(melon1);</span><br><span class="line">farm.<span class="property">products</span>.<span class="title function_">push</span>(melon2);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Farm</span>.<span class="title function_">findOne</span>(&#123;<span class="attr">name</span>: <span class="string">&quot;Fully Belly Farms&quot;</span>&#125;)</span><br><span class="line">    .<span class="title function_">populate</span>(<span class="string">&quot;products&quot;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">farm</span>=&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(farm))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="One-to-Bajillions"><a href="#One-to-Bajillions" class="headerlink" title="One to Bajillions"></a>One to Bajillions</h3><ul>
<li><p>example: users &#x3D;&gt; tweets</p>
</li>
<li><p>store reference to parent in child</p>
</li>
<li><p>ref: Model</p>
</li>
<li><p>populate: field</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> userSchema=<span class="keyword">new</span> <span class="title class_">Schema</span>(&#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="title class_">Number</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tweetSchema=<span class="keyword">new</span> <span class="title class_">Schema</span>(&#123;</span><br><span class="line">    <span class="attr">text</span>:<span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">likes</span>:<span class="title class_">Number</span>,</span><br><span class="line">    <span class="attr">user</span>:&#123;<span class="attr">type</span>:<span class="title class_">Schema</span>.<span class="property">Type</span>.<span class="property">ObjectId</span>, <span class="attr">ref</span>:<span class="string">&quot;User&quot;</span>&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">User</span>=mongoose.<span class="title function_">model</span>(<span class="string">&quot;User&quot;</span>,userSchema)</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Tweet</span>=mongoose.<span class="title function_">model</span>(<span class="string">&quot;Tweet&quot;</span>,tweetSchema)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> <span class="title class_">User</span>(&#123;<span class="attr">name</span>:<span class="string">&quot;chickenfan99&quot;</span>,<span class="attr">age</span>:<span class="number">63</span>&#125;)</span><br><span class="line"><span class="keyword">const</span> tweet1=<span class="keyword">new</span> <span class="title class_">Tweet</span>(&#123;<span class="attr">text</span>:<span class="string">&quot;omg I love my chicken family!&quot;</span>, <span class="attr">likes</span>:<span class="number">0</span>&#125;);</span><br><span class="line">tweet1.<span class="property">user</span>=user;</span><br><span class="line">user.<span class="title function_">save</span>();</span><br><span class="line">tweet1.<span class="title function_">save</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//populate: name of the field, not name of the model</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Tweet</span>.<span class="title function_">findOne</span>(&#123;&#125;).<span class="title function_">populate</span>(<span class="string">&quot;user&quot;</span>))</span><br><span class="line"><span class="comment">//only want user.username</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Tweet</span>.<span class="title function_">findOne</span>(&#123;&#125;).<span class="title function_">populate</span>(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;username&quot;</span>))</span><br></pre></td></tr></table></figure>



<h3 id="paradox-of-choice-rule-of-thumb"><a href="#paradox-of-choice-rule-of-thumb" class="headerlink" title="paradox of choice: rule of thumb"></a>paradox of choice: rule of thumb</h3><ul>
<li>favor embedding unless there is compelling reason not to</li>
<li>needing to access an object on its own is a compelling reason not to embed it </li>
<li>Arrays should not grow without bound.</li>
<li>Don’t be afraid of application-level joins.</li>
<li>Consider the write&#x2F;read ratio when denormalizing.<ul>
<li>denormal: duplicate and store some requently accessed field together with objectId</li>
</ul>
</li>
<li>As always with MongoDB, how you model your data depends - entirely - on your particular application’s data access patterns.<ul>
<li>query?</li>
<li>update?</li>
</ul>
</li>
</ul>
<h3 id="deletion-mongoose-middleware"><a href="#deletion-mongoose-middleware" class="headerlink" title="deletion mongoose middleware"></a>deletion mongoose middleware</h3><ul>
<li>query middleware</li>
<li>document middleware</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//before &quot;findByIdAndDelete&quot;, have no access to data deleted</span></span><br><span class="line">farmSchema.<span class="title function_">pre</span>(<span class="string">&quot;findOneAndDelete&quot;</span>,<span class="keyword">async</span> <span class="keyword">function</span>(<span class="params">data</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;PRE MIDDLEWARE&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//after &quot;findByIdAndDelete&quot;, have access to data deleted</span></span><br><span class="line">farmSchema.<span class="title function_">post</span>(<span class="string">&quot;findOneAndDelete&quot;</span>,<span class="keyword">async</span> <span class="keyword">function</span>(<span class="params">farm</span>)&#123;</span><br><span class="line">    <span class="comment">//console.log(&quot;POST MIDDLEWARE&quot;)</span></span><br><span class="line">    <span class="comment">//console.log(data)</span></span><br><span class="line">    <span class="keyword">if</span>(farm.<span class="property">products</span>.<span class="property">length</span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> res =<span class="keyword">await</span> <span class="title class_">Product</span>.<span class="title function_">deleteMany</span>(&#123;<span class="attr">_id</span>:&#123;<span class="attr">$in</span>: farm.<span class="property">products</span>&#125;&#125;)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h2 id="20-express-router"><a href="#20-express-router" class="headerlink" title="20. express router"></a>20. express router</h2><ul>
<li><p>better handle nested routes</p>
</li>
<li><p>separate and group different routes</p>
</li>
<li><p>assign middlewares to specific groups</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> router=express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//middleware</span></span><br><span class="line">router.<span class="title function_">use</span>(<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(req.<span class="property">query</span>.<span class="property">isAdmin</span>)&#123;</span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;SORRY NOT AN ADMIN!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//router.get(&quot;/shelters&quot;,(req,res)=&gt;&#123;</span></span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//router.post(&quot;/shelters&quot;,(req,res)=&gt;&#123;</span></span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/shelters/:id&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/:id&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//router.get(&quot;/shelters/:id/edit&quot;,(req,res)=&gt;&#123;</span></span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/:id/edit&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>=router</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> app=<span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> shelterRoutes=<span class="built_in">require</span>(<span class="string">&quot;./routes/shelters&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//app.use(&quot;/&quot;,shelterRoutes)</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&quot;/shelters&quot;</span>,shelterRoutes)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Serving app on localhost:3000&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h2 id="21-http-cookies"><a href="#21-http-cookies" class="headerlink" title="21. http cookies"></a>21. http cookies</h2><ul>
<li><strong>cookies</strong> are little bits of information that are stored in a user’s browser when browsing a particular website</li>
<li>once a <strong>cookie</strong> is set, a user’s browser will send the cookie on every subsequent request to the site</li>
<li><strong>cookies</strong> add some <strong>“statefulness”</strong> to HTTP , between requests</li>
</ul>
<h3 id="send-cookies"><a href="#send-cookies" class="headerlink" title="send cookies"></a>send cookies</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/setname&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">cookie</span>(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;steve chicks&quot;</span>);</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;OK SENT YOU A COOKIE!!&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="cookie-parser-middleware"><a href="#cookie-parser-middleware" class="headerlink" title="cookie parser middleware"></a>cookie parser middleware</h3><p>npm i cookie-parser</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cookieParser=<span class="built_in">require</span>(<span class="string">&quot;cookie-parser&quot;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cookieParser</span>())</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/greet&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//console.log(req.cookies)</span></span><br><span class="line">    <span class="keyword">const</span> &#123;name=<span class="string">&quot;No-name&quot;</span>&#125; = req.<span class="property">cookies</span>;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">`HEY THERE, <span class="subst">$&#123;name&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="signed-cookie"><a href="#signed-cookie" class="headerlink" title="signed cookie:"></a>signed cookie:</h3><h4 id="signed"><a href="#signed" class="headerlink" title="signed?"></a>signed?</h4><ul>
<li>analogy: old wax seal on letter, proving its <strong>validity&#x2F;integrity</strong></li>
<li>analogy: seal on peanut butter jar, if it’s broken, don’t eat it</li>
<li>is way to make sure it is not tampered with, not to make it a secret&#x2F;encrypted!!</li>
</ul>
<h4 id="basic-idea"><a href="#basic-idea" class="headerlink" title="basic idea:"></a>basic idea:</h4><ol>
<li>server send signed cookie to client</li>
<li>client send plain cookie to server on every request</li>
<li>client able to tell whether the cookie has been tampered with</li>
</ol>
<p>​        cookie-parser</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cookieParser=<span class="built_in">require</span>(<span class="string">&quot;cookie-parser&quot;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cookieParser</span>(<span class="string">&quot;thisismysecret&quot;</span>))</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/getsignedcookie&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">cookie</span>(<span class="string">&quot;fruit&quot;</span>,<span class="string">&quot;grape&quot;</span>,&#123;<span class="attr">signed</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;sent you a signed cookie!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/verifyfruit&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">cookies</span>)	<span class="comment">//won&#x27;t contain signed cookie</span></span><br><span class="line">    res.<span class="title function_">send</span>(req.<span class="property">signedCookies</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h4 id="HMAC"><a href="#HMAC" class="headerlink" title="HMAC"></a>HMAC</h4><p><strong>Hash-based Message Authentication Code</strong></p>
<p>hashing function: SHA256</p>
<h2 id="22-session"><a href="#22-session" class="headerlink" title="22. session"></a>22. session</h2><ul>
<li><p>server side data store to make requests somewhat <strong>stateful</strong></p>
</li>
<li><p>example: shopping cart</p>
<ol>
<li>session contains the whole shopping carts of different id’s</li>
<li>cookie only contains the session id, <strong>connect.sid</strong></li>
</ol>
</li>
<li><p>server send back the session id as cookie</p>
</li>
<li><p>default store: <strong>MemoryStore</strong></p>
<p>when restart the browser, everything is reset</p>
</li>
<li><p>impermenant data store: Redis</p>
</li>
</ul>
<h3 id="why-not-cookie"><a href="#why-not-cookie" class="headerlink" title="why not cookie?"></a>why not cookie?</h3><ol>
<li>limited size</li>
<li>insecure</li>
</ol>
<h3 id="express-session"><a href="#express-session" class="headerlink" title="express-session"></a>express-session</h3><p>npm i express-session</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> app=<span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> session=<span class="built_in">require</span>(<span class="string">&quot;express-session&quot;</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;<span class="attr">secret</span>: <span class="string">&quot;thisisnotagoodsecret&quot;</span>, <span class="attr">resave</span>: <span class="literal">false</span>, <span class="attr">saveUninitialized</span>: <span class="literal">false</span>&#125;))</span><br><span class="line"><span class="comment">//send back a signed cookie: connect.sid</span></span><br><span class="line"><span class="comment">//to the browser</span></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/viewcount&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(req.<span class="property">session</span>.<span class="property">count</span>)&#123;</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">count</span>+=<span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">count</span>=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">`YOU HAVE VIEWED THIS PAGE <span class="subst">$&#123;req.session.count&#125;</span> TIMES`</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/register&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;username=<span class="string">&quot;Anonymous&quot;</span>&#125; = req.<span class="property">query</span>;</span><br><span class="line">    req.<span class="property">session</span>.<span class="property">username</span>=username;</span><br><span class="line">    res.<span class="title function_">redirect</span>(<span class="string">&quot;/greet&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/greet&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;username&#125; = req.<span class="property">session</span>;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">`Welcome back, <span class="subst">$&#123;username&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Serving app on localhost:3000&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="connect-flash"><a href="#connect-flash" class="headerlink" title="connect-flash"></a>connect-flash</h3><ul>
<li>after some action (create, delete, log in)</li>
<li>before redirection</li>
<li>depends on session</li>
</ul>
<p>npm i connect-flash</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flash=<span class="built_in">require</span>(<span class="string">&quot;connect-flash&quot;</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">flash</span>())</span><br></pre></td></tr></table></figure>



<p>with the flash middleware in place, all requests will have a req.flash() function that can be used to flash messages</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//(key, value), stored in session</span></span><br><span class="line"><span class="comment">//before redirect</span></span><br><span class="line">req.<span class="title function_">flash</span>(<span class="string">&quot;info&quot;</span>,<span class="string">&quot;information I want to flash&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//when I want to use it, in the redirected page</span></span><br><span class="line">res.<span class="title function_">render</span>(<span class="string">&quot;index&quot;</span>,&#123;<span class="attr">messages</span>:req.<span class="title function_">flash</span>(<span class="string">&quot;info&quot;</span>)&#125;)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= messages %&gt;</span><br></pre></td></tr></table></figure>



<h3 id="improvement-using-res-locals"><a href="#improvement-using-res-locals" class="headerlink" title="improvement using res.locals"></a>improvement using res.locals</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="property">locals</span>.<span class="property">messages</span>=req.<span class="title function_">flash</span>(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h2 id="23-Authentication-amp-Authorization"><a href="#23-Authentication-amp-Authorization" class="headerlink" title="23. Authentication &amp; Authorization"></a>23. Authentication &amp; Authorization</h2><ul>
<li><p>authentication is the process of verifying <strong>who a particular user is</strong></p>
<ol>
<li>username&#x2F;password combo</li>
<li>security questions</li>
<li>facial recognition</li>
</ol>
</li>
<li><p>authorization is verifying <strong>what a specific user has access to</strong></p>
<p>“Now that we know who you are, here is what you are allowed to do and NOT allowed to do”</p>
</li>
</ul>
<h3 id="NEVER-STORE-PASSWORDS"><a href="#NEVER-STORE-PASSWORDS" class="headerlink" title="NEVER STORE PASSWORDS"></a>NEVER STORE PASSWORDS</h3><ul>
<li>Rather than storing a password in the database, wu run the password through a <strong>hashing function</strong> first and then store the result in the database</li>
</ul>
<h3 id="hashing-function"><a href="#hashing-function" class="headerlink" title="hashing function"></a>hashing function</h3><ul>
<li>functions that map input data of some <strong>arbitrary size</strong> to <strong>fixed-size</strong> output values</li>
</ul>
<h3 id="cryptographic-hash-functions"><a href="#cryptographic-hash-functions" class="headerlink" title="cryptographic hash functions"></a>cryptographic hash functions</h3><ul>
<li><strong>one-way function</strong> which is infeasible to invert</li>
</ul>
<p>​       unable to get the input from the output</p>
<ul>
<li><p>small change in input yields large change in the output</p>
</li>
<li><p><strong>deterministic</strong>: same input yields same output</p>
</li>
<li><p>unlikely to find 2 outputs with same value</p>
<p>collisions are rare</p>
</li>
<li><p>password hash functions are <strong>deliberately slow</strong></p>
</li>
</ul>
<h3 id="password-salts"><a href="#password-salts" class="headerlink" title="password salts"></a>password salts</h3><ul>
<li><p>an extra safeguard</p>
</li>
<li><p>facts:</p>
<ol>
<li>people use same passwords from one site to the next frequently</li>
<li>people in general, use the same passwords from one person to the next</li>
</ol>
</li>
<li><p>if hackers know the hash fuction is Bcrypt ahead of time, they can precompute, trying every common password</p>
</li>
<li><p>password salts:</p>
<pre><code>1. A salt is a **random value** added to the password before we hash it.
   + append
   + prepend
</code></pre>
<ol>
<li>It helps ensure unique hashes and mitigate common attacks.</li>
</ol>
</li>
</ul>
<h3 id="Bcrypt"><a href="#Bcrypt" class="headerlink" title="Bcrypt"></a>Bcrypt</h3><ul>
<li><p>saltRounds: difficulty, amoun of time to hash</p>
<p>recommended around 12</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bcrypt=<span class="built_in">require</span>(<span class="string">&quot;bcrypt&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">hashPassword</span>=<span class="keyword">async</span>(<span class="params">pw</span>)=&gt;&#123;</span><br><span class="line">    <span class="comment">//const salt=await bcrypt.genSalt(10);</span></span><br><span class="line">    <span class="comment">//const hash=await bcrypt.hash(pw,salt);</span></span><br><span class="line">    <span class="comment">//console.log(salt)</span></span><br><span class="line">    <span class="keyword">const</span> hash=<span class="keyword">await</span> bcrypt.<span class="title function_">hash</span>(pw,<span class="number">10</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(hash)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">login</span>=<span class="keyword">async</span>(<span class="params">pw,hashedPassword</span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> result=<span class="keyword">await</span> bcrypt.<span class="title function_">compare</span>(pw,hashedPassword)</span><br><span class="line">    <span class="keyword">if</span>(result)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;LOGGED IN !!&quot;</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;INCORRECT&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">hashPassword</span>(<span class="string">&quot;monkey&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="use-session-to-log-in-x2F-out"><a href="#use-session-to-log-in-x2F-out" class="headerlink" title="use session to log in&#x2F;out"></a>use session to log in&#x2F;out</h3><p>On an incoming http request, Express middleware that supports the session checks a particular client cookie and if that particular cookie is found on the http request and is found in the global session object&#x2F;database, then it adds that session’s stored info to the request object for the http request handler to later use.</p>
<p>So, here’s a typical sequence:</p>
<ol>
<li>Incoming HTTP request.</li>
<li>Middleware checks for session cookie.</li>
<li>If session cookie not there, then create one and, in the process created a unique id to identify this http client.</li>
<li>In the persistent session store, initialize the session for this new client.</li>
<li>If session cookie is there, then look in the session store for the session data for this client and add that data to the request object.</li>
<li>End of session middleware processing</li>
<li>Later on in the Express processing of this http request, it gets to a matching request handler. The session data from the session store for this particular http client is already attached to the request object and available for the request handler to use.</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/login&quot;</span>,<span class="title function_">async</span>(req,res)=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;username,password&#125;=req.<span class="property">body</span>;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findOne</span>(&#123;username&#125;)</span><br><span class="line">    <span class="keyword">const</span> validPassword=<span class="keyword">await</span> bcrypt.<span class="title function_">compare</span>(password,user.<span class="property">password</span>)</span><br><span class="line">    <span class="keyword">if</span>(validPassword)&#123;</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">user_id</span>=user.<span class="property">_id</span></span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&quot;YAY WELCOME!!&quot;</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&quot;TRY AGAIN&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/secret&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!req.<span class="property">session</span>.<span class="property">user_id</span>)&#123;</span><br><span class="line">        res.<span class="title function_">redierct</span>(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;This is a secret for logged in users!!&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;logout&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//req.session.user_id=null;</span></span><br><span class="line">    req.<span class="property">session</span>.<span class="title function_">destroy</span>(); <span class="comment">//destroy the entire session</span></span><br><span class="line">    res.<span class="title function_">redirect</span>(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h3 id="refactor-to-model-methods"><a href="#refactor-to-model-methods" class="headerlink" title="refactor to model methods"></a>refactor to model methods</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">userSchema.<span class="property">statics</span>.<span class="property">findAndValidate</span>=<span class="keyword">async</span> <span class="keyword">function</span>(<span class="params">username,password</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> foundUser=<span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">findOne</span>(&#123;username&#125;)</span><br><span class="line">    <span class="keyword">const</span> isValid=<span class="keyword">await</span> bcrypt.<span class="title function_">compare</span>(password,foundUser.<span class="property">password</span>)</span><br><span class="line">    <span class="keyword">return</span> isValid ? foundUser : <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">userSchema.<span class="title function_">pre</span>(<span class="string">&quot;save&quot;</span>,<span class="keyword">async</span> <span class="keyword">function</span>(<span class="params">next</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable language_">this</span>.<span class="title function_">isModified</span>(<span class="string">&quot;password&quot;</span>)) <span class="keyword">return</span> <span class="title function_">next</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">password</span>=<span class="keyword">await</span> bcrypt.<span class="title function_">hash</span>(<span class="variable language_">this</span>.<span class="property">password</span>,<span class="number">12</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h2 id="24-image-upload"><a href="#24-image-upload" class="headerlink" title="24. image upload"></a>24. image upload</h2><ul>
<li>mongo document size limit: 16MB</li>
<li>GridFS</li>
</ul>
<ol>
<li>set up a form that would accept images</li>
<li>submit the form</li>
<li>store image data in Cloudinary</li>
<li>Cloudinary send back URLs</li>
<li>store URLs in mongo</li>
</ol>
<h3 id="Cloudinary"><a href="#Cloudinary" class="headerlink" title="Cloudinary"></a>Cloudinary</h3><ul>
<li>like AWS</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CLOUDINARY_CLOUD_NAME=</span><br><span class="line">CLOUDINARY_KEY=</span><br><span class="line">CLOUDINARY_SECRET=</span><br></pre></td></tr></table></figure>



<h3 id="enctype"><a href="#enctype" class="headerlink" title="enctype"></a>enctype</h3><ul>
<li><p>application&#x2F;x-www-form-urlencoded</p>
<p>default</p>
</li>
<li><p>multipart&#x2F;form-data</p>
<p>if the form contains file inputs</p>
</li>
</ul>
<h3 id="Multer"><a href="#Multer" class="headerlink" title="Multer"></a>Multer</h3><ol>
<li><p>first upload</p>
</li>
<li><p>then we can use req.body and req.file(s)</p>
</li>
</ol>
<p>in order to parse mutlipart form</p>
<ul>
<li><p>req.body</p>
<p>other information, except for the file</p>
</li>
<li><p>req.file</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> multer=<span class="built_in">require</span>(<span class="string">&quot;multer&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> upload=<span class="title function_">multer</span>(&#123;<span class="attr">dest</span>:<span class="string">&quot;uploads/&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">route</span>(<span class="string">&quot;/&quot;</span>).<span class="title function_">post</span>(upload.<span class="title function_">single</span>(<span class="string">&quot;image&quot;</span>),<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>,req.<span class="property">file</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(req.<span class="property">file</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">route</span>(<span class="string">&quot;/&quot;</span>).<span class="title function_">post</span>(upload.<span class="title function_">array</span>(<span class="string">&quot;image&quot;</span>),<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>,req.<span class="property">files</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(req.<span class="property">files</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="dotenv"><a href="#dotenv" class="headerlink" title="dotenv"></a>dotenv</h3><ul>
<li>avoid embedding api credentials right inside applications</li>
<li>instead, store in .env files</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SECRET=lololololol</span><br><span class="line">API_KEY=fasdjfoiahfawe8</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !==<span class="string">&quot;production&quot;</span>)&#123;</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">&quot;dotenv&quot;</span>).<span class="title function_">config</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(process.<span class="property">env</span>.<span class="property">SECRET</span>)</span><br></pre></td></tr></table></figure>





<h2 id="25-common-security-vulnerabilities"><a href="#25-common-security-vulnerabilities" class="headerlink" title="25. common security vulnerabilities"></a>25. common security vulnerabilities</h2><h3 id="database-injection"><a href="#database-injection" class="headerlink" title="database injection"></a>database injection</h3><ul>
<li><p>sql injection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">; DROP TABLE user</span><br></pre></td></tr></table></figure>


</li>
<li><p>mongo injection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.users.find(&#123;username:req.body.username&#125;)</span><br><span class="line">//</span><br><span class="line">db.users.find(&#123;username:&#123;&quot;$gt&quot;:&quot;&quot;&#125;&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Cross-Site-Scripting-XSS"><a href="#Cross-Site-Scripting-XSS" class="headerlink" title="Cross Site Scripting(XSS)"></a>Cross Site Scripting(XSS)</h3><p><a target="_blank" rel="noopener" href="https://xss-game.appspot.com/">https://xss-game.appspot.com/</a></p>
<h3 id="helmet"><a href="#helmet" class="headerlink" title="helmet"></a>helmet</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(</span><br><span class="line">    <span class="title function_">helmet</span>(&#123;</span><br><span class="line">        <span class="attr">contentSecurityPolicy</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">crossOriginEmbedderPolicy</span>: <span class="literal">false</span></span><br><span class="line">    &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>





<h2 id="26-heroku"><a href="#26-heroku" class="headerlink" title="26. heroku"></a>26. heroku</h2><h3 id="heroku-CLI"><a href="#heroku-CLI" class="headerlink" title="heroku CLI"></a>heroku CLI</h3><p>command line interface</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">heroku git:remote -a &lt;name of the heroku app&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">heroku login</span><br><span class="line"></span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;new message&quot;</span><br><span class="line">git push heroku master</span><br><span class="line"></span><br><span class="line">heroku restart</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>invincible-nerd
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://invincible-nerd.github.io/2022/11/28/Web-Developer-Bootcamp/" title="Web Developer Bootcamp">http://invincible-nerd.github.io/2022/11/28/Web-Developer-Bootcamp/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Nodejs/" rel="tag"># Nodejs</a>
              <a href="/tags/MongoDB/" rel="tag"># MongoDB</a>
              <a href="/tags/Heroku/" rel="tag"># Heroku</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/11/28/Sentence-Similarity/" rel="prev" title="Sentence Similarity">
      <i class="fa fa-chevron-left"></i> Sentence Similarity
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/12/04/COEN210/" rel="next" title="COEN 210 — Computer Architecture">
      COEN 210 — Computer Architecture <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Web-Developer-Bootcamp"><span class="nav-number">1.</span> <span class="nav-text">Web Developer Bootcamp</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%BF%AB%E6%8D%B7%E9%94%AE"><span class="nav-number">1.1.</span> <span class="nav-text">1. 快捷键</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-HTML5"><span class="nav-number">1.2.</span> <span class="nav-text">2. HTML5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTML-Entities%EF%BC%9Astart-with-ampersand-amp-end-with-semicolon"><span class="nav-number">1.2.1.</span> <span class="nav-text">HTML Entities：start with ampersand&amp;, end with semicolon;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Semantic-Markup-meaningful-markup-accessibility"><span class="nav-number">1.2.2.</span> <span class="nav-text">Semantic Markup: meaningful markup       accessibility</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Emmet"><span class="nav-number">1.2.3.</span> <span class="nav-text">Emmet:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#table"><span class="nav-number">1.2.4.</span> <span class="nav-text">table:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#form"><span class="nav-number">1.2.5.</span> <span class="nav-text">form:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#validation"><span class="nav-number">1.2.6.</span> <span class="nav-text">validation:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-CSS"><span class="nav-number">1.3.</span> <span class="nav-text">3. CSS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CSS-selector"><span class="nav-number">1.3.1.</span> <span class="nav-text">CSS selector:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#specificity"><span class="nav-number">1.3.2.</span> <span class="nav-text">specificity:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CSS-box-model"><span class="nav-number">1.3.3.</span> <span class="nav-text">CSS box model</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-JS"><span class="nav-number">1.4.</span> <span class="nav-text">4.JS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#loop"><span class="nav-number">1.4.1.</span> <span class="nav-text">loop:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#scope"><span class="nav-number">1.4.2.</span> <span class="nav-text">scope:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#callback%EF%BC%9B"><span class="nav-number">1.4.3.</span> <span class="nav-text">callback；</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#synchronous-callback"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">synchronous callback:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#asynchronous-callback"><span class="nav-number">1.4.3.2.</span> <span class="nav-text">asynchronous callback:</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#this"><span class="nav-number">1.4.4.</span> <span class="nav-text">this:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#spread"><span class="nav-number">1.4.5.</span> <span class="nav-text">spread:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#arguments"><span class="nav-number">1.4.6.</span> <span class="nav-text">arguments:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rest"><span class="nav-number">1.4.7.</span> <span class="nav-text">rest:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#destructuring%EF%BC%9A"><span class="nav-number">1.4.8.</span> <span class="nav-text">destructuring：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-DOM"><span class="nav-number">1.5.</span> <span class="nav-text">5.DOM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-DOM-events"><span class="nav-number">1.6.</span> <span class="nav-text">6.DOM events</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#button"><span class="nav-number">1.6.1.</span> <span class="nav-text">button</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#keyboard-event-objects"><span class="nav-number">1.6.2.</span> <span class="nav-text">(keyboard) event objects</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#form-event"><span class="nav-number">1.6.3.</span> <span class="nav-text">form event</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#input-event"><span class="nav-number">1.6.4.</span> <span class="nav-text">input event</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#event-bubbling"><span class="nav-number">1.6.5.</span> <span class="nav-text">event bubbling</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#event-delegation"><span class="nav-number">1.6.6.</span> <span class="nav-text">event delegation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.6.7.</span> <span class="nav-text"></span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-Asynchronous-JavaScript"><span class="nav-number">1.7.</span> <span class="nav-text">7. Asynchronous JavaScript</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#call-stack"><span class="nav-number">1.7.1.</span> <span class="nav-text">call stack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#js-is-single-threaded"><span class="nav-number">1.7.2.</span> <span class="nav-text">js is single-threaded!</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#promise"><span class="nav-number">1.7.3.</span> <span class="nav-text">promise</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#async"><span class="nav-number">1.7.4.</span> <span class="nav-text">async</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#await"><span class="nav-number">1.7.5.</span> <span class="nav-text">await</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-AJAX"><span class="nav-number">1.8.</span> <span class="nav-text">8.AJAX</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-Verbs"><span class="nav-number">1.8.1.</span> <span class="nav-text">HTTP Verbs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-Status-Codes"><span class="nav-number">1.8.2.</span> <span class="nav-text">HTTP Status Codes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Query-string"><span class="nav-number">1.8.3.</span> <span class="nav-text">Query string</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Headers"><span class="nav-number">1.8.4.</span> <span class="nav-text">Headers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XHRs"><span class="nav-number">1.8.5.</span> <span class="nav-text">XHRs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fetch"><span class="nav-number">1.8.6.</span> <span class="nav-text">fetch</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#axios"><span class="nav-number">1.8.7.</span> <span class="nav-text">axios</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-OOP"><span class="nav-number">1.9.</span> <span class="nav-text">9.OOP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#extends"><span class="nav-number">1.9.1.</span> <span class="nav-text">extends</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#super"><span class="nav-number">1.9.2.</span> <span class="nav-text">super</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-Terminal"><span class="nav-number">1.10.</span> <span class="nav-text">10.Terminal</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#man"><span class="nav-number">1.10.1.</span> <span class="nav-text">man</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-NodeJS"><span class="nav-number">1.11.</span> <span class="nav-text">11.NodeJS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Node-REPL"><span class="nav-number">1.11.1.</span> <span class="nav-text">Node REPL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#process"><span class="nav-number">1.11.2.</span> <span class="nav-text">process</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fs"><span class="nav-number">1.11.3.</span> <span class="nav-text">fs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#module-exports"><span class="nav-number">1.11.4.</span> <span class="nav-text">module.exports</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#npm"><span class="nav-number">1.11.5.</span> <span class="nav-text">npm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#package-json"><span class="nav-number">1.11.6.</span> <span class="nav-text">package.json</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-Express"><span class="nav-number">1.12.</span> <span class="nav-text">12.Express</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#listen-amp-use"><span class="nav-number">1.12.1.</span> <span class="nav-text">listen&amp;use</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#routing"><span class="nav-number">1.12.2.</span> <span class="nav-text">routing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#query-string"><span class="nav-number">1.12.3.</span> <span class="nav-text">query string</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#nodemon"><span class="nav-number">1.12.4.</span> <span class="nav-text">nodemon</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-Templating"><span class="nav-number">1.13.</span> <span class="nav-text">13.Templating</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#EJS-syntax"><span class="nav-number">1.13.1.</span> <span class="nav-text">EJS syntax</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#express-static"><span class="nav-number">1.13.2.</span> <span class="nav-text">express.static()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ejs-partials"><span class="nav-number">1.13.3.</span> <span class="nav-text">ejs partials</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#14-Bootstrap"><span class="nav-number">1.14.</span> <span class="nav-text">14.Bootstrap</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#15-RESTful"><span class="nav-number">1.15.</span> <span class="nav-text">15.RESTful</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Create"><span class="nav-number">1.15.1.</span> <span class="nav-text">Create</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#show-x2F-detail-route"><span class="nav-number">1.15.2.</span> <span class="nav-text">show&#x2F;detail route</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#uuid"><span class="nav-number">1.15.3.</span> <span class="nav-text">uuid</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Update"><span class="nav-number">1.15.4.</span> <span class="nav-text">Update</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-MongoDB"><span class="nav-number">1.16.</span> <span class="nav-text">16.MongoDB</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Structured-Query-Language"><span class="nav-number">1.16.1.</span> <span class="nav-text">Structured Query Language</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NoSQL"><span class="nav-number">1.16.2.</span> <span class="nav-text">NoSQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mongod-exe"><span class="nav-number">1.16.3.</span> <span class="nav-text">mongod.exe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mongo-exe"><span class="nav-number">1.16.4.</span> <span class="nav-text">mongo.exe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BSON"><span class="nav-number">1.16.5.</span> <span class="nav-text">BSON</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#17-Mongoose"><span class="nav-number">1.17.</span> <span class="nav-text">17.Mongoose</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Object-Data-x2F-Document-Mapper"><span class="nav-number">1.17.1.</span> <span class="nav-text">Object Data&#x2F;Document Mapper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Object-Relation-Mapper"><span class="nav-number">1.17.2.</span> <span class="nav-text">Object Relation Mapper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#schema"><span class="nav-number">1.17.3.</span> <span class="nav-text">schema</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#load"><span class="nav-number">1.17.4.</span> <span class="nav-text">.load</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Operation-Buffering"><span class="nav-number">1.17.5.</span> <span class="nav-text">Operation Buffering</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#schema-constraints"><span class="nav-number">1.17.6.</span> <span class="nav-text">schema constraints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#model-instance-method"><span class="nav-number">1.17.7.</span> <span class="nav-text">model instance method</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#model-static-method"><span class="nav-number">1.17.8.</span> <span class="nav-text">model static method</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#virtuals"><span class="nav-number">1.17.9.</span> <span class="nav-text">virtuals</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#middleware"><span class="nav-number">1.17.10.</span> <span class="nav-text">middleware</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#18-Express-Middleware"><span class="nav-number">1.18.</span> <span class="nav-text">18.Express Middleware</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#morgan"><span class="nav-number">1.18.1.</span> <span class="nav-text">morgan</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ejs-mate"><span class="nav-number">1.18.2.</span> <span class="nav-text">ejs -mate</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#basic-index"><span class="nav-number">1.18.2.1.</span> <span class="nav-text">basic index</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#basic-new"><span class="nav-number">1.18.2.2.</span> <span class="nav-text">basic new</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#basic-show"><span class="nav-number">1.18.2.3.</span> <span class="nav-text">basic show</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#error-handling"><span class="nav-number">1.18.3.</span> <span class="nav-text">error-handling</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#19-Mongo-Relationships"><span class="nav-number">1.19.</span> <span class="nav-text">19. Mongo Relationships</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL-relationships-tables"><span class="nav-number">1.19.1.</span> <span class="nav-text">SQL relationships        tables!</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#One-to-Few"><span class="nav-number">1.19.2.</span> <span class="nav-text">One to Few</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#One-to-Many"><span class="nav-number">1.19.3.</span> <span class="nav-text">One to Many</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#One-to-Bajillions"><span class="nav-number">1.19.4.</span> <span class="nav-text">One to Bajillions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#paradox-of-choice-rule-of-thumb"><span class="nav-number">1.19.5.</span> <span class="nav-text">paradox of choice: rule of thumb</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#deletion-mongoose-middleware"><span class="nav-number">1.19.6.</span> <span class="nav-text">deletion mongoose middleware</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#20-express-router"><span class="nav-number">1.20.</span> <span class="nav-text">20. express router</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#21-http-cookies"><span class="nav-number">1.21.</span> <span class="nav-text">21. http cookies</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#send-cookies"><span class="nav-number">1.21.1.</span> <span class="nav-text">send cookies</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cookie-parser-middleware"><span class="nav-number">1.21.2.</span> <span class="nav-text">cookie parser middleware</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#signed-cookie"><span class="nav-number">1.21.3.</span> <span class="nav-text">signed cookie:</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#signed"><span class="nav-number">1.21.3.1.</span> <span class="nav-text">signed?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#basic-idea"><span class="nav-number">1.21.3.2.</span> <span class="nav-text">basic idea:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HMAC"><span class="nav-number">1.21.3.3.</span> <span class="nav-text">HMAC</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-session"><span class="nav-number">1.22.</span> <span class="nav-text">22. session</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#why-not-cookie"><span class="nav-number">1.22.1.</span> <span class="nav-text">why not cookie?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#express-session"><span class="nav-number">1.22.2.</span> <span class="nav-text">express-session</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#connect-flash"><span class="nav-number">1.22.3.</span> <span class="nav-text">connect-flash</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#improvement-using-res-locals"><span class="nav-number">1.22.4.</span> <span class="nav-text">improvement using res.locals</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#23-Authentication-amp-Authorization"><span class="nav-number">1.23.</span> <span class="nav-text">23. Authentication &amp; Authorization</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NEVER-STORE-PASSWORDS"><span class="nav-number">1.23.1.</span> <span class="nav-text">NEVER STORE PASSWORDS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hashing-function"><span class="nav-number">1.23.2.</span> <span class="nav-text">hashing function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cryptographic-hash-functions"><span class="nav-number">1.23.3.</span> <span class="nav-text">cryptographic hash functions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#password-salts"><span class="nav-number">1.23.4.</span> <span class="nav-text">password salts</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bcrypt"><span class="nav-number">1.23.5.</span> <span class="nav-text">Bcrypt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#use-session-to-log-in-x2F-out"><span class="nav-number">1.23.6.</span> <span class="nav-text">use session to log in&#x2F;out</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#refactor-to-model-methods"><span class="nav-number">1.23.7.</span> <span class="nav-text">refactor to model methods</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#24-image-upload"><span class="nav-number">1.24.</span> <span class="nav-text">24. image upload</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Cloudinary"><span class="nav-number">1.24.1.</span> <span class="nav-text">Cloudinary</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#enctype"><span class="nav-number">1.24.2.</span> <span class="nav-text">enctype</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Multer"><span class="nav-number">1.24.3.</span> <span class="nav-text">Multer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dotenv"><span class="nav-number">1.24.4.</span> <span class="nav-text">dotenv</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#25-common-security-vulnerabilities"><span class="nav-number">1.25.</span> <span class="nav-text">25. common security vulnerabilities</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#database-injection"><span class="nav-number">1.25.1.</span> <span class="nav-text">database injection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cross-Site-Scripting-XSS"><span class="nav-number">1.25.2.</span> <span class="nav-text">Cross Site Scripting(XSS)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#helmet"><span class="nav-number">1.25.3.</span> <span class="nav-text">helmet</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#26-heroku"><span class="nav-number">1.26.</span> <span class="nav-text">26. heroku</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#heroku-CLI"><span class="nav-number">1.26.1.</span> <span class="nav-text">heroku CLI</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">invincible-nerd</p>
  <div class="site-description" itemprop="description">For explorer everywhere</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">75</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2022-04 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">invincible-nerd</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">888k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">13:27</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
